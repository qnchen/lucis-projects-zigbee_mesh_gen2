///////////////////////////////////////////////////////////////////////////////
//
// IAR C/C++ Compiler V9.30.1.3056 for 8051               11/Apr/2017  15:02:36
// Copyright 2004-2015 IAR Systems AB.
//
//    Core               =  plain
//    Code model         =  near
//    Data model         =  large
//    Calling convention =  xdata reentrant
//    Constant location  =  data
//    Dptr setup         =  1,16
//                          
//    Source file        =  
//        C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\Source\sb_exec.c
//    Command line       =  
//        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\Source\sb_exec.c" -D
//        HAL_SB_BOOT_CODE -D HAL_UART=TRUE -D HAL_UART_DMA=0 -D HAL_UART_ISR=1
//        -D HAL_UART_ISR_RX_MAX=254 -lC "C:\Texas Instruments\Z-Stack Mesh
//        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
//        1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\CC2530BL\List" -lA
//        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\CC2530BL\List" -o
//        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\CC2530BL\Obj" -e
//        --debug --core=plain --dptr=16,1 --data_model=large --code_model=near
//        --calling_convention=xdata_reentrant --place_constants=data
//        --nr_virtual_regs 16 -I "C:\Texas Instruments\Z-Stack Mesh
//        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
//        1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\..\Source\" -I
//        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\source\" -I "C:\Texas
//        Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\..\..\..\..\..\Components\hal\include\"
//        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
//        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\..\..\..\..\..\Components\hal\target\_COMMON\CC2530\"
//        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
//        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\..\..\..\..\..\Components\hal\target\CC2530EB\"
//        -Ohz --require_prototypes
//    List file          =  
//        C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
//        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
//        1.0.0\Projects\zstack\Utilities\BootLoad\CC2530\CC2530BL\List\sb_exec.s51
//
///////////////////////////////////////////////////////////////////////////////

        NAME sb_exec

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "near"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?V0
        EXTERN ?V1
        EXTERN ?V2
        EXTERN ?V3
        EXTERN ?V4
        EXTERN ?V5
        EXTERN ?V6
        EXTERN ?V7
        EXTERN ?V8
        EXTERN ?V9
        EXTERN ?V10
        EXTERN ?V11
        EXTERN ?V12
        EXTERN ?V13
        EXTERN ?ADD_XSTACK_DISP0_16
        EXTERN ?ALLOC_XSTACK8
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?FUNC_ENTER_XDATA
        EXTERN ?FUNC_LEAVE_XDATA
        EXTERN ?L_ADD
        EXTERN ?L_ADD_X
        EXTERN ?L_EQ_X
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?S_SHL
        EXTERN ?UL_GE_X
        EXTERN ?UL_SHR
        EXTERN ?US_SHR
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN ?XSTACK_DISP102_8
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBWEAK __Constant_100
        PUBWEAK __Constant_200
        PUBWEAK __Constant_3c800
        PUBWEAK __Constant_90
        PUBWEAK __Constant_ffffe000
        FUNCTION calcCRC,0a1203H
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 535, STACK
        FUNCTION recalcCRC,0a1203H
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 279, STACK
        FUNCTION runPoly,080203H
        ARGFRAME XSTACK, 533, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        FUNCTION sbCmnd,0a1203H
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 23, STACK
        PUBLIC sbExec
        FUNCTION sbExec,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 10, STACK
        PUBLIC sbImgValid
        FUNCTION sbImgValid,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
          CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:16, ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-2
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
        
          CFI Common cfiCommon1 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-2
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B SameValue
          CFI A SameValue
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 SameValue
          CFI R1 SameValue
          CFI R2 SameValue
          CFI R3 SameValue
          CFI R4 SameValue
          CFI R5 SameValue
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon1
        
        EXTERN HalFlashErase
        FUNCTION HalFlashErase,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalFlashRead
        FUNCTION HalFlashRead,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 535, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalFlashWrite
        FUNCTION HalFlashWrite,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalUARTReadISR
        FUNCTION HalUARTReadISR,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalUARTWriteISR
        FUNCTION HalUARTWriteISR,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC

// C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh 1.0.0\Projects\zstack\Utilities\BootLoad\Source\sb_exec.c
//    1 /**************************************************************************************************
//    2   Filename:       sb_exec.c
//    3   Revised:        $Date: 2013-09-12 17:23:02 -0700 (Thu, 12 Sep 2013) $
//    4   Revision:       $Revision: 35297 $
//    5 
//    6   Description:    Serial Bootloader Executive.
//    7 
//    8   Copyright 2013 Texas Instruments Incorporated. All rights reserved.
//    9 
//   10   IMPORTANT: Your use of this Software is limited to those specific rights
//   11   granted under the terms of a software license agreement between the user
//   12   who downloaded the software, his/her employer (which must be your employer)
//   13   and Texas Instruments Incorporated (the "License").  You may not use this
//   14   Software unless you agree to abide by the terms of the License. The License
//   15   limits your use, and you acknowledge, that the Software may not be modified,
//   16   copied or distributed unless embedded on a Texas Instruments microcontroller
//   17   or used solely and exclusively in conjunction with a Texas Instruments radio
//   18   frequency transceiver, which is integrated into your product.  Other than for
//   19   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   20   works of, modify, distribute, perform, display or sell this Software and/or
//   21   its documentation for any purpose.
//   22 
//   23   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   24   PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
//   25   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
//   26   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   27   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   28   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   29   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   30   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   31   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   32   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   33   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   34 
//   35   Should you have any questions regarding your right to use this Software,
//   36   contact Texas Instruments Incorporated at www.TI.com. 
//   37 **************************************************************************************************/
//   38 
//   39 /* ------------------------------------------------------------------------------------------------
//   40  *                                          Includes 
//   41  * ------------------------------------------------------------------------------------------------
//   42  */
//   43 
//   44 #include "hal_board_cfg.h"
//   45 #include "hal_flash.h"
//   46 #include "hal_types.h"
//   47 #include "sb_exec.h"
//   48 #include "sb_main.h"
//   49 
//   50 /* ------------------------------------------------------------------------------------------------
//   51  *                                          Constants
//   52  * ------------------------------------------------------------------------------------------------
//   53  */
//   54 
//   55 #if !defined MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA
//   56 #define MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA  FALSE
//   57 #endif
//   58 
//   59 /* ------------------------------------------------------------------------------------------------
//   60  *                                       Local Variables
//   61  * ------------------------------------------------------------------------------------------------
//   62  */
//   63 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   64 static uint8 sbBuf[SB_BUF_SIZE], sbCmd1, sbCmd2, sbFcs, sbIdx, sbLen, sbSte;
sbBuf:
        DS 128
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbCmd1:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbCmd2:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbFcs:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbIdx:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbLen:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
sbSte:
        DS 1
        REQUIRE __INIT_XDATA_Z
//   65   
//   66 /* ------------------------------------------------------------------------------------------------
//   67  *                                       Local Functions
//   68  * ------------------------------------------------------------------------------------------------
//   69  */
//   70 
//   71 static uint8 sbCmnd(void);
//   72 static void sbResp(uint8 rsp, uint8 len);
//   73 static uint16 calcCRC(void);
//   74 static uint16 recalcCRC(void);
//   75 static uint16 runPoly(uint16 crc, uint8 val);
//   76 
//   77 /**************************************************************************************************
//   78  * @fn          sbExec
//   79  *
//   80  * @brief       Boot Loader main executive processing.
//   81  *
//   82  * input parameters
//   83  *
//   84  * None.
//   85  *
//   86  * output parameters
//   87  *
//   88  * None.
//   89  *
//   90  * @return      TRUE if sbCmnd() returns TRUE, indicating that an SB_ENABLE_CMD succeeded;
//   91  *              FALSE otherwise.
//   92  **************************************************************************************************
//   93  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//   94 uint8 sbExec(void)
sbExec:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function sbExec
        CODE
//   95 {
        FUNCALL sbExec, sbCmnd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbExec, HalUARTReadISR
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV     A,#-0x9
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 1
        MOV     A,#-0x1
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
//   96   uint8 ch, rtrn = FALSE;
        MOV     R6,#0x0
        SJMP    ??sbExec_0
//   97 
//   98   while (SB_RX(&ch))
//   99   {
//  100     sbBuf[sbSte + sbIdx] = ch;
//  101     switch (sbSte)
//  102     {
//  103     case SB_SOF_STATE:
//  104       if (SB_SOF == ch)
//  105       {
//  106         sbSte = SB_LEN_STATE;
//  107       }
//  108       break;
//  109     
//  110     case SB_LEN_STATE:
//  111       sbFcs = 0;
//  112       sbSte = ((sbLen = ch) >= SB_BUF_SIZE) ? SB_SOF_STATE : SB_CMD1_STATE;
//  113       break;
//  114 
//  115     case SB_CMD1_STATE:
//  116       sbCmd1 = ch;
//  117       sbSte = SB_CMD2_STATE;
//  118       break;
//  119     
//  120     case SB_CMD2_STATE:
//  121       sbCmd2 = ch;
//  122       sbSte = (sbLen) ? SB_DATA_STATE : SB_FCS_STATE;
//  123       break;
//  124 
//  125     case SB_DATA_STATE:
//  126       if (++sbIdx == sbLen)
//  127       {
//  128         sbSte = SB_FCS_STATE;
//  129       }
//  130       break;
//  131     
//  132     case SB_FCS_STATE:
//  133       if ((sbFcs == ch) && (sbCmd1 == SB_RPC_SYS_BOOT))
??sbExec_1:
        MOV     DPTR,#sbFcs
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??sbExec_2
        MOV     DPTR,#sbCmd1
        MOVX    A,@DPTR
        XRL     A,#0x4d
        JNZ     ??sbExec_2
//  134       {
//  135         rtrn = sbCmnd();
        ; Setup parameters for call to function sbCmnd
        LCALL   sbCmnd
        MOV     A,R1
        MOV     R6,A
//  136       }
//  137       else
//  138       {
//  139         // TODO - RemoTI did not have here or on bad length - adding could cause > 1 SB_INVALID_FCS
//  140         //        for a single data packet which could put out of sync with PC for awhile or
//  141         //        infinte, depending on PC-side?
//  142         // sbResp(SB_INVALID_FCS, 1);
//  143       }
//  144     
//  145       sbSte = sbIdx = 0;
??sbExec_2:
        MOV     DPTR,#sbIdx
        CLR     A
        MOVX    @DPTR,A
        MOV     DPTR,#sbSte
??sbExec_3:
        MOVX    @DPTR,A
//  146       break;
//  147     
//  148     default:
//  149       break;
//  150     }
//  151     sbFcs ^= ch;
??sbExec_4:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     DPTR,#sbFcs
        MOVX    A,@DPTR
        XRL     A,R0
        MOVX    @DPTR,A
??sbExec_0:
        ; Setup parameters for call to function HalUARTReadISR
        MOV     R4,#0x1
        MOV     R5,#0x0
        MOV     R2,?XSP + 0
        MOV     R3,?XSP + 1
        LCALL   HalUARTReadISR
        MOV     ?V1,R3
        MOV     A,R2
        ORL     A,?V1
        JNZ     $+5
        LJMP    ??sbExec_5
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     DPTR,#sbSte
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     DPTR,#sbIdx
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R2
        ADD     A,R0
        MOV     R0,A
        CLR     A
        ADDC    A,#0x0
        MOV     R1,A
        MOV     A,#sbBuf & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(sbBuf >> 8) & 0xff
        ADDC    A,R1
        MOV     DPH,A
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
        MOV     DPTR,#sbSte
        MOVX    A,@DPTR
        JZ      ??sbExec_6
        DEC     A
        JZ      ??sbExec_7
        DEC     A
        JZ      ??sbExec_8
        DEC     A
        JZ      ??sbExec_9
        DEC     A
        JZ      ??sbExec_10
        DEC     A
        JNZ     $+5
        LJMP    ??sbExec_1
        SJMP    ??sbExec_4
??sbExec_6:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        XRL     A,#0xfe
        JNZ     ??sbExec_4
        MOV     DPTR,#sbSte
        MOV     A,#0x1
        SJMP    ??sbExec_3
??sbExec_7:
        MOV     DPTR,#sbFcs
        CLR     A
        LCALL   ?Subroutine7
??CrossCallReturnLabel_11:
        MOV     DPTR,#sbLen
        MOVX    @DPTR,A
        CLR     C
        SUBB    A,#-0x80
        MOV     DPTR,#sbSte
        JC      ??sbExec_11
        CLR     A
        LJMP    ??sbExec_3
??sbExec_11:
        MOV     A,#0x2
        LJMP    ??sbExec_3
??sbExec_8:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     DPTR,#sbCmd1
        MOVX    @DPTR,A
        MOV     DPTR,#sbSte
        MOV     A,#0x3
        LJMP    ??sbExec_3
??sbExec_9:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     DPTR,#sbCmd2
        MOVX    @DPTR,A
        MOV     DPTR,#sbLen
        MOVX    A,@DPTR
        JZ      ??sbExec_12
        MOV     DPTR,#sbSte
        MOV     A,#0x4
        LJMP    ??sbExec_3
??sbExec_10:
        MOV     DPTR,#sbIdx
        MOVX    A,@DPTR
        INC     A
        MOVX    @DPTR,A
        MOV     R0,A
        MOV     DPTR,#sbLen
        MOVX    A,@DPTR
        XRL     A,R0
        JZ      $+5
        LJMP    ??sbExec_4
??sbExec_12:
        MOV     DPTR,#sbSte
        MOV     A,#0x5
        LJMP    ??sbExec_3
//  152   }
//  153 
//  154   return rtrn;
??sbExec_5:
        MOV     A,R6
        MOV     R1,A
        MOV     A,#0x1
          CFI EndBlock cfiBlock0
        REQUIRE ?Subroutine0
        ; // Fall through to label ?Subroutine0
//  155 }

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine0:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Valid
        MOV     R7,#0x2
        LJMP    ?FUNC_LEAVE_XDATA
          CFI EndBlock cfiBlock1
//  156 
//  157 /**************************************************************************************************
//  158  * @fn          sbImgValid
//  159  *
//  160  * @brief       Check validity of the run-code image.
//  161  *
//  162  * input parameters
//  163  *
//  164  * None.
//  165  *
//  166  * output parameters
//  167  *
//  168  * None.
//  169  *
//  170  * @return      TRUE or FALSE for image valid.
//  171  **************************************************************************************************
//  172  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//  173 uint8 sbImgValid(void)
sbImgValid:
          CFI Block cfiBlock2 Using cfiCommon0
          CFI Function sbImgValid
        CODE
//  174 {
        FUNCALL sbImgValid, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbImgValid, calcCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbImgValid, recalcCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbImgValid, HalFlashWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbImgValid, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV     A,#-0x9
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//  175   uint16 crc[2];
//  176 
//  177 
//  178   HalFlashRead(HAL_SB_CRC_ADDR / HAL_FLASH_PAGE_SIZE,
//  179                HAL_SB_CRC_ADDR % HAL_FLASH_PAGE_SIZE,
//  180                (uint8 *)crc, sizeof(crc));
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V0,#0x4
        MOV     ?V1,#0x0
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#-0x70
        MOV     R3,#0x0
        MOV     R1,#0x4
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//  181 
//  182   if ((crc[0] == 0xFFFF) || (crc[0] == 0x0000))
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        CPL     A
        JNZ     ??sbImgValid_0
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??sbImgValid_0:
        JZ      ??sbImgValid_1
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JNZ     ??sbImgValid_2
//  183   {
//  184     return FALSE;
??sbImgValid_1:
        LJMP    ??sbImgValid_3
//  185   }
//  186 
//  187   if (crc[0] != crc[1])
??sbImgValid_2:
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??sbImgValid_4
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbImgValid_4:
        JZ      ??sbImgValid_5
//  188   {
//  189     crc[1] = calcCRC();
        ; Setup parameters for call to function calcCRC
        LCALL   calcCRC
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     R0,?V0
        MOV     R1,?V1
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine2
//  190 	if ( crc[0] != crc[1] )
??CrossCallReturnLabel_0:
        JNZ     ??sbImgValid_6
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbImgValid_6:
        JZ      ??sbImgValid_7
//  191 	{
//  192 		crc[1] = recalcCRC();
        ; Setup parameters for call to function recalcCRC
        LCALL   recalcCRC
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  193 	}
//  194     HalFlashWrite((HAL_SB_CRC_ADDR / HAL_FLASH_WORD_SIZE), (uint8 *)crc, 1);
??sbImgValid_7:
        ; Setup parameters for call to function HalFlashWrite
        MOV     ?V0,#0x1
        MOV     ?V1,#0x0
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#0x24
        MOV     R3,#0x8
        LCALL   HalFlashWrite
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//  195     HalFlashRead(  HAL_SB_CRC_ADDR / HAL_FLASH_PAGE_SIZE,
//  196                    HAL_SB_CRC_ADDR % HAL_FLASH_PAGE_SIZE,
//  197                    (uint8 *)crc, sizeof(crc));
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V0,#0x4
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#-0x70
        MOV     R3,#0x0
        MOV     R1,#0x4
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//  198   }
//  199 
//  200   return ((crc[0] == crc[1]) && (crc[0] != 0xFFFF) && (crc[0] != 0x0000));
??sbImgValid_5:
        LCALL   ?Subroutine3
??CrossCallReturnLabel_2:
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??sbImgValid_8
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbImgValid_8:
        JNZ     ??sbImgValid_3
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        CPL     A
        JNZ     ??sbImgValid_9
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??sbImgValid_9:
        JZ      ??sbImgValid_3
        MOV     A,R0
        ORL     A,R1
        JZ      ??sbImgValid_3
        MOV     R1,#0x1
        SJMP    ??sbImgValid_10
??sbImgValid_3:
        MOV     R1,#0x0
??sbImgValid_10:
        MOV     A,#0x4
        LJMP    ?Subroutine0
//  201 }
          CFI EndBlock cfiBlock2
//  202 
//  203 /**************************************************************************************************
//  204  * @fn          sbCmnd
//  205  *
//  206  * @brief       Act on the SB command and received buffer.
//  207  *
//  208  * input parameters
//  209  *
//  210  * None.
//  211  *
//  212  * output parameters
//  213  *
//  214  * None.
//  215  *
//  216  * @return      TRUE to indicate that the SB_ENABLE_CMD command was successful; FALSE otherwise.
//  217  **************************************************************************************************
//  218  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//  219 static uint8 sbCmnd(void)
sbCmnd:
          CFI Block cfiBlock3 Using cfiCommon0
          CFI Function sbCmnd
        CODE
//  220 {
        FUNCALL sbCmnd, HalFlashErase
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalFlashWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, calcCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, recalcCRC
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalFlashWrite
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 23, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 23, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL sbCmnd, HalUARTWriteISR
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        REQUIRE ?V8
        REQUIRE ?V9
        MOV     A,#-0x11
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 17)
        ; Saved register size: 17
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  221   uint16 tmp = BUILD_UINT16(sbBuf[SB_DATA_STATE], sbBuf[SB_DATA_STATE+1]) + SB_IMG_OSET;
        MOV     DPTR,#sbBuf + 4
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        CLR     A
        XCH     A,R0
        MOV     R1,A
        MOV     A,R2
        ADD     A,R0
        MOV     R6,A
        MOV     A,R1
        ADDC    A,#0x8
        MOV     R7,A
//  222   uint16 crc[2];
//  223   uint8 len = 1;
        MOV     ?V2,#0x1
//  224   uint8 rsp = SB_SUCCESS;
        MOV     ?V1,#0x0
//  225   uint8 rtrn = FALSE;
        MOV     ?V0,#0x0
//  226 
//  227   switch (sbCmd2)
        MOV     A,R6
        MOV     ?V8,A
        MOV     A,R7
        ANL     A,#0x1
        MOV     ?V9,A
        MOV     ?V6,R6
        MOV     ?V7,R7
        MOV     A,#0x9
        MOV     R0,#?V6
        LCALL   ?US_SHR
        MOV     ?V4,?V6
        MOV     DPTR,#sbCmd2
        MOVX    A,@DPTR
        DEC     A
        JZ      ??sbCmnd_0
        DEC     A
        JZ      ??sbCmnd_1
        DEC     A
        JZ      ??sbCmnd_2
        LJMP    ??sbCmnd_3
//  228   {
//  229   case SB_HANDSHAKE_CMD:
//  230     break;
//  231 
//  232   case SB_WRITE_CMD:
//  233     if ((tmp % SB_WPG_SIZE) == 0)
??sbCmnd_0:
        MOV     A,R2
        ORL     A,?V9
        JNZ     ??sbCmnd_4
//  234     {
//  235       HalFlashErase(tmp / SB_WPG_SIZE);
        ; Setup parameters for call to function HalFlashErase
        MOV     R1,?V4
        LCALL   HalFlashErase
//  236     }
//  237 
//  238     HalFlashWrite(tmp, sbBuf+SB_DATA_STATE+2, SB_RW_BUF_LEN / HAL_FLASH_WORD_SIZE);
??sbCmnd_4:
        ; Setup parameters for call to function HalFlashWrite
        MOV     ?V4,#0x10
        MOV     ?V5,#0x0
        MOV     R0,#?V4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#(sbBuf + 6) & 0xff
        MOV     R5,#((sbBuf + 6) >> 8) & 0xff
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   HalFlashWrite
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  239     break;
        LJMP    ??sbCmnd_3
//  240 
//  241   case SB_READ_CMD:
//  242 #if !MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA
//  243     if ((tmp / (HAL_FLASH_PAGE_SIZE / 4)) >= HAL_NV_PAGE_BEG)
??sbCmnd_1:
        CLR     C
        MOV     A,?V4
        SUBB    A,#0x79
        SUBB    A,0xE0 /* A   */
        JC      ??sbCmnd_5
//  244     {
//  245       rsp = SB_FAILURE;
        MOV     ?V1,#0x1
//  246       break;
        LJMP    ??sbCmnd_3
//  247     }
//  248 #endif
//  249     HalFlashRead(tmp / (HAL_FLASH_PAGE_SIZE / 4),
//  250                  (tmp % (HAL_FLASH_PAGE_SIZE / 4)) << 2,
//  251                  sbBuf + SB_DATA_STATE + 3, SB_RW_BUF_LEN);
??sbCmnd_5:
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V2,#0x40
        MOV     ?V3,#0x0
        MOV     R0,#?V2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     R4,#(sbBuf + 7) & 0xff
        MOV     R5,#((sbBuf + 7) >> 8) & 0xff
        MOV     A,#0x2
        MOV     R0,#?V8
        LCALL   ?S_SHL
        MOV     R2,?V8
        MOV     R3,?V9
        MOV     R1,?V4
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  252     sbBuf[SB_DATA_STATE+2] = sbBuf[SB_DATA_STATE+1];
        MOV     DPTR,#sbBuf + 5
        MOVX    A,@DPTR
        INC     DPTR
        MOVX    @DPTR,A
//  253     sbBuf[SB_DATA_STATE+1] = sbBuf[SB_DATA_STATE];
        MOV     DPTR,#sbBuf + 4
        MOVX    A,@DPTR
        INC     DPTR
        MOVX    @DPTR,A
//  254     len = SB_RW_BUF_LEN + 3;
        MOV     ?V2,#0x43
//  255     break;
        LJMP    ??sbCmnd_3
//  256   
//  257   case SB_ENABLE_CMD:
//  258     HalFlashRead(HAL_SB_CRC_ADDR / HAL_FLASH_PAGE_SIZE,
//  259                  HAL_SB_CRC_ADDR % HAL_FLASH_PAGE_SIZE,
//  260                  (uint8 *)crc, sizeof(crc));
??sbCmnd_2:
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V4,#0x4
        MOV     ?V5,#0x0
        MOV     R0,#?V4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#-0x70
        MOV     R3,#0x0
        MOV     R1,#0x4
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  261 
//  262     // Bootload master must have verified extra checks to be issuing the SB_ENABLE_CMD.
//  263     //if ((crc[0] != crc[1]) && (crc[0] != 0xFFFF) && (crc[0] != 0x0000))
//  264 
//  265 //    if (crc[1] != crc[0])
//  266 //    {
//  267 //      crc[1] = crc[0];
//  268 //      HalFlashWrite((HAL_SB_CRC_ADDR / HAL_FLASH_WORD_SIZE), (uint8 *)crc, 1);
//  269 //      HalFlashRead(  HAL_SB_CRC_ADDR / HAL_FLASH_PAGE_SIZE,
//  270 //                     HAL_SB_CRC_ADDR % HAL_FLASH_PAGE_SIZE,
//  271 //                     (uint8 *)crc, sizeof(crc));
//  272 //    }
//  273 	
//  274 	if (crc[0] != crc[1])
        LCALL   ?Subroutine3
??CrossCallReturnLabel_3:
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??sbCmnd_6
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbCmnd_6:
        JZ      ??sbCmnd_7
//  275 	{
//  276 		crc[1] = calcCRC();
        ; Setup parameters for call to function calcCRC
        LCALL   calcCRC
        MOV     ?V4,R2
        MOV     ?V5,R3
        MOV     R0,?V4
        MOV     R1,?V5
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        LCALL   ?Subroutine2
//  277 		if (crc[0] != crc[1])
??CrossCallReturnLabel_1:
        JNZ     ??sbCmnd_8
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbCmnd_8:
        JZ      ??sbCmnd_9
//  278 		{
//  279 			crc[1] = recalcCRC();
        ; Setup parameters for call to function recalcCRC
        LCALL   recalcCRC
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  280 		}
//  281 		HalFlashWrite((HAL_SB_CRC_ADDR / HAL_FLASH_WORD_SIZE), (uint8 *)crc, 1);
??sbCmnd_9:
        ; Setup parameters for call to function HalFlashWrite
        MOV     ?V4,#0x1
        MOV     ?V5,#0x0
        MOV     R0,#?V4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#0x24
        MOV     R3,#0x8
        LCALL   HalFlashWrite
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  282 		HalFlashRead(  HAL_SB_CRC_ADDR / HAL_FLASH_PAGE_SIZE,
//  283 					   HAL_SB_CRC_ADDR % HAL_FLASH_PAGE_SIZE,
//  284 					   (uint8 *)crc, sizeof(crc));
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V4,#0x4
        MOV     R0,#?V4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 23)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        MOV     R2,#-0x70
        MOV     R3,#0x0
        MOV     R1,#0x4
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 21)
//  285 	}
//  286 
//  287     // Bootload master must have verified extra checks to be issuing the SB_ENABLE_CMD.
//  288     //if ((crc[0] == crc[1]) && (crc[0] != 0xFFFF) && (crc[0] != 0x0000))
//  289     if ((crc[0] == crc[1]) && (crc[0] != 0xFFFF) && (crc[0] != 0x0000))
??sbCmnd_7:
        LCALL   ?Subroutine3
??CrossCallReturnLabel_4:
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??sbCmnd_10
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,R1
??sbCmnd_10:
        JNZ     ??sbCmnd_11
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        CPL     A
        JNZ     ??sbCmnd_12
        INC     DPTR
        MOVX    A,@DPTR
        CPL     A
??sbCmnd_12:
        JZ      ??sbCmnd_11
        MOV     A,R0
        ORL     A,R1
        JZ      ??sbCmnd_11
//  290     {
//  291       rtrn = TRUE;
        MOV     ?V0,#0x1
        SJMP    ??sbCmnd_3
//  292     }
//  293     else
//  294     {
//  295       rsp = SB_VALIDATE_FAILED;
??sbCmnd_11:
        MOV     ?V1,#0x7
//  296     }
//  297     break;
//  298     
//  299   default:
//  300     break;
//  301   }
//  302   
//  303   sbResp(rsp, len);
??sbCmnd_3:
        MOV     DPTR,#sbBuf + 3
        MOVX    A,@DPTR
        SETB    0xE0 /* A   */.7
        MOVX    @DPTR,A
        MOV     A,?V1
        INC     DPTR
        MOVX    @DPTR,A
        MOV     A,?V2
        MOV     DPTR,#sbBuf + 1
        MOVX    @DPTR,A
        MOV     A,#0x4d
        XRL     A,?V2
        MOV     R4,A
        MOV     A,#0x4
        ADD     A,?V2
        MOV     R6,A
        MOV     R5,#0x3
        SJMP    ??sbCmnd_13
??sbCmnd_14:
        MOVX    A,@DPTR
        XCH     A,R4
        XRL     A,R4
        MOV     R4,A
        INC     R5
??sbCmnd_13:
        MOV     A,R5
        MOV     R2,A
        RLC     A
        SUBB    A,0xE0 /* A   */
        MOV     R3,A
        MOV     A,#sbBuf & 0xff
        ADD     A,R2
        MOV     DPL,A
        MOV     A,#(sbBuf >> 8) & 0xff
        ADDC    A,R3
        MOV     DPH,A
        MOV     A,R6
        MOV     R0,A
        CLR     C
        MOV     A,R2
        SUBB    A,R0
        MOV     A,R3
        SUBB    A,#0x0
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JC      ??sbCmnd_14
        MOV     A,R4
        MOVX    @DPTR,A
        ; Setup parameters for call to function HalUARTWriteISR
        MOV     A,#0x1
        ADD     A,R2
        MOV     R4,A
        RLC     A
        SUBB    A,0xE0 /* A   */
        MOV     R5,A
        MOV     R2,#sbBuf & 0xff
        MOV     R3,#(sbBuf >> 8) & 0xff
        LCALL   HalUARTWriteISR
//  304   return rtrn;
        MOV     R1,?V0
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 17)
        MOV     R7,#0xa
        LJMP    ?FUNC_LEAVE_XDATA
//  305 }
          CFI EndBlock cfiBlock3

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine3:
          CFI Block cfiCond4 Using cfiCommon0
          CFI Function sbImgValid
          CFI Conditional ??CrossCallReturnLabel_2
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 13)
          CFI Block cfiCond5 Using cfiCommon0
          CFI (cfiCond5) Function sbCmnd
          CFI (cfiCond5) Conditional ??CrossCallReturnLabel_3
          CFI (cfiCond5) R6 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond5) VB load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond5) V0 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond5) V1 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond5) V2 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond5) V3 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond5) V4 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond5) V5 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond5) V6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond5) V7 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond5) V8 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond5) V9 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond5) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond5) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond5) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond5) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond5) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond5) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiCond6 Using cfiCommon0
          CFI (cfiCond6) Function sbCmnd
          CFI (cfiCond6) Conditional ??CrossCallReturnLabel_4
          CFI (cfiCond6) R6 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond6) VB load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond6) V0 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond6) V1 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond6) V2 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond6) V3 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond6) V4 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond6) V5 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond6) V6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond6) V7 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond6) V8 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond6) V9 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond6) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond6) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond6) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond6) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond6) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond6) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker7 Using cfiCommon1
          CFI (cfiPicker7) NoFunction
          CFI (cfiPicker7) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,#0x2
        RET
          CFI EndBlock cfiCond4
          CFI EndBlock cfiCond5
          CFI EndBlock cfiCond6
          CFI EndBlock cfiPicker7

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine2:
          CFI Block cfiCond8 Using cfiCommon0
          CFI Function sbImgValid
          CFI Conditional ??CrossCallReturnLabel_0
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 13)
          CFI Block cfiCond9 Using cfiCommon0
          CFI (cfiCond9) Function sbCmnd
          CFI (cfiCond9) Conditional ??CrossCallReturnLabel_1
          CFI (cfiCond9) R6 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond9) VB load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond9) V0 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond9) V1 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond9) V2 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond9) V3 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond9) V4 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond9) V5 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond9) V6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond9) V7 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond9) V8 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond9) V9 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond9) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond9) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond9) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond9) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond9) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond9) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker10 Using cfiCommon1
          CFI (cfiPicker10) NoFunction
          CFI (cfiPicker10) Picker
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        LCALL   ?Subroutine7
??CrossCallReturnLabel_12:
        XRL     A,R0
        RET
          CFI EndBlock cfiCond8
          CFI EndBlock cfiCond9
          CFI EndBlock cfiPicker10

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine7:
          CFI Block cfiCond11 Using cfiCommon0
          CFI Function sbExec
          CFI Conditional ??CrossCallReturnLabel_11
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 10)
          CFI Block cfiCond12 Using cfiCommon0
          CFI (cfiCond12) Function sbImgValid
          CFI (cfiCond12) Conditional ??CrossCallReturnLabel_12, ??CrossCallReturnLabel_0
          CFI (cfiCond12) R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond12) VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond12) V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond12) V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond12) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond12) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond12) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond12) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond12) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond12) CFA_SP SP+-4
          CFI (cfiCond12) CFA_XSP16 add(XSP16, 13)
          CFI Block cfiCond13 Using cfiCommon0
          CFI (cfiCond13) Function sbCmnd
          CFI (cfiCond13) Conditional ??CrossCallReturnLabel_12, ??CrossCallReturnLabel_1
          CFI (cfiCond13) R6 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond13) VB load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond13) V0 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond13) V1 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond13) V2 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond13) V3 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond13) V4 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond13) V5 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond13) V6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond13) V7 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond13) V8 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond13) V9 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond13) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond13) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond13) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond13) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond13) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond13) CFA_SP SP+-4
          CFI (cfiCond13) CFA_XSP16 add(XSP16, 21)
          CFI Block cfiPicker14 Using cfiCommon1
          CFI (cfiPicker14) NoFunction
          CFI (cfiPicker14) Picker
        MOVX    @DPTR,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        RET
          CFI EndBlock cfiCond11
          CFI EndBlock cfiCond12
          CFI EndBlock cfiCond13
          CFI EndBlock cfiPicker14
//  306 
//  307 /**************************************************************************************************
//  308  * @fn          sbResp
//  309  *
//  310  * @brief       Make the SB response.
//  311  *
//  312  * input parameters
//  313  *
//  314  * @param       rsp - The byte code response to send.
//  315  * @param       len - The data length of the response.
//  316  *
//  317  * output parameters
//  318  *
//  319  * None.
//  320  *
//  321  * @return      None.
//  322  **************************************************************************************************
//  323  */
//  324 static void sbResp(uint8 rsp, uint8 len)
//  325 {
//  326   int8 idx;
//  327 
//  328   sbBuf[SB_CMD2_STATE] |= 0x80;
//  329   sbBuf[SB_DATA_STATE] = rsp;
//  330   sbBuf[SB_LEN_STATE] = len;
//  331   rsp = len ^ SB_RPC_SYS_BOOT;
//  332   len += SB_FCS_STATE-1;
//  333 
//  334   for (idx = SB_CMD2_STATE; idx < len; idx++)
//  335   {
//  336     rsp ^= sbBuf[idx];
//  337   }
//  338   sbBuf[idx++] = rsp;
//  339   
//  340   SB_TX(sbBuf, idx);
//  341 }
//  342 
//  343 /**************************************************************************************************
//  344  * @fn          calcCRC
//  345  *
//  346  * @brief       Run the CRC16 Polynomial calculation over the RC image.
//  347  *
//  348  * input parameters
//  349  *
//  350  * None.
//  351  *
//  352  * output parameters
//  353  *
//  354  * None.
//  355  *
//  356  * @return      The CRC16 calculated.
//  357  **************************************************************************************************
//  358  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//  359 static uint16 calcCRC(void)
calcCRC:
          CFI Block cfiBlock15 Using cfiCommon0
          CFI Function calcCRC
        CODE
//  360 {
        FUNCALL calcCRC, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 535, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 535, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL calcCRC, runPoly
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 533, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 533, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL calcCRC, runPoly
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 533, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 1, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 533, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL calcCRC, runPoly
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 533, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 533, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        REQUIRE ?V8
        REQUIRE ?V9
        REQUIRE ?V10
        REQUIRE ?V11
        REQUIRE ?V12
        REQUIRE ?V13
        MOV     A,#-0x15
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 21)
        ; Saved register size: 21
        ; Auto size: 512
        MOV     DPL,#0x0
        MOV     DPH,#-0x2
        LCALL   ?ADD_XSTACK_DISP0_16
          CFI CFA_XSP16 add(XSP16, 533)
//  361 	uint32 addr;
//  362 	uint16 crc = 0;
        MOV     R6,#0x0
        MOV     R7,#0x0
//  363 	uint32 offset = HAL_SB_IMG_ADDR;
//  364 	uint16 read_size = 512;
//  365 	uint8 buf[512];
//  366 	uint16 i;
//  367 
//  368   // Run the CRC calculation over the active body of code.
//  369 /*  for (addr = HAL_SB_IMG_ADDR; addr < HAL_SB_IMG_ADDR + HAL_SB_IMG_SIZE; addr++)
//  370   {
//  371     if (addr == HAL_SB_CRC_ADDR)
//  372     {
//  373       addr += 3;
//  374     }
//  375     else
//  376     {
//  377       uint8 buf;
//  378       HalFlashRead(addr / HAL_FLASH_PAGE_SIZE, addr % HAL_FLASH_PAGE_SIZE, &buf, 1);
//  379       crc = runPoly(crc, buf);
//  380     }
//  381   }
//  382 */ 
//  383 
//  384 	// modified by qnchen
//  385 	for ( addr = offset; addr < offset + HAL_SB_IMG_SIZE; addr += read_size )
        MOV     ?V8,R6
        MOV     ?V9,#0x20
        MOV     ?V10,R6
        MOV     ?V11,R6
//  386 	{
//  387 		HalFlashRead(addr / HAL_FLASH_PAGE_SIZE, addr % HAL_FLASH_PAGE_SIZE, buf, read_size);
??calcCRC_0:
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V0,#0x0
        MOV     ?V1,#0x2
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 535)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        LCALL   ?Subroutine5
??CrossCallReturnLabel_7:
        LCALL   ?UL_SHR
        MOV     R1,?V0
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 533)
//  388 		for ( i = 0; i < read_size; i++ )
        MOV     ?V12,#0x0
        MOV     ?V13,#0x0
//  389 		{
//  390 			// crc in 0x2090
//  391 			if ( (addr - offset + i) == (HAL_SB_CRC_ADDR - HAL_SB_IMG_ADDR) )
??calcCRC_1:
        MOV     ?V4,?V8
        MOV     ?V5,?V9
        MOV     ?V6,?V10
        MOV     ?V7,?V11
        MOV     ?V0,?V12
        MOV     ?V1,?V13
        CLR     A
        MOV     ?V2,A
        MOV     R0,#?V4
        MOV     R1,#?V0
        LCALL   ?L_ADD
        MOV     DPTR,#__Constant_ffffe000
        MOV     R0,#?V4
        LCALL   ?L_ADD_X
        MOV     DPH,#(__Constant_90 >> 8) & 0xff
        MOV     DPL,#__Constant_90 & 0xff
        MOV     R0,#?V4
        LCALL   ?L_EQ_X
        JNZ     ??calcCRC_2
//  392 			{
//  393 				i += 3;
        LCALL   ?Subroutine6
//  394 			}
??CrossCallReturnLabel_9:
        SJMP    ??calcCRC_3
//  395 			else
//  396 			{
//  397 				crc = runPoly(crc, buf[i]);
??calcCRC_2:
        ; Setup parameters for call to function runPoly
        LCALL   ?Subroutine4
//  398 			}
//  399 		}
??CrossCallReturnLabel_5:
        LCALL   runPoly
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     R6,?V0
        MOV     R7,?V1
??calcCRC_3:
        INC     ?V12
        MOV     A,?V12
        JNZ     ??calcCRC_4
        INC     ?V13
??calcCRC_4:
        CLR     C
        MOV     A,?V13
        SUBB    A,#0x2
        JC      ??calcCRC_1
//  400 	}
        MOV     DPTR,#__Constant_200
        MOV     R0,#?V8
        LCALL   ?L_ADD_X
        MOV     DPTR,#__Constant_3c800
        MOV     R0,#?V8
        LCALL   ?UL_GE_X
        JC      $+5
        LJMP    ??calcCRC_0
//  401 
//  402   // IAR note explains that poly must be run with value zero for each byte of crc.
//  403   crc = runPoly(crc, 0);
//  404   crc = runPoly(crc, 0);
//  405 
//  406   return crc;
        ; Setup parameters for call to function runPoly
        CLR     A
        PUSH    A
          CFI CFA_SP SP+-1
        ; Setup parameters for call to function runPoly
        MOV     R1,A
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   runPoly
        POP     A
          CFI CFA_SP SP+0
        MOV     R1,A
        LCALL   runPoly
        MOV     DPL,#0x0
        MOV     DPH,#0x2
          CFI EndBlock cfiBlock15
        REQUIRE ?Subroutine1
        ; // Fall through to label ?Subroutine1
//  407 }

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine1:
          CFI Block cfiBlock16 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 533)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI Invalid
        LCALL   ?ADD_XSTACK_DISP0_16
          CFI CFA_XSP16 add(XSP16, 21)
          CFI Valid
        MOV     R7,#0xe
        LJMP    ?FUNC_LEAVE_XDATA
          CFI EndBlock cfiBlock16
//  408 
//  409 
//  410 /**************************************************************************************************
//  411  * @fn          calcCRC
//  412  *
//  413  * @brief       Run the CRC16 Polynomial calculation over the RC image.
//  414  *
//  415  * input parameters
//  416  *
//  417  * None.
//  418  *
//  419  * output parameters
//  420  *
//  421  * None.
//  422  *
//  423  * @return      The CRC16 calculated.
//  424  **************************************************************************************************
//  425  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//  426 static uint16 recalcCRC(void)
recalcCRC:
          CFI Block cfiBlock17 Using cfiCommon0
          CFI Function recalcCRC
        CODE
//  427 {
        FUNCALL recalcCRC, HalFlashRead
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 279, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 279, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL recalcCRC, runPoly
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 277, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 277, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL recalcCRC, runPoly
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 277, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 1, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 277, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL recalcCRC, runPoly
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 277, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 277, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        REQUIRE ?V8
        REQUIRE ?V9
        REQUIRE ?V10
        REQUIRE ?V11
        REQUIRE ?V12
        REQUIRE ?V13
        MOV     A,#-0x15
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 21)
        ; Saved register size: 21
        ; Auto size: 256
        MOV     DPL,#0x0
        MOV     DPH,#-0x1
        LCALL   ?ADD_XSTACK_DISP0_16
          CFI CFA_XSP16 add(XSP16, 277)
//  428 	uint32 addr;
//  429 	uint16 crc = 0;
        MOV     R6,#0x0
        MOV     R7,#0x0
//  430 	uint32 offset = HAL_SB_IMG_ADDR;
//  431 	uint16 read_size = 256;
//  432 	uint8 buf[256];
//  433 	uint16 i;
//  434 
//  435 	for ( addr = offset; addr < offset + HAL_SB_IMG_SIZE; addr += read_size )
        MOV     ?V8,R6
        MOV     ?V9,#0x20
        MOV     ?V10,R6
        MOV     ?V11,R6
//  436 	{
//  437 		HalFlashRead(addr / HAL_FLASH_PAGE_SIZE, addr % HAL_FLASH_PAGE_SIZE, buf, read_size);
??recalcCRC_0:
        ; Setup parameters for call to function HalFlashRead
        MOV     ?V0,#0x0
        MOV     ?V1,#0x1
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 279)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        LCALL   ?Subroutine5
??CrossCallReturnLabel_8:
        LCALL   ?UL_SHR
        MOV     R1,?V0
        LCALL   HalFlashRead
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 277)
//  438 		for ( i = 0; i < read_size; i++ )
        MOV     ?V12,#0x0
        MOV     ?V13,#0x0
//  439 		{
//  440 			// crc in 0x2090
//  441 			if ( (addr - offset + i) == (HAL_SB_CRC_ADDR - HAL_SB_IMG_ADDR) )
??recalcCRC_1:
        MOV     ?V4,?V8
        MOV     ?V5,?V9
        MOV     ?V6,?V10
        MOV     ?V7,?V11
        MOV     ?V0,?V12
        MOV     ?V1,?V13
        CLR     A
        MOV     ?V2,A
        MOV     R0,#?V4
        MOV     R1,#?V0
        LCALL   ?L_ADD
        MOV     DPTR,#__Constant_ffffe000
        MOV     R0,#?V4
        LCALL   ?L_ADD_X
        MOV     DPH,#(__Constant_90 >> 8) & 0xff
        MOV     DPL,#__Constant_90 & 0xff
        MOV     R0,#?V4
        LCALL   ?L_EQ_X
        JNZ     ??recalcCRC_2
//  442 			{
//  443 				i += 3;
        LCALL   ?Subroutine6
//  444 			}
??CrossCallReturnLabel_10:
        SJMP    ??recalcCRC_3
//  445 			else
//  446 			{
//  447 				crc = runPoly(crc, buf[i]);
??recalcCRC_2:
        ; Setup parameters for call to function runPoly
        LCALL   ?Subroutine4
//  448 			}
//  449 		}
??CrossCallReturnLabel_6:
        LCALL   runPoly
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     R6,?V0
        MOV     R7,?V1
??recalcCRC_3:
        INC     ?V12
        MOV     A,?V12
        JNZ     ??recalcCRC_4
        INC     ?V13
??recalcCRC_4:
        CLR     C
        MOV     A,?V13
        SUBB    A,#0x1
        JC      ??recalcCRC_1
//  450 	}
        MOV     DPTR,#__Constant_100
        MOV     R0,#?V8
        LCALL   ?L_ADD_X
        MOV     DPTR,#__Constant_3c800
        MOV     R0,#?V8
        LCALL   ?UL_GE_X
        JC      $+5
        LJMP    ??recalcCRC_0
//  451 
//  452   // IAR note explains that poly must be run with value zero for each byte of crc.
//  453   crc = runPoly(crc, 0);
//  454   crc = runPoly(crc, 0);
//  455 
//  456   return crc;
        ; Setup parameters for call to function runPoly
        CLR     A
        PUSH    A
          CFI CFA_SP SP+-1
        ; Setup parameters for call to function runPoly
        MOV     R1,A
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   runPoly
        POP     A
          CFI CFA_SP SP+0
        MOV     R1,A
        LCALL   runPoly
        MOV     DPL,#0x0
        MOV     DPH,#0x1
        LJMP    ?Subroutine1
//  457 }
          CFI EndBlock cfiBlock17

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine6:
          CFI Block cfiCond18 Using cfiCommon0
          CFI Function calcCRC
          CFI Conditional ??CrossCallReturnLabel_9
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 533)
          CFI Block cfiCond19 Using cfiCommon0
          CFI (cfiCond19) Function recalcCRC
          CFI (cfiCond19) Conditional ??CrossCallReturnLabel_10
          CFI (cfiCond19) R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI (cfiCond19) VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond19) V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond19) V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond19) V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond19) V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond19) V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond19) V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond19) V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond19) V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond19) V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond19) V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond19) V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond19) V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond19) V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond19) V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond19) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond19) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond19) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond19) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond19) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond19) CFA_XSP16 add(XSP16, 277)
          CFI Block cfiPicker20 Using cfiCommon1
          CFI (cfiPicker20) NoFunction
          CFI (cfiPicker20) Picker
        MOV     A,?V12
        ADD     A,#0x3
        MOV     ?V12,A
        CLR     A
        ADDC    A,?V13
        MOV     ?V13,A
        RET
          CFI EndBlock cfiCond18
          CFI EndBlock cfiCond19
          CFI EndBlock cfiPicker20

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine5:
          CFI Block cfiCond21 Using cfiCommon0
          CFI Function calcCRC
          CFI Conditional ??CrossCallReturnLabel_7
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 535)
          CFI Block cfiCond22 Using cfiCommon0
          CFI (cfiCond22) Function recalcCRC
          CFI (cfiCond22) Conditional ??CrossCallReturnLabel_8
          CFI (cfiCond22) R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI (cfiCond22) VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond22) V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond22) V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond22) V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond22) V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond22) V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond22) V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond22) V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond22) V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond22) V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond22) V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond22) V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond22) V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond22) V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond22) V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond22) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond22) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond22) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond22) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond22) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond22) CFA_XSP16 add(XSP16, 279)
          CFI Block cfiPicker23 Using cfiCommon1
          CFI (cfiPicker23) NoFunction
          CFI (cfiPicker23) Picker
        MOV     ?V0,?V8
        MOV     ?V1,?V9
        MOV     R2,?V0
        MOV     A,?V1
        ANL     A,#0x7
        MOV     R3,A
        MOV     ?V2,?V10
        MOV     ?V3,?V11
        MOV     A,#0xb
        MOV     R0,#?V0
        RET
          CFI EndBlock cfiCond21
          CFI EndBlock cfiCond22
          CFI EndBlock cfiPicker23

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine4:
          CFI Block cfiCond24 Using cfiCommon0
          CFI Function calcCRC
          CFI Conditional ??CrossCallReturnLabel_5
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI CFA_XSP16 add(XSP16, 533)
          CFI Block cfiCond25 Using cfiCommon0
          CFI (cfiCond25) Function recalcCRC
          CFI (cfiCond25) Conditional ??CrossCallReturnLabel_6
          CFI (cfiCond25) R6 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI (cfiCond25) VB load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI (cfiCond25) V0 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI (cfiCond25) V1 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI (cfiCond25) V2 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI (cfiCond25) V3 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI (cfiCond25) V4 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI (cfiCond25) V5 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI (cfiCond25) V6 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI (cfiCond25) V7 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI (cfiCond25) V8 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI (cfiCond25) V9 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI (cfiCond25) V10 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI (cfiCond25) V11 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI (cfiCond25) V12 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI (cfiCond25) V13 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI (cfiCond25) R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI (cfiCond25) ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI (cfiCond25) ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI (cfiCond25) DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI (cfiCond25) DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI (cfiCond25) CFA_XSP16 add(XSP16, 277)
          CFI Block cfiPicker26 Using cfiCommon1
          CFI (cfiPicker26) NoFunction
          CFI (cfiPicker26) Picker
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,DPL
        ADD     A,?V12
        MOV     DPL,A
        MOV     A,DPH
        ADDC    A,?V13
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        RET
          CFI EndBlock cfiCond24
          CFI EndBlock cfiCond25
          CFI EndBlock cfiPicker26
//  458 
//  459 
//  460 /**************************************************************************************************
//  461  * @fn          runPoly
//  462  *
//  463  * @brief       Run the CRC16 Polynomial calculation over the byte parameter.
//  464  *
//  465  * input parameters
//  466  *
//  467  * @param       crc - Running CRC calculated so far.
//  468  * @param       val - Value on which to run the CRC16.
//  469  *
//  470  * output parameters
//  471  *
//  472  * None.
//  473  *
//  474  * @return      crc - Updated for the run.
//  475  **************************************************************************************************
//  476  */

        RSEG NEAR_CODE:CODE:NOROOT(0)
//  477 static uint16 runPoly(uint16 crc, uint8 val)
runPoly:
          CFI Block cfiBlock27 Using cfiCommon0
          CFI Function runPoly
        CODE
//  478 {
        REQUIRE ?V0
        REQUIRE ?V1
        PUSH    ?V0
          CFI V0 Frame(CFA_SP, 3)
          CFI CFA_SP SP+-3
        PUSH    ?V1
          CFI V1 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        ; Saved register size: 2
        ; Auto size: 0
//  479   const uint16 poly = 0x1021;
//  480   uint8 cnt;
//  481 
//  482   for (cnt = 0; cnt < 8; cnt++, val <<= 1)
        MOV     R4,#0x8
//  483   {
//  484     uint8 msb = (crc & 0x8000) ? 1 : 0;
??runPoly_0:
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     A,#0xf
        MOV     R0,#?V0
        LCALL   ?US_SHR
        MOV     A,?V0
        MOV     R0,A
//  485 
//  486     crc <<= 1;
        MOV     A,R2
        ADD     A,0xE0 /* A   */
        MOV     R2,A
        MOV     A,R3
        RLC     A
        MOV     R3,A
//  487     if (val & 0x80)  crc |= 0x0001;
        MOV     A,R1
        MOV     C,0xE0 /* A   */.7
        JNC     ??runPoly_1
        MOV     A,#0x1
        ORL     A,R2
        MOV     R2,A
//  488     if (msb)         crc ^= poly;
??runPoly_1:
        MOV     A,R0
        MOV     C,0xE0 /* A   */.0
        JNC     ??runPoly_2
        MOV     A,#0x21
        XRL     A,R2
        MOV     R2,A
        MOV     A,#0x10
        XRL     A,R3
        MOV     R3,A
//  489   }
??runPoly_2:
        MOV     A,R1
        CLR     C
        RLC     A
        MOV     R1,A
        DEC     R4
        MOV     A,R4
        JNZ     ??runPoly_0
//  490 
//  491   return crc;
        POP     ?V1
          CFI V1 SameValue
          CFI CFA_SP SP+-3
        POP     ?V0
          CFI V0 SameValue
          CFI CFA_SP SP+-2
        RET
//  492 }
          CFI EndBlock cfiBlock27

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
__Constant_ffffe000:
        DS 4
        REQUIRE `?<Initializer for __Constant_ffffe000>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for __Constant_ffffe000>`:
        DATA32
        DD 4294959104

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
__Constant_90:
        DS 4
        REQUIRE `?<Initializer for __Constant_90>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for __Constant_90>`:
        DATA32
        DD 144

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
__Constant_200:
        DS 4
        REQUIRE `?<Initializer for __Constant_200>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for __Constant_200>`:
        DATA32
        DD 512

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
__Constant_3c800:
        DS 4
        REQUIRE `?<Initializer for __Constant_3c800>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for __Constant_3c800>`:
        DATA32
        DD 247808

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
__Constant_100:
        DS 4
        REQUIRE `?<Initializer for __Constant_100>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for __Constant_100>`:
        DATA32
        DD 256

        END
//  493 
//  494 /**************************************************************************************************
//  495 */
// 
// 1 515 bytes in segment NEAR_CODE
//    20 bytes in segment XDATA_I
//    20 bytes in segment XDATA_ID
//   134 bytes in segment XDATA_Z
// 
// 1 515 bytes of CODE  memory (+ 20 bytes shared)
//   134 bytes of XDATA memory (+ 20 bytes shared)
//
//Errors: none
//Warnings: none
