###############################################################################
#
# IAR C/C++ Compiler V9.30.1.3056 for 8051                21/Apr/2017  17:48:44
# Copyright 2004-2015 IAR Systems AB.
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Components\mt\MT_AF.c
#    Command line       =  
#        -f "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wRouter.cfg"
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
#        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
#        -DRTR_NWK) -f "C:\Texas Instruments\Z-Stack Mesh
#        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
#        1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x04000000 -DZDAPP_CONFIG_PAN_ID=0x0085
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=5
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07,
#        0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C,
#        0x0D}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
#        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
#        -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100
#        -DREJOIN_POLL_RATE=440) -DCHANNEL_CNT=0x01 "C:\Texas
#        Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Components\mt\MT_AF.c" -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D
#        MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -D xNV_RESTORE -D NV_INIT -D
#        OPEN_FCS -D PANID_INCREASE -lC "C:\Texas Instruments\Z-Stack Mesh
#        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
#        1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\RouterEB\List" -lA
#        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\RouterEB\List"
#        --diag_suppress Pe001,Pa010 -o "C:\Texas Instruments\Z-Stack Mesh
#        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
#        1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\RouterEB\Obj" -e
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa --debug
#        --core=plain --dptr=16,1 --data_model=large --code_model=banked
#        --calling_convention=xdata_reentrant --place_constants=data_rom
#        --nr_virtual_regs 16 -I "C:\Texas Instruments\Z-Stack Mesh
#        1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh
#        1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\" -I "C:\Texas
#        Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\Source\" -I
#        "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\Application\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\ZMain\TI2530DB\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\hal\include\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\include\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\mt\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\osal\include\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\services\saddr\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\services\sdata\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\af\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sec\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\sys\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\zmac\"
#        -I "C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack
#        Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
#        -On --require_prototypes
#    List file          =  
#        C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\RouterEB\List\MT_AF.lst
#    Object file        =  
#        C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh
#        1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh
#        1.0.0\Projects\zstack\Samples\GenericApp\CC2530DB\RouterEB\Obj\MT_AF.r51
#
###############################################################################

C:\Texas Instruments\Z-Stack Mesh 1.0.0_chaokw_20160317\Z-Stack Mesh 1.0.0_chaokw_20160316\Z-Stack Mesh 1.0.0_LCDOK\Z-Stack Mesh 1.0.0\Components\mt\MT_AF.c
      1          /**************************************************************************************************
      2            Filename:       MT_AF.c
      3            Revised:        $Date: 2014-08-21 13:23:51 -0700 (Thu, 21 Aug 2014) $
      4            Revision:       $Revision: 39843 $
      5          
      6          
      7            Description:    MonitorTest functions for the AF layer.
      8          
      9          
     10            Copyright 2007-2014 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          
     40          **************************************************************************************************/
     41          
     42          /* ------------------------------------------------------------------------------------------------
     43           *                                          Includes
     44           * ------------------------------------------------------------------------------------------------
     45           */
     46          #include "ZComDef.h"
     47          #include "OSAL.h"
     48          #include "MT.h"
     49          #include "MT_AF.h"
     50          #include "MT_ZDO.h"
     51          #include "nwk.h"
     52          #include "OnBoard.h"
     53          #include "MT_UART.h"
     54          
     55          #if defined INTER_PAN
     56          #include "stub_aps.h"
     57          #endif
     58          
     59          #if defined ( MT_GP_FUNC )
     60          #include "MT_GP.h"
     61          #endif
     62          
     63          /* ------------------------------------------------------------------------------------------------
     64           *                                          Constants
     65           * ------------------------------------------------------------------------------------------------
     66           */
     67          
     68          #if !defined MT_AF_EXEC_CNT
     69          #define MT_AF_EXEC_CNT  15
     70          #endif
     71          
     72          #if !defined MT_AF_EXEC_DLY
     73          #define MT_AF_EXEC_DLY  1000
     74          #endif
     75          
     76          /* ------------------------------------------------------------------------------------------------
     77           *                                           Typedefs
     78           * ------------------------------------------------------------------------------------------------
     79           */
     80          
     81          typedef struct
     82          {
     83            uint8 *data;
     84            afAddrType_t dstAddr;
     85            endPointDesc_t *epDesc;
     86            uint16 cId;
     87            uint16 dataLen;
     88            uint8 transId;
     89            uint8 txOpts;
     90            uint8 radius;
     91            uint8 tick;
     92          } mtAfDataReq_t;
     93          
     94          typedef struct _mtAfInMsgList_t
     95          {
     96            struct _mtAfInMsgList_t *next;
     97            uint8 *data;
     98            uint32 timestamp;         // Receipt timestamp from MAC.
     99            uint8 tick;
    100          } mtAfInMsgList_t;
    101          
    102          /* ------------------------------------------------------------------------------------------------
    103           *                                        Local Variables
    104           * ------------------------------------------------------------------------------------------------
    105           */
    106          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    107          mtAfInMsgList_t *pMtAfInMsgList = NULL;
   \                     pMtAfInMsgList:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    108          mtAfDataReq_t *pMtAfDataReq = NULL;
   \                     pMtAfDataReq:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    109          
    110          /* ------------------------------------------------------------------------------------------------
    111           *                                        Global Variables
    112           * ------------------------------------------------------------------------------------------------
    113           */
    114          
    115          #if defined ( MT_AF_CB_FUNC )
    116          uint16 _afCallbackSub;
    117          #endif
    118          
    119          /* ------------------------------------------------------------------------------------------------
    120           *                                        Local Functions
    121           * ------------------------------------------------------------------------------------------------
    122           */
    123          
    124          void MT_AfRegister(uint8 *pBuf);
    125          void MT_AfDelete(uint8 *pBuf);
    126          void MT_AfDataRequest(uint8 *pBuf);
    127          
    128          #if defined ( ZIGBEE_SOURCE_ROUTING )
    129          void MT_AfDataRequestSrcRtg(uint8 *pBuf);
    130          #endif
    131          
    132          #if defined INTER_PAN
    133          static void MT_AfInterPanCtl(uint8 *pBuf);
    134          #endif
    135          
    136          static void MT_AfDataRetrieve(uint8 *pBuf);
    137          static void MT_AfDataStore(uint8 *pBuf);
    138          static void MT_AfAPSF_ConfigSet(uint8 *pBuf);
    139          static void MT_AfAPSF_ConfigGet(uint8 *pBuf);
    140          
    141          
    142          /**************************************************************************************************
    143           * @fn          MT_AfExec
    144           *
    145           * @brief       This function is invoked by an MT timer event.
    146           *
    147           * input parameters
    148           *
    149           * None.
    150           *
    151           * output parameters
    152           *
    153           * None.
    154           *
    155           * @return      None.
    156           **************************************************************************************************
    157           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    158          void MT_AfExec(void)
   \                     MT_AfExec:
    159          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    160            mtAfInMsgList_t *pPrev, *pItem = pMtAfInMsgList;
   \   000005   90....       MOV     DPTR,#pMtAfInMsgList
   \   000008   E0           MOVX    A,@DPTR
   \   000009   FE           MOV     R6,A
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   FF           MOV     R7,A
    161          
    162            while (pItem != NULL)
   \                     ??MT_AfExec_0:
   \   00000D   EE           MOV     A,R6
   \   00000E   4F           ORL     A,R7
   \   00000F   7003         JNZ     $+5
   \   000011   02....       LJMP    ??MT_AfExec_1 & 0xFFFF
    163            {
    164              if (--(pItem->tick) == 0)
   \   000014   8E82         MOV     DPL,R6
   \   000016   8F83         MOV     DPH,R7
   \   000018   A3           INC     DPTR
   \   000019   A3           INC     DPTR
   \   00001A   A3           INC     DPTR
   \   00001B   A3           INC     DPTR
   \   00001C   A3           INC     DPTR
   \   00001D   A3           INC     DPTR
   \   00001E   A3           INC     DPTR
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   24FF         ADD     A,#-0x1
   \   000023   F0           MOVX    @DPTR,A
   \   000024   8E82         MOV     DPL,R6
   \   000026   8F83         MOV     DPH,R7
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   7063         JNZ     ??MT_AfExec_2
    165              {
    166                if (pMtAfInMsgList == pItem)
   \   000033   90....       MOV     DPTR,#pMtAfInMsgList
   \   000036   E0           MOVX    A,@DPTR
   \   000037   F8           MOV     R0,A
   \   000038   A3           INC     DPTR
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   F9           MOV     R1,A
   \   00003B   EE           MOV     A,R6
   \   00003C   68           XRL     A,R0
   \   00003D   7002         JNZ     ??MT_AfExec_3
   \   00003F   EF           MOV     A,R7
   \   000040   69           XRL     A,R1
   \                     ??MT_AfExec_3:
   \   000041   7026         JNZ     ??MT_AfExec_4
    167                {
    168                  pMtAfInMsgList = pItem->next;
   \   000043   8E82         MOV     DPL,R6
   \   000045   8F83         MOV     DPH,R7
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F8           MOV     R0,A
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F9           MOV     R1,A
   \   00004C   90....       MOV     DPTR,#pMtAfInMsgList
   \   00004F   E8           MOV     A,R0
   \   000050   F0           MOVX    @DPTR,A
   \   000051   A3           INC     DPTR
   \   000052   E9           MOV     A,R1
   \   000053   F0           MOVX    @DPTR,A
    169                  (void)osal_mem_free(pItem);
   \   000054                ; Setup parameters for call to function osal_mem_free
   \   000054   EE           MOV     A,R6
   \   000055   FA           MOV     R2,A
   \   000056   EF           MOV     A,R7
   \   000057   FB           MOV     R3,A
   \   000058   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    170                  pItem = pMtAfInMsgList;
   \   00005B   90....       MOV     DPTR,#pMtAfInMsgList
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   F8           MOV     R0,A
   \   000060   A3           INC     DPTR
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F9           MOV     R1,A
   \   000063   E8           MOV     A,R0
   \   000064   FE           MOV     R6,A
   \   000065   E9           MOV     A,R1
   \   000066   FF           MOV     R7,A
   \   000067   80A4         SJMP    ??MT_AfExec_0
    171                }
    172                else
    173                {
    174                  pPrev->next = pItem->next;
   \                     ??MT_AfExec_4:
   \   000069   8E82         MOV     DPL,R6
   \   00006B   8F83         MOV     DPH,R7
   \   00006D   E0           MOVX    A,@DPTR
   \   00006E   F8           MOV     R0,A
   \   00006F   A3           INC     DPTR
   \   000070   E0           MOVX    A,@DPTR
   \   000071   F9           MOV     R1,A
   \   000072   85..82       MOV     DPL,?V0
   \   000075   85..83       MOV     DPH,?V1
   \   000078   E8           MOV     A,R0
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   A3           INC     DPTR
   \   00007B   E9           MOV     A,R1
   \   00007C   F0           MOVX    @DPTR,A
    175                  (void)osal_mem_free(pItem);
   \   00007D                ; Setup parameters for call to function osal_mem_free
   \   00007D   EE           MOV     A,R6
   \   00007E   FA           MOV     R2,A
   \   00007F   EF           MOV     A,R7
   \   000080   FB           MOV     R3,A
   \   000081   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    176                  pItem = pPrev->next;
   \   000084   85..82       MOV     DPL,?V0
   \   000087   85..83       MOV     DPH,?V1
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   F8           MOV     R0,A
   \   00008C   A3           INC     DPTR
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   F9           MOV     R1,A
   \   00008F   E8           MOV     A,R0
   \   000090   FE           MOV     R6,A
   \   000091   E9           MOV     A,R1
   \   000092   FF           MOV     R7,A
   \   000093   02....       LJMP    ??MT_AfExec_0 & 0xFFFF
    177                }
    178              }
    179              else
    180              {
    181                pPrev = pItem;
   \                     ??MT_AfExec_2:
   \   000096   8E..         MOV     ?V0,R6
   \   000098   8F..         MOV     ?V1,R7
    182                pItem = pItem->next;
   \   00009A   8E82         MOV     DPL,R6
   \   00009C   8F83         MOV     DPH,R7
   \   00009E   E0           MOVX    A,@DPTR
   \   00009F   FE           MOV     R6,A
   \   0000A0   A3           INC     DPTR
   \   0000A1   E0           MOVX    A,@DPTR
   \   0000A2   FF           MOV     R7,A
   \   0000A3   02....       LJMP    ??MT_AfExec_0 & 0xFFFF
    183              }
    184            }
    185          
    186            if (pMtAfDataReq != NULL)
   \                     ??MT_AfExec_1:
   \   0000A6   90....       MOV     DPTR,#pMtAfDataReq
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   F8           MOV     R0,A
   \   0000AB   A3           INC     DPTR
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   F9           MOV     R1,A
   \   0000AE   E8           MOV     A,R0
   \   0000AF   49           ORL     A,R1
   \   0000B0   603E         JZ      ??MT_AfExec_5
    187            {
    188              if (--(pMtAfDataReq->tick) == 0)
   \   0000B2   90....       MOV     DPTR,#pMtAfDataReq
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   F8           MOV     R0,A
   \   0000B7   A3           INC     DPTR
   \   0000B8   E0           MOVX    A,@DPTR
   \   0000B9   C8           XCH     A,R0
   \   0000BA   2417         ADD     A,#0x17
   \   0000BC   F582         MOV     DPL,A
   \   0000BE   C8           XCH     A,R0
   \   0000BF   3400         ADDC    A,#0x0
   \   0000C1   F583         MOV     DPH,A
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   24FF         ADD     A,#-0x1
   \   0000C6   F0           MOVX    @DPTR,A
   \   0000C7   90....       MOV     DPTR,#pMtAfDataReq
   \   0000CA   E0           MOVX    A,@DPTR
   \   0000CB   F8           MOV     R0,A
   \   0000CC   A3           INC     DPTR
   \   0000CD   E0           MOVX    A,@DPTR
   \   0000CE   C8           XCH     A,R0
   \   0000CF   2417         ADD     A,#0x17
   \   0000D1   F582         MOV     DPL,A
   \   0000D3   C8           XCH     A,R0
   \   0000D4   3400         ADDC    A,#0x0
   \   0000D6   F583         MOV     DPH,A
   \   0000D8   E0           MOVX    A,@DPTR
   \   0000D9   7015         JNZ     ??MT_AfExec_5
    189              {
    190                (void)osal_mem_free(pMtAfDataReq);
   \   0000DB                ; Setup parameters for call to function osal_mem_free
   \   0000DB   90....       MOV     DPTR,#pMtAfDataReq
   \   0000DE   E0           MOVX    A,@DPTR
   \   0000DF   FA           MOV     R2,A
   \   0000E0   A3           INC     DPTR
   \   0000E1   E0           MOVX    A,@DPTR
   \   0000E2   FB           MOV     R3,A
   \   0000E3   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    191                pMtAfDataReq = NULL;
   \   0000E6   90....       MOV     DPTR,#pMtAfDataReq
   \   0000E9   7400         MOV     A,#0x0
   \   0000EB   F0           MOVX    @DPTR,A
   \   0000EC   A3           INC     DPTR
   \   0000ED   7400         MOV     A,#0x0
   \   0000EF   F0           MOVX    @DPTR,A
    192              }
    193            }
    194          
    195            if ((pMtAfInMsgList != NULL) || (pMtAfDataReq != NULL))
   \                     ??MT_AfExec_5:
   \   0000F0   90....       MOV     DPTR,#pMtAfInMsgList
   \   0000F3   E0           MOVX    A,@DPTR
   \   0000F4   F8           MOV     R0,A
   \   0000F5   A3           INC     DPTR
   \   0000F6   E0           MOVX    A,@DPTR
   \   0000F7   F9           MOV     R1,A
   \   0000F8   E8           MOV     A,R0
   \   0000F9   49           ORL     A,R1
   \   0000FA   700C         JNZ     ??MT_AfExec_6
   \   0000FC   90....       MOV     DPTR,#pMtAfDataReq
   \   0000FF   E0           MOVX    A,@DPTR
   \   000100   F8           MOV     R0,A
   \   000101   A3           INC     DPTR
   \   000102   E0           MOVX    A,@DPTR
   \   000103   F9           MOV     R1,A
   \   000104   E8           MOV     A,R0
   \   000105   49           ORL     A,R1
   \   000106   6027         JZ      ??MT_AfExec_7
    196            {
    197              if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \                     ??MT_AfExec_6:
   \   000108                ; Setup parameters for call to function osal_start_timerEx
   \   000108   90....       MOV     DPTR,#__Constant_3e8
   \   00010B   12....       LCALL   ?PUSH_XSTACK8_X_FOUR
   \   00010E   7A08         MOV     R2,#0x8
   \   000110   7B00         MOV     R3,#0x0
   \   000112   90....       MOV     DPTR,#MT_TaskID
   \   000115   E0           MOVX    A,@DPTR
   \   000116   F9           MOV     R1,A
   \   000117   12....       LCALL   `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00011A   7404         MOV     A,#0x4
   \   00011C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00011F   E9           MOV     A,R1
   \   000120   600D         JZ      ??MT_AfExec_7
    198              {
    199                osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   000122                ; Setup parameters for call to function osal_set_event
   \   000122   7A08         MOV     R2,#0x8
   \   000124   7B00         MOV     R3,#0x0
   \   000126   90....       MOV     DPTR,#MT_TaskID
   \   000129   E0           MOVX    A,@DPTR
   \   00012A   F9           MOV     R1,A
   \   00012B   12....       LCALL   `??osal_set_event::?relay`; Banked call to: osal_set_event
   \   00012E   E9           MOV     A,R1
    200              }
    201            }
    202          }
   \                     ??MT_AfExec_7:
   \   00012F   7F02         MOV     R7,#0x2
   \   000131   02....       LJMP    ?BANKED_LEAVE_XDATA
    203          
    204          /***************************************************************************************************
    205           * @fn      MT_AfCommandProcessing
    206           *
    207           * @brief   Process all the AF commands that are issued by test tool
    208           *
    209           * @param   pBuf - pointer to the received buffer
    210           *
    211           * @return  status
    212           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    213          uint8 MT_AfCommandProcessing(uint8 *pBuf)
   \                     MT_AfCommandProcessing:
    214          {
   \   000000                REQUIRE ?V0
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    215            uint8 status = MT_RPC_SUCCESS;
   \   000009   75..00       MOV     ?V0,#0x0
    216          
    217            switch (pBuf[MT_RPC_POS_CMD1])
   \   00000C   8E82         MOV     DPL,R6
   \   00000E   8F83         MOV     DPH,R7
   \   000010   A3           INC     DPTR
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \   000013   601B         JZ      ??MT_AfCommandProcessing_0
   \   000015   14           DEC     A
   \   000016   602A         JZ      ??MT_AfCommandProcessing_1
   \   000018   14           DEC     A
   \   000019   6027         JZ      ??MT_AfCommandProcessing_1
   \   00001B   14           DEC     A
   \   00001C   602D         JZ      ??MT_AfCommandProcessing_2
   \   00001E   14           DEC     A
   \   00001F   6018         JZ      ??MT_AfCommandProcessing_3
   \   000021   24F3         ADD     A,#-0xd
   \   000023   6038         JZ      ??MT_AfCommandProcessing_4
   \   000025   14           DEC     A
   \   000026   602C         JZ      ??MT_AfCommandProcessing_5
   \   000028   14           DEC     A
   \   000029   603B         JZ      ??MT_AfCommandProcessing_6
   \   00002B   14           DEC     A
   \   00002C   6041         JZ      ??MT_AfCommandProcessing_7
   \   00002E   8048         SJMP    ??MT_AfCommandProcessing_8
    218            {
    219              case MT_AF_REGISTER:
    220                MT_AfRegister(pBuf);
   \                     ??MT_AfCommandProcessing_0:
   \   000030                ; Setup parameters for call to function MT_AfRegister
   \   000030   EE           MOV     A,R6
   \   000031   FA           MOV     R2,A
   \   000032   EF           MOV     A,R7
   \   000033   FB           MOV     R3,A
   \   000034   12....       LCALL   `??MT_AfRegister::?relay`; Banked call to: MT_AfRegister
    221                break;
   \   000037   8042         SJMP    ??MT_AfCommandProcessing_9
    222          
    223              case MT_AF_DELETE:
    224                MT_AfDelete( pBuf );
   \                     ??MT_AfCommandProcessing_3:
   \   000039                ; Setup parameters for call to function MT_AfDelete
   \   000039   EE           MOV     A,R6
   \   00003A   FA           MOV     R2,A
   \   00003B   EF           MOV     A,R7
   \   00003C   FB           MOV     R3,A
   \   00003D   12....       LCALL   `??MT_AfDelete::?relay`; Banked call to: MT_AfDelete
    225                break;
   \   000040   8039         SJMP    ??MT_AfCommandProcessing_9
    226          
    227              case MT_AF_DATA_REQUEST:
    228              case MT_AF_DATA_REQUEST_EXT:
    229                MT_AfDataRequest(pBuf);
   \                     ??MT_AfCommandProcessing_1:
   \   000042                ; Setup parameters for call to function MT_AfDataRequest
   \   000042   EE           MOV     A,R6
   \   000043   FA           MOV     R2,A
   \   000044   EF           MOV     A,R7
   \   000045   FB           MOV     R3,A
   \   000046   12....       LCALL   `??MT_AfDataRequest::?relay`; Banked call to: MT_AfDataRequest
    230                break;
   \   000049   8030         SJMP    ??MT_AfCommandProcessing_9
    231          
    232          #if defined ( ZIGBEE_SOURCE_ROUTING )
    233              case MT_AF_DATA_REQUEST_SRCRTG:
    234                MT_AfDataRequestSrcRtg(pBuf);
   \                     ??MT_AfCommandProcessing_2:
   \   00004B                ; Setup parameters for call to function MT_AfDataRequestSrcRtg
   \   00004B   EE           MOV     A,R6
   \   00004C   FA           MOV     R2,A
   \   00004D   EF           MOV     A,R7
   \   00004E   FB           MOV     R3,A
   \   00004F   12....       LCALL   `??MT_AfDataRequestSrcRtg::?relay`; Banked call to: MT_AfDataRequestSrcRtg
    235                break;
   \   000052   8027         SJMP    ??MT_AfCommandProcessing_9
    236          #endif
    237          
    238          #if defined INTER_PAN
    239              case MT_AF_INTER_PAN_CTL:
    240                MT_AfInterPanCtl(pBuf);
    241                break;
    242          #endif
    243          
    244              case MT_AF_DATA_RETRIEVE:
    245                MT_AfDataRetrieve(pBuf);
   \                     ??MT_AfCommandProcessing_5:
   \   000054                ; Setup parameters for call to function MT_AfDataRetrieve
   \   000054   EE           MOV     A,R6
   \   000055   FA           MOV     R2,A
   \   000056   EF           MOV     A,R7
   \   000057   FB           MOV     R3,A
   \   000058   12....       LCALL   `??MT_AfDataRetrieve::?relay`; Banked call to: MT_AfDataRetrieve
    246                break;
   \   00005B   801E         SJMP    ??MT_AfCommandProcessing_9
    247          
    248              case MT_AF_DATA_STORE:
    249                MT_AfDataStore(pBuf);
   \                     ??MT_AfCommandProcessing_4:
   \   00005D                ; Setup parameters for call to function MT_AfDataStore
   \   00005D   EE           MOV     A,R6
   \   00005E   FA           MOV     R2,A
   \   00005F   EF           MOV     A,R7
   \   000060   FB           MOV     R3,A
   \   000061   12....       LCALL   `??MT_AfDataStore::?relay`; Banked call to: MT_AfDataStore
    250                break;
   \   000064   8015         SJMP    ??MT_AfCommandProcessing_9
    251          
    252              case MT_AF_APSF_CONFIG_SET:
    253                MT_AfAPSF_ConfigSet(pBuf);
   \                     ??MT_AfCommandProcessing_6:
   \   000066                ; Setup parameters for call to function MT_AfAPSF_ConfigSet
   \   000066   EE           MOV     A,R6
   \   000067   FA           MOV     R2,A
   \   000068   EF           MOV     A,R7
   \   000069   FB           MOV     R3,A
   \   00006A   12....       LCALL   `??MT_AfAPSF_ConfigSet::?relay`; Banked call to: MT_AfAPSF_ConfigSet
    254                break;
   \   00006D   800C         SJMP    ??MT_AfCommandProcessing_9
    255          
    256              case MT_AF_APSF_CONFIG_GET:
    257                MT_AfAPSF_ConfigGet(pBuf);
   \                     ??MT_AfCommandProcessing_7:
   \   00006F                ; Setup parameters for call to function MT_AfAPSF_ConfigGet
   \   00006F   EE           MOV     A,R6
   \   000070   FA           MOV     R2,A
   \   000071   EF           MOV     A,R7
   \   000072   FB           MOV     R3,A
   \   000073   12....       LCALL   `??MT_AfAPSF_ConfigGet::?relay`; Banked call to: MT_AfAPSF_ConfigGet
    258                break;
   \   000076   8003         SJMP    ??MT_AfCommandProcessing_9
    259          
    260              default:
    261                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_AfCommandProcessing_8:
   \   000078   75..02       MOV     ?V0,#0x2
    262                break;
    263            }
    264          
    265            return status;
   \                     ??MT_AfCommandProcessing_9:
   \   00007B   A9..         MOV     R1,?V0
   \   00007D   7F01         MOV     R7,#0x1
   \   00007F   02....       LJMP    ?BANKED_LEAVE_XDATA
    266          }
    267          
    268          /***************************************************************************************************
    269           * @fn      MT_AfRegister
    270           *
    271           * @brief   Process AF Register command
    272           *
    273           * @param   pBuf - pointer to the received buffer
    274           *
    275           * @return  none
    276           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    277          void MT_AfRegister(uint8 *pBuf)
   \                     MT_AfRegister:
    278          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0,R2
   \   00000C   8B..         MOV     ?V1,R3
    279            uint8 cmdId;
    280            uint8 retValue = ZMemError;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7410         MOV     A,#0x10
   \   000016   F0           MOVX    @DPTR,A
    281            endPointDesc_t *epDesc;
    282          
    283            /* parse header */
    284            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000017   85..82       MOV     DPL,?V0
   \   00001A   85..83       MOV     DPH,?V1
   \   00001D   A3           INC     DPTR
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V2,A
    285            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000022   E5..         MOV     A,?V0
   \   000024   2403         ADD     A,#0x3
   \   000026   F5..         MOV     ?V0,A
   \   000028   5002         JNC     ??MT_AfRegister_0
   \   00002A   05..         INC     ?V1
    286          
    287            epDesc = (endPointDesc_t *)osal_mem_alloc(sizeof(endPointDesc_t));
   \                     ??MT_AfRegister_0:
   \   00002C                ; Setup parameters for call to function osal_mem_alloc
   \   00002C   7A06         MOV     R2,#0x6
   \   00002E   7B00         MOV     R3,#0x0
   \   000030   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   000033   8A..         MOV     ?V4,R2
   \   000035   8B..         MOV     ?V5,R3
   \   000037   AE..         MOV     R6,?V4
   \   000039   AF..         MOV     R7,?V5
    288            if ( epDesc )
   \   00003B   EE           MOV     A,R6
   \   00003C   4F           ORL     A,R7
   \   00003D   604F         JZ      ??MT_AfRegister_1
    289            {
    290              epDesc->task_id = &MT_TaskID;
   \   00003F   8E82         MOV     DPL,R6
   \   000041   8F83         MOV     DPH,R7
   \   000043   A3           INC     DPTR
   \   000044   74..         MOV     A,#MT_TaskID & 0xff
   \   000046   F0           MOVX    @DPTR,A
   \   000047   A3           INC     DPTR
   \   000048   74..         MOV     A,#(MT_TaskID >> 8) & 0xff
   \   00004A   F0           MOVX    @DPTR,A
    291              retValue = MT_BuildEndpointDesc( pBuf, epDesc );
   \   00004B                ; Setup parameters for call to function MT_BuildEndpointDesc
   \   00004B   EE           MOV     A,R6
   \   00004C   FC           MOV     R4,A
   \   00004D   EF           MOV     A,R7
   \   00004E   FD           MOV     R5,A
   \   00004F   AA..         MOV     R2,?V0
   \   000051   AB..         MOV     R3,?V1
   \   000053   12....       LCALL   `??MT_BuildEndpointDesc::?relay`; Banked call to: MT_BuildEndpointDesc
   \   000056   E9           MOV     A,R1
   \   000057   C0E0         PUSH    A
   \   000059   85..82       MOV     DPL,?XSP + 0
   \   00005C   85..83       MOV     DPH,?XSP + 1
   \   00005F   D0E0         POP     A
   \   000061   F0           MOVX    @DPTR,A
    292              if ( retValue == ZSuccess )
   \   000062   85..82       MOV     DPL,?XSP + 0
   \   000065   85..83       MOV     DPH,?XSP + 1
   \   000068   E0           MOVX    A,@DPTR
   \   000069   7013         JNZ     ??MT_AfRegister_2
    293              {
    294                retValue = afRegister( epDesc );
   \   00006B                ; Setup parameters for call to function afRegister
   \   00006B   EE           MOV     A,R6
   \   00006C   FA           MOV     R2,A
   \   00006D   EF           MOV     A,R7
   \   00006E   FB           MOV     R3,A
   \   00006F   12....       LCALL   `??afRegister::?relay`; Banked call to: afRegister
   \   000072   E9           MOV     A,R1
   \   000073   C0E0         PUSH    A
   \   000075   85..82       MOV     DPL,?XSP + 0
   \   000078   85..83       MOV     DPH,?XSP + 1
   \   00007B   D0E0         POP     A
   \   00007D   F0           MOVX    @DPTR,A
    295              }
    296          
    297              if ( retValue != ZSuccess )
   \                     ??MT_AfRegister_2:
   \   00007E   85..82       MOV     DPL,?XSP + 0
   \   000081   85..83       MOV     DPH,?XSP + 1
   \   000084   E0           MOVX    A,@DPTR
   \   000085   6007         JZ      ??MT_AfRegister_1
    298              {
    299                osal_mem_free( epDesc );
   \   000087                ; Setup parameters for call to function osal_mem_free
   \   000087   EE           MOV     A,R6
   \   000088   FA           MOV     R2,A
   \   000089   EF           MOV     A,R7
   \   00008A   FB           MOV     R3,A
   \   00008B   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    300              }
    301            }
    302          
    303            /* Build and send back the response */
    304            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmdId, 1, &retValue);
   \                     ??MT_AfRegister_1:
   \   00008E                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00008E   AC..         MOV     R4,?XSP + 0
   \   000090   AD..         MOV     R5,?XSP + 1
   \   000092   7B01         MOV     R3,#0x1
   \   000094   AA..         MOV     R2,?V2
   \   000096   7964         MOV     R1,#0x64
   \   000098   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    305          }
   \   00009B   7401         MOV     A,#0x1
   \   00009D   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A0   7F06         MOV     R7,#0x6
   \   0000A2   02....       LJMP    ?BANKED_LEAVE_XDATA
    306          
    307          /***************************************************************************************************
    308           * @fn      MT_AfDelete
    309           *
    310           * @brief   Process AF Delete Endpoint command
    311           *
    312           * @param   pBuf - pointer to the received buffer
    313           *
    314           * @return  none
    315           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    316          void MT_AfDelete(uint8 *pBuf)
   \                     MT_AfDelete:
    317          {
   \   000000                REQUIRE ?V0
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    318            uint8 cmdId;
    319            uint8 retValue = ZMemError;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7410         MOV     A,#0x10
   \   000016   F0           MOVX    @DPTR,A
    320          
    321            /* parse header */
    322            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000017   8E82         MOV     DPL,R6
   \   000019   8F83         MOV     DPH,R7
   \   00001B   A3           INC     DPTR
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0,A
    323            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000020   EE           MOV     A,R6
   \   000021   2403         ADD     A,#0x3
   \   000023   FE           MOV     R6,A
   \   000024   5001         JNC     ??MT_AfDelete_0
   \   000026   0F           INC     R7
    324          
    325            retValue = afDelete( *pBuf );
   \                     ??MT_AfDelete_0:
   \   000027                ; Setup parameters for call to function afDelete
   \   000027   8E82         MOV     DPL,R6
   \   000029   8F83         MOV     DPH,R7
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F9           MOV     R1,A
   \   00002D   12....       LCALL   `??afDelete::?relay` ; Banked call to: afDelete
   \   000030   E9           MOV     A,R1
   \   000031   C0E0         PUSH    A
   \   000033   85..82       MOV     DPL,?XSP + 0
   \   000036   85..83       MOV     DPH,?XSP + 1
   \   000039   D0E0         POP     A
   \   00003B   F0           MOVX    @DPTR,A
    326          
    327            /* Build and send back the response */
    328            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmdId, 1, &retValue);
   \   00003C                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00003C   AC..         MOV     R4,?XSP + 0
   \   00003E   AD..         MOV     R5,?XSP + 1
   \   000040   7B01         MOV     R3,#0x1
   \   000042   AA..         MOV     R2,?V0
   \   000044   7964         MOV     R1,#0x64
   \   000046   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    329          }
   \   000049   7401         MOV     A,#0x1
   \   00004B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004E   7F01         MOV     R7,#0x1
   \   000050   02....       LJMP    ?BANKED_LEAVE_XDATA
    330          
    331          /***************************************************************************************************
    332           * @fn      MT_AfDataRequest
    333           *
    334           * @brief   Process AF Register command
    335           *
    336           * @param   pBuf - pointer to the received buffer
    337           *
    338           * @return  none
    339           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    340          void MT_AfDataRequest(uint8 *pBuf)
   \                     MT_AfDataRequest:
    341          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000                REQUIRE ?V8
   \   000000                REQUIRE ?V9
   \   000000                REQUIRE ?V10
   \   000000                REQUIRE ?V11
   \   000000                REQUIRE ?V12
   \   000000                REQUIRE ?V13
   \   000000                REQUIRE ?V14
   \   000000   74E9         MOV     A,#-0x17
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 23
   \   000005                ; Auto size: 16
   \   000005   74F0         MOV     A,#-0x10
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    342            #define MT_AF_REQ_MSG_LEN  10
    343            #define MT_AF_REQ_MSG_EXT  10
    344          
    345            endPointDesc_t *epDesc;
    346            afAddrType_t dstAddr;
    347            cId_t cId;
    348            uint8 transId, txOpts, radius;
    349            uint8 cmd0, cmd1;
    350            uint8 retValue = ZFailure;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
    351            uint16 dataLen, tempLen;
    352          
    353            /* Parse header */
    354            cmd0 = pBuf[MT_RPC_POS_CMD0];
   \   000017   8E82         MOV     DPL,R6
   \   000019   8F83         MOV     DPH,R7
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V14,A
    355            cmd1 = pBuf[MT_RPC_POS_CMD1];
   \   00001F   8E82         MOV     DPL,R6
   \   000021   8F83         MOV     DPH,R7
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F5..         MOV     ?V7,A
    356            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000028   EE           MOV     A,R6
   \   000029   2403         ADD     A,#0x3
   \   00002B   FE           MOV     R6,A
   \   00002C   5001         JNC     ??MT_AfDataRequest_0
   \   00002E   0F           INC     R7
    357          
    358            if (cmd1 == MT_AF_DATA_REQUEST_EXT)
   \                     ??MT_AfDataRequest_0:
   \   00002F   7402         MOV     A,#0x2
   \   000031   65..         XRL     A,?V7
   \   000033   6003         JZ      $+5
   \   000035   02....       LJMP    ??MT_AfDataRequest_1 & 0xFFFF
    359            {
    360              dstAddr.addrMode = (afAddrMode_t)*pBuf++;
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   C0E0         PUSH    A
   \   00003F   740A         MOV     A,#0xa
   \   000041   12....       LCALL   ?XSTACK_DISP0_8
   \   000044   D0E0         POP     A
   \   000046   F0           MOVX    @DPTR,A
   \   000047   8E82         MOV     DPL,R6
   \   000049   8F83         MOV     DPH,R7
   \   00004B   A3           INC     DPTR
   \   00004C   AE82         MOV     R6,DPL
   \   00004E   AF83         MOV     R7,DPH
    361          
    362              if (dstAddr.addrMode == afAddr64Bit)
   \   000050   740A         MOV     A,#0xa
   \   000052   12....       LCALL   ?XSTACK_DISP0_8
   \   000055   E0           MOVX    A,@DPTR
   \   000056   6403         XRL     A,#0x3
   \   000058   7029         JNZ     ??MT_AfDataRequest_2
    363              {
    364                (void)osal_memcpy(dstAddr.addr.extAddr, pBuf, Z_EXTADDR_LEN);
   \   00005A                ; Setup parameters for call to function osal_memcpy
   \   00005A   8E..         MOV     ?V4,R6
   \   00005C   8F..         MOV     ?V5,R7
   \   00005E   75..00       MOV     ?V6,#0x0
   \   000061   78..         MOV     R0,#?V4
   \   000063   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000066   7C08         MOV     R4,#0x8
   \   000068   7D00         MOV     R5,#0x0
   \   00006A   7405         MOV     A,#0x5
   \   00006C   12....       LCALL   ?XSTACK_DISP101_8
   \   00006F   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000072   7403         MOV     A,#0x3
   \   000074   12....       LCALL   ?DEALLOC_XSTACK8
   \   000077   8A..         MOV     ?V4,R2
   \   000079   8B..         MOV     ?V5,R3
   \   00007B   85..82       MOV     DPL,?V4
   \   00007E   85..83       MOV     DPH,?V5
   \   000081   8024         SJMP    ??MT_AfDataRequest_3
    365              }
    366              else
    367              {
    368                dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??MT_AfDataRequest_2:
   \   000083   8E82         MOV     DPL,R6
   \   000085   8F83         MOV     DPH,R7
   \   000087   E0           MOVX    A,@DPTR
   \   000088   FA           MOV     R2,A
   \   000089   7B00         MOV     R3,#0x0
   \   00008B   8E82         MOV     DPL,R6
   \   00008D   8F83         MOV     DPH,R7
   \   00008F   A3           INC     DPTR
   \   000090   E0           MOVX    A,@DPTR
   \   000091   F8           MOV     R0,A
   \   000092   7900         MOV     R1,#0x0
   \   000094   E4           CLR     A
   \   000095   C8           XCH     A,R0
   \   000096   F9           MOV     R1,A
   \   000097   EA           MOV     A,R2
   \   000098   28           ADD     A,R0
   \   000099   F8           MOV     R0,A
   \   00009A   EB           MOV     A,R3
   \   00009B   39           ADDC    A,R1
   \   00009C   F9           MOV     R1,A
   \   00009D   7402         MOV     A,#0x2
   \   00009F   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A2   E8           MOV     A,R0
   \   0000A3   F0           MOVX    @DPTR,A
   \   0000A4   A3           INC     DPTR
   \   0000A5   E9           MOV     A,R1
   \   0000A6   F0           MOVX    @DPTR,A
    369              }
    370              pBuf += Z_EXTADDR_LEN;
   \                     ??MT_AfDataRequest_3:
   \   0000A7   EE           MOV     A,R6
   \   0000A8   2408         ADD     A,#0x8
   \   0000AA   FE           MOV     R6,A
   \   0000AB   5001         JNC     ??MT_AfDataRequest_4
   \   0000AD   0F           INC     R7
    371          
    372              dstAddr.endPoint = *pBuf++;
   \                     ??MT_AfDataRequest_4:
   \   0000AE   8E82         MOV     DPL,R6
   \   0000B0   8F83         MOV     DPH,R7
   \   0000B2   E0           MOVX    A,@DPTR
   \   0000B3   C0E0         PUSH    A
   \   0000B5   740B         MOV     A,#0xb
   \   0000B7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BA   D0E0         POP     A
   \   0000BC   F0           MOVX    @DPTR,A
   \   0000BD   8E82         MOV     DPL,R6
   \   0000BF   8F83         MOV     DPH,R7
   \   0000C1   A3           INC     DPTR
   \   0000C2   AE82         MOV     R6,DPL
   \   0000C4   AF83         MOV     R7,DPH
    373              dstAddr.panId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   0000C6   8E82         MOV     DPL,R6
   \   0000C8   8F83         MOV     DPH,R7
   \   0000CA   E0           MOVX    A,@DPTR
   \   0000CB   FA           MOV     R2,A
   \   0000CC   7B00         MOV     R3,#0x0
   \   0000CE   8E82         MOV     DPL,R6
   \   0000D0   8F83         MOV     DPH,R7
   \   0000D2   A3           INC     DPTR
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   F8           MOV     R0,A
   \   0000D5   7900         MOV     R1,#0x0
   \   0000D7   E4           CLR     A
   \   0000D8   C8           XCH     A,R0
   \   0000D9   F9           MOV     R1,A
   \   0000DA   EA           MOV     A,R2
   \   0000DB   28           ADD     A,R0
   \   0000DC   F8           MOV     R0,A
   \   0000DD   EB           MOV     A,R3
   \   0000DE   39           ADDC    A,R1
   \   0000DF   F9           MOV     R1,A
   \   0000E0   740C         MOV     A,#0xc
   \   0000E2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E5   E8           MOV     A,R0
   \   0000E6   F0           MOVX    @DPTR,A
   \   0000E7   A3           INC     DPTR
   \   0000E8   E9           MOV     A,R1
   \   0000E9   F0           MOVX    @DPTR,A
    374              pBuf += 2;
   \   0000EA   EE           MOV     A,R6
   \   0000EB   2402         ADD     A,#0x2
   \   0000ED   FE           MOV     R6,A
   \   0000EE   505A         JNC     ??MT_AfDataRequest_5
   \   0000F0   0F           INC     R7
   \   0000F1   8057         SJMP    ??MT_AfDataRequest_5
    375            }
    376            else
    377            {
    378              /* Destination address */
    379              dstAddr.addrMode = afAddr16Bit;
   \                     ??MT_AfDataRequest_1:
   \   0000F3   740A         MOV     A,#0xa
   \   0000F5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F8   7402         MOV     A,#0x2
   \   0000FA   F0           MOVX    @DPTR,A
    380              dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   0000FB   8E82         MOV     DPL,R6
   \   0000FD   8F83         MOV     DPH,R7
   \   0000FF   E0           MOVX    A,@DPTR
   \   000100   FA           MOV     R2,A
   \   000101   7B00         MOV     R3,#0x0
   \   000103   8E82         MOV     DPL,R6
   \   000105   8F83         MOV     DPH,R7
   \   000107   A3           INC     DPTR
   \   000108   E0           MOVX    A,@DPTR
   \   000109   F8           MOV     R0,A
   \   00010A   7900         MOV     R1,#0x0
   \   00010C   E4           CLR     A
   \   00010D   C8           XCH     A,R0
   \   00010E   F9           MOV     R1,A
   \   00010F   EA           MOV     A,R2
   \   000110   28           ADD     A,R0
   \   000111   F8           MOV     R0,A
   \   000112   EB           MOV     A,R3
   \   000113   39           ADDC    A,R1
   \   000114   F9           MOV     R1,A
   \   000115   7402         MOV     A,#0x2
   \   000117   12....       LCALL   ?XSTACK_DISP0_8
   \   00011A   E8           MOV     A,R0
   \   00011B   F0           MOVX    @DPTR,A
   \   00011C   A3           INC     DPTR
   \   00011D   E9           MOV     A,R1
   \   00011E   F0           MOVX    @DPTR,A
    381              pBuf += 2;
   \   00011F   EE           MOV     A,R6
   \   000120   2402         ADD     A,#0x2
   \   000122   FE           MOV     R6,A
   \   000123   5001         JNC     ??MT_AfDataRequest_6
   \   000125   0F           INC     R7
    382          
    383              /* Destination endpoint */
    384              dstAddr.endPoint = *pBuf++;
   \                     ??MT_AfDataRequest_6:
   \   000126   8E82         MOV     DPL,R6
   \   000128   8F83         MOV     DPH,R7
   \   00012A   E0           MOVX    A,@DPTR
   \   00012B   C0E0         PUSH    A
   \   00012D   740B         MOV     A,#0xb
   \   00012F   12....       LCALL   ?XSTACK_DISP0_8
   \   000132   D0E0         POP     A
   \   000134   F0           MOVX    @DPTR,A
   \   000135   8E82         MOV     DPL,R6
   \   000137   8F83         MOV     DPH,R7
   \   000139   A3           INC     DPTR
   \   00013A   AE82         MOV     R6,DPL
   \   00013C   AF83         MOV     R7,DPH
    385              dstAddr.panId = 0;
   \   00013E   740C         MOV     A,#0xc
   \   000140   12....       LCALL   ?XSTACK_DISP0_8
   \   000143   7400         MOV     A,#0x0
   \   000145   F0           MOVX    @DPTR,A
   \   000146   A3           INC     DPTR
   \   000147   7400         MOV     A,#0x0
   \   000149   F0           MOVX    @DPTR,A
    386            }
    387          
    388            /* Source endpoint */
    389            epDesc = afFindEndPointDesc(*pBuf++);
   \                     ??MT_AfDataRequest_5:
   \   00014A                ; Setup parameters for call to function afFindEndPointDesc
   \   00014A   8E82         MOV     DPL,R6
   \   00014C   8F83         MOV     DPH,R7
   \   00014E   E0           MOVX    A,@DPTR
   \   00014F   F9           MOV     R1,A
   \   000150   12....       LCALL   `??afFindEndPointDesc::?relay`; Banked call to: afFindEndPointDesc
   \   000153   8A..         MOV     ?V4,R2
   \   000155   8B..         MOV     ?V5,R3
   \   000157   85....       MOV     ?V12,?V4
   \   00015A   85....       MOV     ?V13,?V5
   \   00015D   8E82         MOV     DPL,R6
   \   00015F   8F83         MOV     DPH,R7
   \   000161   A3           INC     DPTR
   \   000162   AE82         MOV     R6,DPL
   \   000164   AF83         MOV     R7,DPH
    390          
    391            /* ClusterId */
    392            cId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000166   8E82         MOV     DPL,R6
   \   000168   8F83         MOV     DPH,R7
   \   00016A   E0           MOVX    A,@DPTR
   \   00016B   FA           MOV     R2,A
   \   00016C   7B00         MOV     R3,#0x0
   \   00016E   8E82         MOV     DPL,R6
   \   000170   8F83         MOV     DPH,R7
   \   000172   A3           INC     DPTR
   \   000173   E0           MOVX    A,@DPTR
   \   000174   F8           MOV     R0,A
   \   000175   7900         MOV     R1,#0x0
   \   000177   E4           CLR     A
   \   000178   C8           XCH     A,R0
   \   000179   F9           MOV     R1,A
   \   00017A   EA           MOV     A,R2
   \   00017B   28           ADD     A,R0
   \   00017C   F8           MOV     R0,A
   \   00017D   EB           MOV     A,R3
   \   00017E   39           ADDC    A,R1
   \   00017F   F9           MOV     R1,A
   \   000180   88..         MOV     ?V2,R0
   \   000182   89..         MOV     ?V3,R1
    393            pBuf +=2;
   \   000184   EE           MOV     A,R6
   \   000185   2402         ADD     A,#0x2
   \   000187   FE           MOV     R6,A
   \   000188   5001         JNC     ??MT_AfDataRequest_7
   \   00018A   0F           INC     R7
    394          
    395            /* TransId */
    396            transId = *pBuf++;
   \                     ??MT_AfDataRequest_7:
   \   00018B   8E82         MOV     DPL,R6
   \   00018D   8F83         MOV     DPH,R7
   \   00018F   E0           MOVX    A,@DPTR
   \   000190   C0E0         PUSH    A
   \   000192   7401         MOV     A,#0x1
   \   000194   12....       LCALL   ?XSTACK_DISP0_8
   \   000197   D0E0         POP     A
   \   000199   F0           MOVX    @DPTR,A
   \   00019A   8E82         MOV     DPL,R6
   \   00019C   8F83         MOV     DPH,R7
   \   00019E   A3           INC     DPTR
   \   00019F   AE82         MOV     R6,DPL
   \   0001A1   AF83         MOV     R7,DPH
    397          
    398            /* TxOption */
    399            txOpts = *pBuf++;
   \   0001A3   8E82         MOV     DPL,R6
   \   0001A5   8F83         MOV     DPH,R7
   \   0001A7   E0           MOVX    A,@DPTR
   \   0001A8   F5..         MOV     ?V9,A
   \   0001AA   8E82         MOV     DPL,R6
   \   0001AC   8F83         MOV     DPH,R7
   \   0001AE   A3           INC     DPTR
   \   0001AF   AE82         MOV     R6,DPL
   \   0001B1   AF83         MOV     R7,DPH
    400          
    401            /* Radius */
    402            radius = *pBuf++;
   \   0001B3   8E82         MOV     DPL,R6
   \   0001B5   8F83         MOV     DPH,R7
   \   0001B7   E0           MOVX    A,@DPTR
   \   0001B8   F5..         MOV     ?V8,A
   \   0001BA   8E82         MOV     DPL,R6
   \   0001BC   8F83         MOV     DPH,R7
   \   0001BE   A3           INC     DPTR
   \   0001BF   AE82         MOV     R6,DPL
   \   0001C1   AF83         MOV     R7,DPH
    403          
    404            /* Length */
    405            if (cmd1 == MT_AF_DATA_REQUEST_EXT)
   \   0001C3   7402         MOV     A,#0x2
   \   0001C5   65..         XRL     A,?V7
   \   0001C7   7034         JNZ     ??MT_AfDataRequest_8
    406            {
    407              dataLen = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   0001C9   8E82         MOV     DPL,R6
   \   0001CB   8F83         MOV     DPH,R7
   \   0001CD   E0           MOVX    A,@DPTR
   \   0001CE   FA           MOV     R2,A
   \   0001CF   7B00         MOV     R3,#0x0
   \   0001D1   8E82         MOV     DPL,R6
   \   0001D3   8F83         MOV     DPH,R7
   \   0001D5   A3           INC     DPTR
   \   0001D6   E0           MOVX    A,@DPTR
   \   0001D7   F8           MOV     R0,A
   \   0001D8   7900         MOV     R1,#0x0
   \   0001DA   E4           CLR     A
   \   0001DB   C8           XCH     A,R0
   \   0001DC   F9           MOV     R1,A
   \   0001DD   EA           MOV     A,R2
   \   0001DE   28           ADD     A,R0
   \   0001DF   F8           MOV     R0,A
   \   0001E0   EB           MOV     A,R3
   \   0001E1   39           ADDC    A,R1
   \   0001E2   F9           MOV     R1,A
   \   0001E3   88..         MOV     ?V0,R0
   \   0001E5   89..         MOV     ?V1,R1
    408              tempLen = dataLen + MT_AF_REQ_MSG_LEN + MT_AF_REQ_MSG_EXT;
   \   0001E7   E5..         MOV     A,?V0
   \   0001E9   2414         ADD     A,#0x14
   \   0001EB   F8           MOV     R0,A
   \   0001EC   E4           CLR     A
   \   0001ED   35..         ADDC    A,?V1
   \   0001EF   F9           MOV     R1,A
   \   0001F0   88..         MOV     ?V10,R0
   \   0001F2   89..         MOV     ?V11,R1
    409              pBuf += 2;
   \   0001F4   EE           MOV     A,R6
   \   0001F5   2402         ADD     A,#0x2
   \   0001F7   FE           MOV     R6,A
   \   0001F8   5025         JNC     ??MT_AfDataRequest_9
   \   0001FA   0F           INC     R7
   \   0001FB   8022         SJMP    ??MT_AfDataRequest_9
    410            }
    411            else
    412            {
    413              dataLen = *pBuf++;
   \                     ??MT_AfDataRequest_8:
   \   0001FD   8E82         MOV     DPL,R6
   \   0001FF   8F83         MOV     DPH,R7
   \   000201   E0           MOVX    A,@DPTR
   \   000202   F8           MOV     R0,A
   \   000203   7900         MOV     R1,#0x0
   \   000205   88..         MOV     ?V0,R0
   \   000207   89..         MOV     ?V1,R1
   \   000209   8E82         MOV     DPL,R6
   \   00020B   8F83         MOV     DPH,R7
   \   00020D   A3           INC     DPTR
   \   00020E   AE82         MOV     R6,DPL
   \   000210   AF83         MOV     R7,DPH
    414              tempLen = dataLen + MT_AF_REQ_MSG_LEN;
   \   000212   E5..         MOV     A,?V0
   \   000214   240A         ADD     A,#0xa
   \   000216   F8           MOV     R0,A
   \   000217   E4           CLR     A
   \   000218   35..         ADDC    A,?V1
   \   00021A   F9           MOV     R1,A
   \   00021B   88..         MOV     ?V10,R0
   \   00021D   89..         MOV     ?V11,R1
    415            }
    416          
    417            if ( epDesc == NULL )
   \                     ??MT_AfDataRequest_9:
   \   00021F   E5..         MOV     A,?V12
   \   000221   45..         ORL     A,?V13
   \   000223   700C         JNZ     ??MT_AfDataRequest_10
    418            {
    419              retValue = afStatus_INVALID_PARAMETER;
   \   000225   85..82       MOV     DPL,?XSP + 0
   \   000228   85..83       MOV     DPH,?XSP + 1
   \   00022B   7402         MOV     A,#0x2
   \   00022D   F0           MOVX    @DPTR,A
   \   00022E   02....       LJMP    ??MT_AfDataRequest_11 & 0xFFFF
    420            }
    421            else if (tempLen > (uint16)MT_RPC_DATA_MAX)
   \                     ??MT_AfDataRequest_10:
   \   000231   C3           CLR     C
   \   000232   E5..         MOV     A,?V10
   \   000234   94FB         SUBB    A,#-0x5
   \   000236   E5..         MOV     A,?V11
   \   000238   9400         SUBB    A,#0x0
   \   00023A   5003         JNC     $+5
   \   00023C   02....       LJMP    ??MT_AfDataRequest_12 & 0xFFFF
    422            {
    423              if (pMtAfDataReq != NULL)
   \   00023F   90....       MOV     DPTR,#pMtAfDataReq
   \   000242   E0           MOVX    A,@DPTR
   \   000243   F8           MOV     R0,A
   \   000244   A3           INC     DPTR
   \   000245   E0           MOVX    A,@DPTR
   \   000246   F9           MOV     R1,A
   \   000247   E8           MOV     A,R0
   \   000248   49           ORL     A,R1
   \   000249   600C         JZ      ??MT_AfDataRequest_13
    424              {
    425                retValue = afStatus_INVALID_PARAMETER;
   \   00024B   85..82       MOV     DPL,?XSP + 0
   \   00024E   85..83       MOV     DPH,?XSP + 1
   \   000251   7402         MOV     A,#0x2
   \   000253   F0           MOVX    @DPTR,A
   \   000254   02....       LJMP    ??MT_AfDataRequest_11 & 0xFFFF
    426              }
    427              else if ((pMtAfDataReq = osal_mem_alloc(sizeof(mtAfDataReq_t) + dataLen)) == NULL)
   \                     ??MT_AfDataRequest_13:
   \   000257                ; Setup parameters for call to function osal_mem_alloc
   \   000257   E5..         MOV     A,?V0
   \   000259   2418         ADD     A,#0x18
   \   00025B   FA           MOV     R2,A
   \   00025C   E4           CLR     A
   \   00025D   35..         ADDC    A,?V1
   \   00025F   FB           MOV     R3,A
   \   000260   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   000263   90....       MOV     DPTR,#pMtAfDataReq
   \   000266   EA           MOV     A,R2
   \   000267   F0           MOVX    @DPTR,A
   \   000268   A3           INC     DPTR
   \   000269   EB           MOV     A,R3
   \   00026A   F0           MOVX    @DPTR,A
   \   00026B   90....       MOV     DPTR,#pMtAfDataReq
   \   00026E   E0           MOVX    A,@DPTR
   \   00026F   F8           MOV     R0,A
   \   000270   A3           INC     DPTR
   \   000271   E0           MOVX    A,@DPTR
   \   000272   F9           MOV     R1,A
   \   000273   E8           MOV     A,R0
   \   000274   49           ORL     A,R1
   \   000275   700C         JNZ     ??MT_AfDataRequest_14
    428              {
    429                retValue = afStatus_MEM_FAIL;
   \   000277   85..82       MOV     DPL,?XSP + 0
   \   00027A   85..83       MOV     DPH,?XSP + 1
   \   00027D   7410         MOV     A,#0x10
   \   00027F   F0           MOVX    @DPTR,A
   \   000280   02....       LJMP    ??MT_AfDataRequest_11 & 0xFFFF
    430              }
    431              else
    432              {
    433                retValue = afStatus_SUCCESS;
   \                     ??MT_AfDataRequest_14:
   \   000283   85..82       MOV     DPL,?XSP + 0
   \   000286   85..83       MOV     DPH,?XSP + 1
   \   000289   7400         MOV     A,#0x0
   \   00028B   F0           MOVX    @DPTR,A
    434          
    435                pMtAfDataReq->data = (uint8 *)(pMtAfDataReq+1);
   \   00028C   90....       MOV     DPTR,#pMtAfDataReq
   \   00028F   E0           MOVX    A,@DPTR
   \   000290   2418         ADD     A,#0x18
   \   000292   FA           MOV     R2,A
   \   000293   A3           INC     DPTR
   \   000294   E0           MOVX    A,@DPTR
   \   000295   3400         ADDC    A,#0x0
   \   000297   FB           MOV     R3,A
   \   000298   90....       MOV     DPTR,#pMtAfDataReq
   \   00029B   E0           MOVX    A,@DPTR
   \   00029C   F8           MOV     R0,A
   \   00029D   A3           INC     DPTR
   \   00029E   E0           MOVX    A,@DPTR
   \   00029F   F583         MOV     DPH,A
   \   0002A1   8882         MOV     DPL,R0
   \   0002A3   EA           MOV     A,R2
   \   0002A4   F0           MOVX    @DPTR,A
   \   0002A5   A3           INC     DPTR
   \   0002A6   EB           MOV     A,R3
   \   0002A7   F0           MOVX    @DPTR,A
    436                (void)osal_memcpy(&(pMtAfDataReq->dstAddr), &dstAddr, sizeof(afAddrType_t));
   \   0002A8                ; Setup parameters for call to function osal_memcpy
   \   0002A8   7402         MOV     A,#0x2
   \   0002AA   12....       LCALL   ?XSTACK_DISP100_8
   \   0002AD   88..         MOV     ?V4,R0
   \   0002AF   89..         MOV     ?V5,R1
   \   0002B1   75..00       MOV     ?V6,#0x0
   \   0002B4   78..         MOV     R0,#?V4
   \   0002B6   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0002B9   7C0C         MOV     R4,#0xc
   \   0002BB   7D00         MOV     R5,#0x0
   \   0002BD   90....       MOV     DPTR,#pMtAfDataReq
   \   0002C0   E0           MOVX    A,@DPTR
   \   0002C1   2402         ADD     A,#0x2
   \   0002C3   FA           MOV     R2,A
   \   0002C4   A3           INC     DPTR
   \   0002C5   E0           MOVX    A,@DPTR
   \   0002C6   3400         ADDC    A,#0x0
   \   0002C8   FB           MOV     R3,A
   \   0002C9   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0002CC   7403         MOV     A,#0x3
   \   0002CE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0002D1   740E         MOV     A,#0xe
   \   0002D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0002D6   EA           MOV     A,R2
   \   0002D7   F0           MOVX    @DPTR,A
   \   0002D8   A3           INC     DPTR
   \   0002D9   EB           MOV     A,R3
   \   0002DA   F0           MOVX    @DPTR,A
    437                pMtAfDataReq->epDesc = epDesc;
   \   0002DB   90....       MOV     DPTR,#pMtAfDataReq
   \   0002DE   E0           MOVX    A,@DPTR
   \   0002DF   F8           MOV     R0,A
   \   0002E0   A3           INC     DPTR
   \   0002E1   E0           MOVX    A,@DPTR
   \   0002E2   C8           XCH     A,R0
   \   0002E3   240E         ADD     A,#0xe
   \   0002E5   F582         MOV     DPL,A
   \   0002E7   C8           XCH     A,R0
   \   0002E8   3400         ADDC    A,#0x0
   \   0002EA   F583         MOV     DPH,A
   \   0002EC   E5..         MOV     A,?V12
   \   0002EE   F0           MOVX    @DPTR,A
   \   0002EF   A3           INC     DPTR
   \   0002F0   E5..         MOV     A,?V13
   \   0002F2   F0           MOVX    @DPTR,A
    438                pMtAfDataReq->cId = cId;
   \   0002F3   90....       MOV     DPTR,#pMtAfDataReq
   \   0002F6   E0           MOVX    A,@DPTR
   \   0002F7   F8           MOV     R0,A
   \   0002F8   A3           INC     DPTR
   \   0002F9   E0           MOVX    A,@DPTR
   \   0002FA   C8           XCH     A,R0
   \   0002FB   2410         ADD     A,#0x10
   \   0002FD   F582         MOV     DPL,A
   \   0002FF   C8           XCH     A,R0
   \   000300   3400         ADDC    A,#0x0
   \   000302   F583         MOV     DPH,A
   \   000304   E5..         MOV     A,?V2
   \   000306   F0           MOVX    @DPTR,A
   \   000307   A3           INC     DPTR
   \   000308   E5..         MOV     A,?V3
   \   00030A   F0           MOVX    @DPTR,A
    439                pMtAfDataReq->dataLen = dataLen;
   \   00030B   90....       MOV     DPTR,#pMtAfDataReq
   \   00030E   E0           MOVX    A,@DPTR
   \   00030F   F8           MOV     R0,A
   \   000310   A3           INC     DPTR
   \   000311   E0           MOVX    A,@DPTR
   \   000312   C8           XCH     A,R0
   \   000313   2412         ADD     A,#0x12
   \   000315   F582         MOV     DPL,A
   \   000317   C8           XCH     A,R0
   \   000318   3400         ADDC    A,#0x0
   \   00031A   F583         MOV     DPH,A
   \   00031C   E5..         MOV     A,?V0
   \   00031E   F0           MOVX    @DPTR,A
   \   00031F   A3           INC     DPTR
   \   000320   E5..         MOV     A,?V1
   \   000322   F0           MOVX    @DPTR,A
    440                pMtAfDataReq->transId = transId;
   \   000323   7401         MOV     A,#0x1
   \   000325   12....       LCALL   ?XSTACK_DISP0_8
   \   000328   E0           MOVX    A,@DPTR
   \   000329   C0E0         PUSH    A
   \   00032B   90....       MOV     DPTR,#pMtAfDataReq
   \   00032E   E0           MOVX    A,@DPTR
   \   00032F   F8           MOV     R0,A
   \   000330   A3           INC     DPTR
   \   000331   E0           MOVX    A,@DPTR
   \   000332   C8           XCH     A,R0
   \   000333   2414         ADD     A,#0x14
   \   000335   F582         MOV     DPL,A
   \   000337   C8           XCH     A,R0
   \   000338   3400         ADDC    A,#0x0
   \   00033A   F583         MOV     DPH,A
   \   00033C   D0E0         POP     A
   \   00033E   F0           MOVX    @DPTR,A
    441                pMtAfDataReq->txOpts = txOpts;
   \   00033F   E5..         MOV     A,?V9
   \   000341   C0E0         PUSH    A
   \   000343   90....       MOV     DPTR,#pMtAfDataReq
   \   000346   E0           MOVX    A,@DPTR
   \   000347   F8           MOV     R0,A
   \   000348   A3           INC     DPTR
   \   000349   E0           MOVX    A,@DPTR
   \   00034A   C8           XCH     A,R0
   \   00034B   2415         ADD     A,#0x15
   \   00034D   F582         MOV     DPL,A
   \   00034F   C8           XCH     A,R0
   \   000350   3400         ADDC    A,#0x0
   \   000352   F583         MOV     DPH,A
   \   000354   D0E0         POP     A
   \   000356   F0           MOVX    @DPTR,A
    442                pMtAfDataReq->radius = radius;
   \   000357   E5..         MOV     A,?V8
   \   000359   C0E0         PUSH    A
   \   00035B   90....       MOV     DPTR,#pMtAfDataReq
   \   00035E   E0           MOVX    A,@DPTR
   \   00035F   F8           MOV     R0,A
   \   000360   A3           INC     DPTR
   \   000361   E0           MOVX    A,@DPTR
   \   000362   C8           XCH     A,R0
   \   000363   2416         ADD     A,#0x16
   \   000365   F582         MOV     DPL,A
   \   000367   C8           XCH     A,R0
   \   000368   3400         ADDC    A,#0x0
   \   00036A   F583         MOV     DPH,A
   \   00036C   D0E0         POP     A
   \   00036E   F0           MOVX    @DPTR,A
    443          
    444                // Setup to time-out the huge outgoing item if host does not MT_AF_DATA_STORE it.
    445                pMtAfDataReq->tick = MT_AF_EXEC_CNT;
   \   00036F   90....       MOV     DPTR,#pMtAfDataReq
   \   000372   E0           MOVX    A,@DPTR
   \   000373   F8           MOV     R0,A
   \   000374   A3           INC     DPTR
   \   000375   E0           MOVX    A,@DPTR
   \   000376   C8           XCH     A,R0
   \   000377   2417         ADD     A,#0x17
   \   000379   F582         MOV     DPL,A
   \   00037B   C8           XCH     A,R0
   \   00037C   3400         ADDC    A,#0x0
   \   00037E   F583         MOV     DPH,A
   \   000380   740F         MOV     A,#0xf
   \   000382   F0           MOVX    @DPTR,A
    446                if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \   000383                ; Setup parameters for call to function osal_start_timerEx
   \   000383   90....       MOV     DPTR,#__Constant_3e8
   \   000386   12....       LCALL   ?PUSH_XSTACK8_X_FOUR
   \   000389   7A08         MOV     R2,#0x8
   \   00038B   7B00         MOV     R3,#0x0
   \   00038D   90....       MOV     DPTR,#MT_TaskID
   \   000390   E0           MOVX    A,@DPTR
   \   000391   F9           MOV     R1,A
   \   000392   12....       LCALL   `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   000395   7404         MOV     A,#0x4
   \   000397   12....       LCALL   ?DEALLOC_XSTACK8
   \   00039A   E9           MOV     A,R1
   \   00039B   6058         JZ      ??MT_AfDataRequest_11
    447                {
    448                  (void)osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   00039D                ; Setup parameters for call to function osal_set_event
   \   00039D   7A08         MOV     R2,#0x8
   \   00039F   7B00         MOV     R3,#0x0
   \   0003A1   90....       MOV     DPTR,#MT_TaskID
   \   0003A4   E0           MOVX    A,@DPTR
   \   0003A5   F9           MOV     R1,A
   \   0003A6   12....       LCALL   `??osal_set_event::?relay`; Banked call to: osal_set_event
   \   0003A9   E9           MOV     A,R1
   \   0003AA   8049         SJMP    ??MT_AfDataRequest_11
    449                }
    450              }
    451            }
    452          #if defined ( MT_GP_FUNC )
    453            else if ( ( cmd1 == MT_AF_DATA_REQUEST_EXT )
    454                     && ( dstAddr.endPoint == ZGP_ENDPOINT_ID )
    455                     && ( dstAddr.panId == 0 )
    456                     && ( dstAddr.addrMode == afAddr64Bit ) )// loopback support
    457            {
    458              retValue = MT_GpGenerateResponse( dstAddr.addr.extAddr, dataLen, pBuf );
    459            }
    460          #endif
    461            else
    462            {
    463              retValue = AF_DataRequest(&dstAddr, epDesc, cId, dataLen, pBuf, &transId, txOpts, radius);
   \                     ??MT_AfDataRequest_12:
   \   0003AC                ; Setup parameters for call to function AF_DataRequest
   \   0003AC   E5..         MOV     A,?V8
   \   0003AE   F5..         MOV     ?V4,A
   \   0003B0   78..         MOV     R0,#?V4
   \   0003B2   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0003B5   7402         MOV     A,#0x2
   \   0003B7   12....       LCALL   ?XSTACK_DISP100_8
   \   0003BA   88..         MOV     ?V4,R0
   \   0003BC   89..         MOV     ?V5,R1
   \   0003BE   78..         MOV     R0,#?V4
   \   0003C0   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0003C3   8E..         MOV     ?V4,R6
   \   0003C5   8F..         MOV     ?V5,R7
   \   0003C7   78..         MOV     R0,#?V4
   \   0003C9   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0003CC   78..         MOV     R0,#?V0
   \   0003CE   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0003D1   78..         MOV     R0,#?V2
   \   0003D3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0003D6   A9..         MOV     R1,?V9
   \   0003D8   AC..         MOV     R4,?V12
   \   0003DA   AD..         MOV     R5,?V13
   \   0003DC   740B         MOV     A,#0xb
   \   0003DE   12....       LCALL   ?XSTACK_DISP101_8
   \   0003E1   12....       LCALL   `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   0003E4   7409         MOV     A,#0x9
   \   0003E6   12....       LCALL   ?DEALLOC_XSTACK8
   \   0003E9   E9           MOV     A,R1
   \   0003EA   C0E0         PUSH    A
   \   0003EC   85..82       MOV     DPL,?XSP + 0
   \   0003EF   85..83       MOV     DPH,?XSP + 1
   \   0003F2   D0E0         POP     A
   \   0003F4   F0           MOVX    @DPTR,A
    464            }
    465          
    466            if (MT_RPC_CMD_SREQ == (cmd0 & MT_RPC_CMD_TYPE_MASK))
   \                     ??MT_AfDataRequest_11:
   \   0003F5   74E0         MOV     A,#-0x20
   \   0003F7   55..         ANL     A,?V14
   \   0003F9   6420         XRL     A,#0x20
   \   0003FB   700D         JNZ     ??MT_AfDataRequest_15
    467            {
    468              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP|(uint8)MT_RPC_SYS_AF), cmd1, 1, &retValue);
   \   0003FD                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0003FD   AC..         MOV     R4,?XSP + 0
   \   0003FF   AD..         MOV     R5,?XSP + 1
   \   000401   7B01         MOV     R3,#0x1
   \   000403   AA..         MOV     R2,?V7
   \   000405   7964         MOV     R1,#0x64
   \   000407   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    469            }
    470          }
   \                     ??MT_AfDataRequest_15:
   \   00040A   7410         MOV     A,#0x10
   \   00040C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00040F   7F0F         MOV     R7,#0xf
   \   000411   02....       LJMP    ?BANKED_LEAVE_XDATA
    471          
    472          #if defined ( ZIGBEE_SOURCE_ROUTING )
    473          
    474          /***************************************************************************************************
    475           * @fn      MT_AfDataRequestSrcRtg
    476           *
    477           * @brief   Process AF Register command
    478           *
    479           * @param   pBuf - pointer to the received buffer
    480           *
    481           * @return  none
    482           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    483          void MT_AfDataRequestSrcRtg(uint8 *pBuf)
   \                     MT_AfDataRequestSrcRtg:
    484          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000                REQUIRE ?V8
   \   000000                REQUIRE ?V9
   \   000000                REQUIRE ?V10
   \   000000                REQUIRE ?V11
   \   000000                REQUIRE ?V12
   \   000000                REQUIRE ?V14
   \   000000                REQUIRE ?V15
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 14
   \   000005   74F2         MOV     A,#-0xe
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    485            uint8 cmdId, dataLen = 0;
   \   00000E   75..00       MOV     ?V3,#0x0
    486            uint8 retValue = ZFailure;
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   7401         MOV     A,#0x1
   \   000019   F0           MOVX    @DPTR,A
    487            endPointDesc_t *epDesc;
    488            byte transId;
    489            afAddrType_t dstAddr;
    490            cId_t cId;
    491            byte txOpts, radius, srcEP, relayCnt;
    492            uint16 *pRelayList;
    493            uint8 i;
    494          
    495            /* parse header */
    496            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00001A   8E82         MOV     DPL,R6
   \   00001C   8F83         MOV     DPH,R7
   \   00001E   A3           INC     DPTR
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V5,A
    497            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000023   EE           MOV     A,R6
   \   000024   2403         ADD     A,#0x3
   \   000026   FE           MOV     R6,A
   \   000027   5001         JNC     ??MT_AfDataRequestSrcRtg_0
   \   000029   0F           INC     R7
    498          
    499            /* Destination address */
    500            /* Initialize the panID field to zero to avoid inter-pan */
    501            osal_memset( &dstAddr, 0, sizeof(afAddrType_t) );
   \                     ??MT_AfDataRequestSrcRtg_0:
   \   00002A                ; Setup parameters for call to function osal_memset
   \   00002A   7C0C         MOV     R4,#0xc
   \   00002C   7D00         MOV     R5,#0x0
   \   00002E   7900         MOV     R1,#0x0
   \   000030   7402         MOV     A,#0x2
   \   000032   12....       LCALL   ?XSTACK_DISP101_8
   \   000035   12....       LCALL   `??osal_memset::?relay`; Banked call to: osal_memset
    502            dstAddr.addrMode = afAddr16Bit;
   \   000038   740A         MOV     A,#0xa
   \   00003A   12....       LCALL   ?XSTACK_DISP0_8
   \   00003D   7402         MOV     A,#0x2
   \   00003F   F0           MOVX    @DPTR,A
    503            dstAddr.addr.shortAddr = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000040   8E82         MOV     DPL,R6
   \   000042   8F83         MOV     DPH,R7
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F8           MOV     R0,A
   \   000046   7900         MOV     R1,#0x0
   \   000048   8E82         MOV     DPL,R6
   \   00004A   8F83         MOV     DPH,R7
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   FA           MOV     R2,A
   \   00004F   7B00         MOV     R3,#0x0
   \   000051   E4           CLR     A
   \   000052   CA           XCH     A,R2
   \   000053   FB           MOV     R3,A
   \   000054   E8           MOV     A,R0
   \   000055   2A           ADD     A,R2
   \   000056   F8           MOV     R0,A
   \   000057   E9           MOV     A,R1
   \   000058   3B           ADDC    A,R3
   \   000059   F9           MOV     R1,A
   \   00005A   7402         MOV     A,#0x2
   \   00005C   12....       LCALL   ?XSTACK_DISP0_8
   \   00005F   E8           MOV     A,R0
   \   000060   F0           MOVX    @DPTR,A
   \   000061   A3           INC     DPTR
   \   000062   E9           MOV     A,R1
   \   000063   F0           MOVX    @DPTR,A
    504            pBuf += 2;
   \   000064   EE           MOV     A,R6
   \   000065   2402         ADD     A,#0x2
   \   000067   FE           MOV     R6,A
   \   000068   5001         JNC     ??MT_AfDataRequestSrcRtg_1
   \   00006A   0F           INC     R7
    505          
    506            /* Destination endpoint */
    507            dstAddr.endPoint = *pBuf++;
   \                     ??MT_AfDataRequestSrcRtg_1:
   \   00006B   8E82         MOV     DPL,R6
   \   00006D   8F83         MOV     DPH,R7
   \   00006F   E0           MOVX    A,@DPTR
   \   000070   C0E0         PUSH    A
   \   000072   740B         MOV     A,#0xb
   \   000074   12....       LCALL   ?XSTACK_DISP0_8
   \   000077   D0E0         POP     A
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   8E82         MOV     DPL,R6
   \   00007C   8F83         MOV     DPH,R7
   \   00007E   A3           INC     DPTR
   \   00007F   AE82         MOV     R6,DPL
   \   000081   AF83         MOV     R7,DPH
    508          
    509            /* Source endpoint */
    510            srcEP = *pBuf++;
   \   000083   8E82         MOV     DPL,R6
   \   000085   8F83         MOV     DPH,R7
   \   000087   E0           MOVX    A,@DPTR
   \   000088   F5..         MOV     ?V10,A
   \   00008A   8E82         MOV     DPL,R6
   \   00008C   8F83         MOV     DPH,R7
   \   00008E   A3           INC     DPTR
   \   00008F   AE82         MOV     R6,DPL
   \   000091   AF83         MOV     R7,DPH
    511            epDesc = afFindEndPointDesc( srcEP );
   \   000093                ; Setup parameters for call to function afFindEndPointDesc
   \   000093   A9..         MOV     R1,?V10
   \   000095   12....       LCALL   `??afFindEndPointDesc::?relay`; Banked call to: afFindEndPointDesc
   \   000098   8A..         MOV     ?V8,R2
   \   00009A   8B..         MOV     ?V9,R3
   \   00009C   85....       MOV     ?V14,?V8
   \   00009F   85....       MOV     ?V15,?V9
    512          
    513            /* ClusterId */
    514            cId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   0000A2   8E82         MOV     DPL,R6
   \   0000A4   8F83         MOV     DPH,R7
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   F8           MOV     R0,A
   \   0000A8   7900         MOV     R1,#0x0
   \   0000AA   8E82         MOV     DPL,R6
   \   0000AC   8F83         MOV     DPH,R7
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   FA           MOV     R2,A
   \   0000B1   7B00         MOV     R3,#0x0
   \   0000B3   E4           CLR     A
   \   0000B4   CA           XCH     A,R2
   \   0000B5   FB           MOV     R3,A
   \   0000B6   E8           MOV     A,R0
   \   0000B7   2A           ADD     A,R2
   \   0000B8   F8           MOV     R0,A
   \   0000B9   E9           MOV     A,R1
   \   0000BA   3B           ADDC    A,R3
   \   0000BB   F9           MOV     R1,A
   \   0000BC   88..         MOV     ?V0,R0
   \   0000BE   89..         MOV     ?V1,R1
    515            pBuf +=2;
   \   0000C0   EE           MOV     A,R6
   \   0000C1   2402         ADD     A,#0x2
   \   0000C3   FE           MOV     R6,A
   \   0000C4   5001         JNC     ??MT_AfDataRequestSrcRtg_2
   \   0000C6   0F           INC     R7
    516          
    517            /* TransId */
    518            transId = *pBuf++;
   \                     ??MT_AfDataRequestSrcRtg_2:
   \   0000C7   8E82         MOV     DPL,R6
   \   0000C9   8F83         MOV     DPH,R7
   \   0000CB   E0           MOVX    A,@DPTR
   \   0000CC   C0E0         PUSH    A
   \   0000CE   7401         MOV     A,#0x1
   \   0000D0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D3   D0E0         POP     A
   \   0000D5   F0           MOVX    @DPTR,A
   \   0000D6   8E82         MOV     DPL,R6
   \   0000D8   8F83         MOV     DPH,R7
   \   0000DA   A3           INC     DPTR
   \   0000DB   AE82         MOV     R6,DPL
   \   0000DD   AF83         MOV     R7,DPH
    519          
    520            /* TxOption */
    521            txOpts = *pBuf++;
   \   0000DF   8E82         MOV     DPL,R6
   \   0000E1   8F83         MOV     DPH,R7
   \   0000E3   E0           MOVX    A,@DPTR
   \   0000E4   F5..         MOV     ?V12,A
   \   0000E6   8E82         MOV     DPL,R6
   \   0000E8   8F83         MOV     DPH,R7
   \   0000EA   A3           INC     DPTR
   \   0000EB   AE82         MOV     R6,DPL
   \   0000ED   AF83         MOV     R7,DPH
    522          
    523            /* Radius */
    524            radius = *pBuf++;
   \   0000EF   8E82         MOV     DPL,R6
   \   0000F1   8F83         MOV     DPH,R7
   \   0000F3   E0           MOVX    A,@DPTR
   \   0000F4   F5..         MOV     ?V11,A
   \   0000F6   8E82         MOV     DPL,R6
   \   0000F8   8F83         MOV     DPH,R7
   \   0000FA   A3           INC     DPTR
   \   0000FB   AE82         MOV     R6,DPL
   \   0000FD   AF83         MOV     R7,DPH
    525          
    526            /* Source route relay count */
    527            relayCnt = *pBuf++;
   \   0000FF   8E82         MOV     DPL,R6
   \   000101   8F83         MOV     DPH,R7
   \   000103   E0           MOVX    A,@DPTR
   \   000104   F5..         MOV     ?V4,A
   \   000106   8E82         MOV     DPL,R6
   \   000108   8F83         MOV     DPH,R7
   \   00010A   A3           INC     DPTR
   \   00010B   AE82         MOV     R6,DPL
   \   00010D   AF83         MOV     R7,DPH
    528          
    529            /* Convert the source route relay list */
    530            if( (pRelayList = osal_mem_alloc( relayCnt * sizeof( uint16 ))) != NULL )
   \   00010F                ; Setup parameters for call to function osal_mem_alloc
   \   00010F   AA..         MOV     R2,?V4
   \   000111   7B00         MOV     R3,#0x0
   \   000113   EA           MOV     A,R2
   \   000114   75F002       MOV     B,#0x2
   \   000117   A4           MUL     AB
   \   000118   CA           XCH     A,R2
   \   000119   A8F0         MOV     R0,B
   \   00011B   75F000       MOV     B,#0x0
   \   00011E   A4           MUL     AB
   \   00011F   28           ADD     A,R0
   \   000120   F8           MOV     R0,A
   \   000121   75F002       MOV     B,#0x2
   \   000124   EB           MOV     A,R3
   \   000125   A4           MUL     AB
   \   000126   28           ADD     A,R0
   \   000127   FB           MOV     R3,A
   \   000128   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   00012B   8A..         MOV     ?V8,R2
   \   00012D   8B..         MOV     ?V9,R3
   \   00012F   85....       MOV     ?V6,?V8
   \   000132   85....       MOV     ?V7,?V9
   \   000135   E5..         MOV     A,?V6
   \   000137   45..         ORL     A,?V7
   \   000139   7003         JNZ     $+5
   \   00013B   02....       LJMP    ??MT_AfDataRequestSrcRtg_3 & 0xFFFF
    531            {
    532              for( i = 0; i < relayCnt; i++ )
   \   00013E   75..00       MOV     ?V2,#0x0
   \                     ??MT_AfDataRequestSrcRtg_4:
   \   000141   E5..         MOV     A,?V2
   \   000143   C3           CLR     C
   \   000144   95..         SUBB    A,?V4
   \   000146   504D         JNC     ??MT_AfDataRequestSrcRtg_5
    533              {
    534                pRelayList[i]  = BUILD_UINT16( pBuf[0], pBuf[1] );
   \   000148   8E82         MOV     DPL,R6
   \   00014A   8F83         MOV     DPH,R7
   \   00014C   E0           MOVX    A,@DPTR
   \   00014D   F8           MOV     R0,A
   \   00014E   7900         MOV     R1,#0x0
   \   000150   8E82         MOV     DPL,R6
   \   000152   8F83         MOV     DPH,R7
   \   000154   A3           INC     DPTR
   \   000155   E0           MOVX    A,@DPTR
   \   000156   FA           MOV     R2,A
   \   000157   7B00         MOV     R3,#0x0
   \   000159   E4           CLR     A
   \   00015A   CA           XCH     A,R2
   \   00015B   FB           MOV     R3,A
   \   00015C   E8           MOV     A,R0
   \   00015D   2A           ADD     A,R2
   \   00015E   F8           MOV     R0,A
   \   00015F   E9           MOV     A,R1
   \   000160   3B           ADDC    A,R3
   \   000161   F9           MOV     R1,A
   \   000162   AA..         MOV     R2,?V2
   \   000164   7B00         MOV     R3,#0x0
   \   000166   EA           MOV     A,R2
   \   000167   75F002       MOV     B,#0x2
   \   00016A   A4           MUL     AB
   \   00016B   CA           XCH     A,R2
   \   00016C   ACF0         MOV     R4,B
   \   00016E   75F000       MOV     B,#0x0
   \   000171   A4           MUL     AB
   \   000172   2C           ADD     A,R4
   \   000173   FC           MOV     R4,A
   \   000174   75F002       MOV     B,#0x2
   \   000177   EB           MOV     A,R3
   \   000178   A4           MUL     AB
   \   000179   2C           ADD     A,R4
   \   00017A   FB           MOV     R3,A
   \   00017B   E5..         MOV     A,?V6
   \   00017D   2A           ADD     A,R2
   \   00017E   F582         MOV     DPL,A
   \   000180   E5..         MOV     A,?V7
   \   000182   3B           ADDC    A,R3
   \   000183   F583         MOV     DPH,A
   \   000185   E8           MOV     A,R0
   \   000186   F0           MOVX    @DPTR,A
   \   000187   A3           INC     DPTR
   \   000188   E9           MOV     A,R1
   \   000189   F0           MOVX    @DPTR,A
    535                pBuf += 2;
   \   00018A   EE           MOV     A,R6
   \   00018B   2402         ADD     A,#0x2
   \   00018D   FE           MOV     R6,A
   \   00018E   5001         JNC     ??MT_AfDataRequestSrcRtg_6
   \   000190   0F           INC     R7
    536              }
   \                     ??MT_AfDataRequestSrcRtg_6:
   \   000191   05..         INC     ?V2
   \   000193   80AC         SJMP    ??MT_AfDataRequestSrcRtg_4
    537          
    538              /* Data payload Length */
    539              dataLen = *pBuf++;
   \                     ??MT_AfDataRequestSrcRtg_5:
   \   000195   8E82         MOV     DPL,R6
   \   000197   8F83         MOV     DPH,R7
   \   000199   E0           MOVX    A,@DPTR
   \   00019A   F5..         MOV     ?V3,A
   \   00019C   8E82         MOV     DPL,R6
   \   00019E   8F83         MOV     DPH,R7
   \   0001A0   A3           INC     DPTR
   \   0001A1   AE82         MOV     R6,DPL
   \   0001A3   AF83         MOV     R7,DPH
    540          
    541              if ( epDesc == NULL )
   \   0001A5   E5..         MOV     A,?V14
   \   0001A7   45..         ORL     A,?V15
   \   0001A9   700B         JNZ     ??MT_AfDataRequestSrcRtg_7
    542              {
    543                retValue = afStatus_INVALID_PARAMETER;
   \   0001AB   85..82       MOV     DPL,?XSP + 0
   \   0001AE   85..83       MOV     DPH,?XSP + 1
   \   0001B1   7402         MOV     A,#0x2
   \   0001B3   F0           MOVX    @DPTR,A
   \   0001B4   805D         SJMP    ??MT_AfDataRequestSrcRtg_8
    544              }
    545              else
    546              {
    547                retValue = AF_DataRequestSrcRtg( &dstAddr, epDesc, cId, dataLen, pBuf,
    548                                               &transId, txOpts, radius, relayCnt, pRelayList );
   \                     ??MT_AfDataRequestSrcRtg_7:
   \   0001B6                ; Setup parameters for call to function AF_DataRequestSrcRtg
   \   0001B6   78..         MOV     R0,#?V6
   \   0001B8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001BB   E5..         MOV     A,?V4
   \   0001BD   F5..         MOV     ?V8,A
   \   0001BF   78..         MOV     R0,#?V8
   \   0001C1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001C4   E5..         MOV     A,?V11
   \   0001C6   F5..         MOV     ?V8,A
   \   0001C8   78..         MOV     R0,#?V8
   \   0001CA   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001CD   7405         MOV     A,#0x5
   \   0001CF   12....       LCALL   ?XSTACK_DISP100_8
   \   0001D2   88..         MOV     ?V8,R0
   \   0001D4   89..         MOV     ?V9,R1
   \   0001D6   78..         MOV     R0,#?V8
   \   0001D8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001DB   8E..         MOV     ?V8,R6
   \   0001DD   8F..         MOV     ?V9,R7
   \   0001DF   78..         MOV     R0,#?V8
   \   0001E1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001E4   85....       MOV     ?V8,?V3
   \   0001E7   75..00       MOV     ?V9,#0x0
   \   0001EA   78..         MOV     R0,#?V8
   \   0001EC   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001EF   78..         MOV     R0,#?V0
   \   0001F1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001F4   A9..         MOV     R1,?V12
   \   0001F6   AC..         MOV     R4,?V14
   \   0001F8   AD..         MOV     R5,?V15
   \   0001FA   740E         MOV     A,#0xe
   \   0001FC   12....       LCALL   ?XSTACK_DISP101_8
   \   0001FF   12....       LCALL   `??AF_DataRequestSrcRtg::?relay`; Banked call to: AF_DataRequestSrcRtg
   \   000202   740C         MOV     A,#0xc
   \   000204   12....       LCALL   ?DEALLOC_XSTACK8
   \   000207   E9           MOV     A,R1
   \   000208   C0E0         PUSH    A
   \   00020A   85..82       MOV     DPL,?XSP + 0
   \   00020D   85..83       MOV     DPH,?XSP + 1
   \   000210   D0E0         POP     A
   \   000212   F0           MOVX    @DPTR,A
    549              }
    550          
    551              /* Free the memory allocated */
    552              osal_mem_free( pRelayList );
   \                     ??MT_AfDataRequestSrcRtg_8:
   \   000213                ; Setup parameters for call to function osal_mem_free
   \   000213   AA..         MOV     R2,?V6
   \   000215   AB..         MOV     R3,?V7
   \   000217   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
   \   00021A   8009         SJMP    ??MT_AfDataRequestSrcRtg_9
    553            }
    554            else
    555            {
    556              retValue = afStatus_MEM_FAIL;
   \                     ??MT_AfDataRequestSrcRtg_3:
   \   00021C   85..82       MOV     DPL,?XSP + 0
   \   00021F   85..83       MOV     DPH,?XSP + 1
   \   000222   7410         MOV     A,#0x10
   \   000224   F0           MOVX    @DPTR,A
    557            }
    558          
    559          
    560            /* Build and send back the response */
    561            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmdId, 1, &retValue);
   \                     ??MT_AfDataRequestSrcRtg_9:
   \   000225                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000225   AC..         MOV     R4,?XSP + 0
   \   000227   AD..         MOV     R5,?XSP + 1
   \   000229   7B01         MOV     R3,#0x1
   \   00022B   AA..         MOV     R2,?V5
   \   00022D   7964         MOV     R1,#0x64
   \   00022F   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    562          }
   \   000232   740E         MOV     A,#0xe
   \   000234   12....       LCALL   ?DEALLOC_XSTACK8
   \   000237   7F10         MOV     R7,#0x10
   \   000239   02....       LJMP    ?BANKED_LEAVE_XDATA
    563          #endif
    564          
    565          #if defined INTER_PAN
    566          /***************************************************************************************************
    567           * @fn      MT_AfInterPanCtl
    568           *
    569           * @brief   Process the AF Inter Pan control command.
    570           *
    571           * @param   pBuf - pointer to the received buffer
    572           *
    573           * @return  none
    574           ***************************************************************************************************/
    575          static void MT_AfInterPanCtl(uint8 *pBuf)
    576          {
    577            uint8 cmd, rtrn;
    578            uint16 panId;
    579            endPointDesc_t *pEP;
    580          
    581            cmd = pBuf[MT_RPC_POS_CMD1];
    582            pBuf += MT_RPC_FRAME_HDR_SZ;
    583          
    584            switch (*pBuf++)  // Inter-pan request parameter.
    585            {
    586            case InterPanClr:
    587              rtrn = StubAPS_SetIntraPanChannel();           // Switch channel back to the NIB channel.
    588              break;
    589          
    590            case InterPanSet:
    591              rtrn = StubAPS_SetInterPanChannel(*pBuf);      // Set channel for inter-pan communication.
    592              break;
    593          
    594            case InterPanReg:
    595              if ((pEP = afFindEndPointDesc(*pBuf)))
    596              {
    597                StubAPS_RegisterApp(pEP);
    598                rtrn = SUCCESS;
    599              }
    600              else
    601              {
    602                rtrn = FAILURE;
    603              }
    604              break;
    605          
    606            case InterPanChk:
    607              panId = BUILD_UINT16(pBuf[0], pBuf[1]);
    608              rtrn = (StubAPS_InterPan(panId, pBuf[2])) ? ZSuccess : ZFailure;
    609              break;
    610          
    611            default:
    612              rtrn = afStatus_INVALID_PARAMETER;
    613              break;
    614            }
    615          
    616            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF), cmd, 1, &rtrn);
    617          }
    618          #endif
    619          
    620          /***************************************************************************************************
    621           * @fn      MT_AfDataConfirm
    622           *
    623           * @brief   Process
    624           *
    625           * @param   pBuf - pointer to the received buffer
    626           *
    627           * @return  none
    628           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    629          void MT_AfDataConfirm(afDataConfirm_t *pMsg)
   \                     MT_AfDataConfirm:
    630          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    631            uint8 retArray[3];
    632          
    633            retArray[0] = pMsg->hdr.status;
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   C0E0         PUSH    A
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   D0E0         POP     A
   \   00001E   F0           MOVX    @DPTR,A
    634            retArray[1] = pMsg->endpoint;
   \   00001F   8E82         MOV     DPL,R6
   \   000021   8F83         MOV     DPH,R7
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   C0E0         PUSH    A
   \   000028   7401         MOV     A,#0x1
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   D0E0         POP     A
   \   00002F   F0           MOVX    @DPTR,A
    635            retArray[2] = pMsg->transID;
   \   000030   8E82         MOV     DPL,R6
   \   000032   8F83         MOV     DPH,R7
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   C0E0         PUSH    A
   \   00003A   7402         MOV     A,#0x2
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   D0E0         POP     A
   \   000041   F0           MOVX    @DPTR,A
    636          
    637            /* Build and send back the response */
    638            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_AF), MT_AF_DATA_CONFIRM, 3, retArray);
   \   000042                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000042   AC..         MOV     R4,?XSP + 0
   \   000044   AD..         MOV     R5,?XSP + 1
   \   000046   7B03         MOV     R3,#0x3
   \   000048   7A80         MOV     R2,#-0x80
   \   00004A   7944         MOV     R1,#0x44
   \   00004C   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    639          }
   \   00004F   7403         MOV     A,#0x3
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054   7F01         MOV     R7,#0x1
   \   000056   02....       LJMP    ?BANKED_LEAVE_XDATA
    640          
    641          /***************************************************************************************************
    642           * @fn      MT_AfReflectError
    643           *
    644           * @brief   Process
    645           *
    646           * @param   pBuf - pointer to the received buffer
    647           *
    648           * @return  none
    649           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    650          void MT_AfReflectError(afReflectError_t *pMsg)
   \                     MT_AfReflectError:
    651          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    652            uint8 retArray[6];
    653          
    654            retArray[0] = pMsg->hdr.status;
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   C0E0         PUSH    A
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   D0E0         POP     A
   \   00001E   F0           MOVX    @DPTR,A
    655            retArray[1] = pMsg->endpoint;
   \   00001F   8E82         MOV     DPL,R6
   \   000021   8F83         MOV     DPH,R7
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   C0E0         PUSH    A
   \   000028   7401         MOV     A,#0x1
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   D0E0         POP     A
   \   00002F   F0           MOVX    @DPTR,A
    656            retArray[2] = pMsg->transID;
   \   000030   8E82         MOV     DPL,R6
   \   000032   8F83         MOV     DPH,R7
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   C0E0         PUSH    A
   \   00003A   7402         MOV     A,#0x2
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   D0E0         POP     A
   \   000041   F0           MOVX    @DPTR,A
    657            retArray[3] = pMsg->dstAddrMode;
   \   000042   8E82         MOV     DPL,R6
   \   000044   8F83         MOV     DPH,R7
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   C0E0         PUSH    A
   \   00004D   7403         MOV     A,#0x3
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \   000052   D0E0         POP     A
   \   000054   F0           MOVX    @DPTR,A
    658            retArray[4] = LO_UINT16( pMsg->dstAddr );
   \   000055   8E82         MOV     DPL,R6
   \   000057   8F83         MOV     DPH,R7
   \   000059   A3           INC     DPTR
   \   00005A   A3           INC     DPTR
   \   00005B   A3           INC     DPTR
   \   00005C   A3           INC     DPTR
   \   00005D   A3           INC     DPTR
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   F8           MOV     R0,A
   \   000060   A3           INC     DPTR
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F9           MOV     R1,A
   \   000063   E8           MOV     A,R0
   \   000064   C0E0         PUSH    A
   \   000066   7404         MOV     A,#0x4
   \   000068   12....       LCALL   ?XSTACK_DISP0_8
   \   00006B   D0E0         POP     A
   \   00006D   F0           MOVX    @DPTR,A
    659            retArray[5] = HI_UINT16( pMsg->dstAddr );
   \   00006E   8E82         MOV     DPL,R6
   \   000070   8F83         MOV     DPH,R7
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   A3           INC     DPTR
   \   000077   E0           MOVX    A,@DPTR
   \   000078   F8           MOV     R0,A
   \   000079   A3           INC     DPTR
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F9           MOV     R1,A
   \   00007C   E4           CLR     A
   \   00007D   C9           XCH     A,R1
   \   00007E   F8           MOV     R0,A
   \   00007F   E8           MOV     A,R0
   \   000080   C0E0         PUSH    A
   \   000082   7405         MOV     A,#0x5
   \   000084   12....       LCALL   ?XSTACK_DISP0_8
   \   000087   D0E0         POP     A
   \   000089   F0           MOVX    @DPTR,A
    660          
    661            /* Build and send back the response */
    662            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_AF), MT_AF_REFLECT_ERROR, 6, retArray);
   \   00008A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00008A   AC..         MOV     R4,?XSP + 0
   \   00008C   AD..         MOV     R5,?XSP + 1
   \   00008E   7B06         MOV     R3,#0x6
   \   000090   7A83         MOV     R2,#-0x7d
   \   000092   7944         MOV     R1,#0x44
   \   000094   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    663          }
   \   000097   7406         MOV     A,#0x6
   \   000099   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009C   7F01         MOV     R7,#0x1
   \   00009E   02....       LJMP    ?BANKED_LEAVE_XDATA
    664          
    665          /***************************************************************************************************
    666           * @fn          MT_AfIncomingMsg
    667           *
    668           * @brief       Process the callback subscription for AF Incoming data.
    669           *
    670           * @param       pkt - Incoming AF data.
    671           *
    672           * @return      none
    673           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    674          void MT_AfIncomingMsg(afIncomingMSGPacket_t *pMsg)
   \                     MT_AfIncomingMsg:
    675          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000                REQUIRE ?V8
   \   000000                REQUIRE ?V9
   \   000000                REQUIRE ?V10
   \   000000                REQUIRE ?V11
   \   000000                REQUIRE ?V12
   \   000000                REQUIRE ?V14
   \   000000                REQUIRE ?V15
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V8,R2
   \   00000C   8B..         MOV     ?V9,R3
    676            #define MT_AF_INC_MSG_LEN  20
    677            #define MT_AF_INC_MSG_EXT  10
    678          
    679            uint16 dataLen = pMsg->cmd.DataLength;  // Length of the data section in the response packet.
   \   00000E   E5..         MOV     A,?V8
   \   000010   2420         ADD     A,#0x20
   \   000012   F582         MOV     DPL,A
   \   000014   E4           CLR     A
   \   000015   35..         ADDC    A,?V9
   \   000017   F583         MOV     DPH,A
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V2,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V3,A
    680            uint16 respLen = MT_AF_INC_MSG_LEN + dataLen;
   \   000020   E5..         MOV     A,?V2
   \   000022   2414         ADD     A,#0x14
   \   000024   F5..         MOV     ?V0,A
   \   000026   E4           CLR     A
   \   000027   35..         ADDC    A,?V3
   \   000029   F5..         MOV     ?V1,A
    681            uint8 cmd = MT_AF_INCOMING_MSG;
   \   00002B   75..81       MOV     ?V12,#-0x7f
    682            uint8 *pRsp, *pTmp;
    683            mtAfInMsgList_t *pItem = NULL;
   \   00002E   75..00       MOV     ?V10,#0x0
   \   000031   75..00       MOV     ?V11,#0x0
    684          
    685          #if defined INTER_PAN
    686            if (StubAPS_InterPan(pMsg->srcAddr.panId, pMsg->srcAddr.endPoint))
    687            {
    688              cmd = MT_AF_INCOMING_MSG_EXT;
    689            }
    690            else
    691          #endif
    692            if ((pMsg->srcAddr.addrMode == afAddr64Bit) ||
    693                (respLen > (uint16)(MT_RPC_DATA_MAX - MT_AF_INC_MSG_EXT)))
   \   000034   E5..         MOV     A,?V8
   \   000036   240E         ADD     A,#0xe
   \   000038   F582         MOV     DPL,A
   \   00003A   E4           CLR     A
   \   00003B   35..         ADDC    A,?V9
   \   00003D   F583         MOV     DPH,A
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   6403         XRL     A,#0x3
   \   000042   600B         JZ      ??MT_AfIncomingMsg_0
   \   000044   C3           CLR     C
   \   000045   E5..         MOV     A,?V0
   \   000047   94F1         SUBB    A,#-0xf
   \   000049   E5..         MOV     A,?V1
   \   00004B   9400         SUBB    A,#0x0
   \   00004D   4003         JC      ??MT_AfIncomingMsg_1
    694            {
    695              cmd = MT_AF_INCOMING_MSG_EXT;
   \                     ??MT_AfIncomingMsg_0:
   \   00004F   75..82       MOV     ?V12,#-0x7e
    696            }
    697          
    698            if (cmd == MT_AF_INCOMING_MSG_EXT)
   \                     ??MT_AfIncomingMsg_1:
   \   000052   7482         MOV     A,#-0x7e
   \   000054   65..         XRL     A,?V12
   \   000056   700C         JNZ     ??MT_AfIncomingMsg_2
    699            {
    700              respLen += MT_AF_INC_MSG_EXT;
   \   000058   E5..         MOV     A,?V0
   \   00005A   240A         ADD     A,#0xa
   \   00005C   F5..         MOV     ?V0,A
   \   00005E   E5..         MOV     A,?V1
   \   000060   3400         ADDC    A,#0x0
   \   000062   F5..         MOV     ?V1,A
    701            }
    702          
    703            if (respLen > (uint16)MT_RPC_DATA_MAX)
   \                     ??MT_AfIncomingMsg_2:
   \   000064   C3           CLR     C
   \   000065   E5..         MOV     A,?V0
   \   000067   94FB         SUBB    A,#-0x5
   \   000069   E5..         MOV     A,?V1
   \   00006B   9400         SUBB    A,#0x0
   \   00006D   4042         JC      ??MT_AfIncomingMsg_3
    704            {
    705              if ((pItem = (mtAfInMsgList_t *)osal_mem_alloc(sizeof(mtAfInMsgList_t) + dataLen)) == NULL)
   \   00006F                ; Setup parameters for call to function osal_mem_alloc
   \   00006F   E5..         MOV     A,?V2
   \   000071   2409         ADD     A,#0x9
   \   000073   FA           MOV     R2,A
   \   000074   E4           CLR     A
   \   000075   35..         ADDC    A,?V3
   \   000077   FB           MOV     R3,A
   \   000078   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   00007B   8A..         MOV     ?V4,R2
   \   00007D   8B..         MOV     ?V5,R3
   \   00007F   85....       MOV     ?V10,?V4
   \   000082   85....       MOV     ?V11,?V5
   \   000085   E5..         MOV     A,?V10
   \   000087   45..         ORL     A,?V11
   \   000089   7003         JNZ     $+5
   \   00008B   02....       LJMP    ??MT_AfIncomingMsg_4 & 0xFFFF
    706              {
    707                return;  // If cannot hold a huge message, cannot give indication at all.
    708              }
    709          
    710              pItem->data = (uint8 *)(pItem+1);
   \   00008E   E5..         MOV     A,?V10
   \   000090   2409         ADD     A,#0x9
   \   000092   F8           MOV     R0,A
   \   000093   E4           CLR     A
   \   000094   35..         ADDC    A,?V11
   \   000096   F9           MOV     R1,A
   \   000097   85..82       MOV     DPL,?V10
   \   00009A   85..83       MOV     DPH,?V11
   \   00009D   A3           INC     DPTR
   \   00009E   A3           INC     DPTR
   \   00009F   E8           MOV     A,R0
   \   0000A0   F0           MOVX    @DPTR,A
   \   0000A1   A3           INC     DPTR
   \   0000A2   E9           MOV     A,R1
   \   0000A3   F0           MOVX    @DPTR,A
    711              respLen -= dataLen;  // Zero data bytes are sent with an over-sized incoming indication.
   \   0000A4   C3           CLR     C
   \   0000A5   E5..         MOV     A,?V0
   \   0000A7   95..         SUBB    A,?V2
   \   0000A9   F5..         MOV     ?V0,A
   \   0000AB   E5..         MOV     A,?V1
   \   0000AD   95..         SUBB    A,?V3
   \   0000AF   F5..         MOV     ?V1,A
    712            }
    713          
    714            // Attempt to allocate memory for the response packet.
    715            if ((pRsp = osal_mem_alloc(respLen)) == NULL)
   \                     ??MT_AfIncomingMsg_3:
   \   0000B1                ; Setup parameters for call to function osal_mem_alloc
   \   0000B1   AA..         MOV     R2,?V0
   \   0000B3   AB..         MOV     R3,?V1
   \   0000B5   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   0000B8   8A..         MOV     ?V4,R2
   \   0000BA   8B..         MOV     ?V5,R3
   \   0000BC   85....       MOV     ?V14,?V4
   \   0000BF   85....       MOV     ?V15,?V5
   \   0000C2   E5..         MOV     A,?V14
   \   0000C4   45..         ORL     A,?V15
   \   0000C6   7010         JNZ     ??MT_AfIncomingMsg_5
    716            {
    717              if (pItem != NULL)
   \   0000C8   E5..         MOV     A,?V10
   \   0000CA   45..         ORL     A,?V11
   \   0000CC   6007         JZ      ??MT_AfIncomingMsg_6
    718              {
    719                (void)osal_mem_free(pItem);
   \   0000CE                ; Setup parameters for call to function osal_mem_free
   \   0000CE   AA..         MOV     R2,?V10
   \   0000D0   AB..         MOV     R3,?V11
   \   0000D2   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    720              }
    721              return;
   \                     ??MT_AfIncomingMsg_6:
   \   0000D5   02....       LJMP    ??MT_AfIncomingMsg_4 & 0xFFFF
    722            }
    723            pTmp = pRsp;
   \                     ??MT_AfIncomingMsg_5:
   \   0000D8   AE..         MOV     R6,?V14
   \   0000DA   AF..         MOV     R7,?V15
    724          
    725            /* Group ID */
    726            *pTmp++ = LO_UINT16(pMsg->groupId);
   \   0000DC   85..82       MOV     DPL,?V8
   \   0000DF   85..83       MOV     DPH,?V9
   \   0000E2   A3           INC     DPTR
   \   0000E3   A3           INC     DPTR
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   F8           MOV     R0,A
   \   0000E6   A3           INC     DPTR
   \   0000E7   E0           MOVX    A,@DPTR
   \   0000E8   F9           MOV     R1,A
   \   0000E9   E8           MOV     A,R0
   \   0000EA   C0E0         PUSH    A
   \   0000EC   8E82         MOV     DPL,R6
   \   0000EE   8F83         MOV     DPH,R7
   \   0000F0   D0E0         POP     A
   \   0000F2   F0           MOVX    @DPTR,A
   \   0000F3   8E82         MOV     DPL,R6
   \   0000F5   8F83         MOV     DPH,R7
   \   0000F7   A3           INC     DPTR
   \   0000F8   AE82         MOV     R6,DPL
   \   0000FA   AF83         MOV     R7,DPH
    727            *pTmp++ = HI_UINT16(pMsg->groupId);
   \   0000FC   85..82       MOV     DPL,?V8
   \   0000FF   85..83       MOV     DPH,?V9
   \   000102   A3           INC     DPTR
   \   000103   A3           INC     DPTR
   \   000104   E0           MOVX    A,@DPTR
   \   000105   F8           MOV     R0,A
   \   000106   A3           INC     DPTR
   \   000107   E0           MOVX    A,@DPTR
   \   000108   F9           MOV     R1,A
   \   000109   E4           CLR     A
   \   00010A   C9           XCH     A,R1
   \   00010B   F8           MOV     R0,A
   \   00010C   E8           MOV     A,R0
   \   00010D   C0E0         PUSH    A
   \   00010F   8E82         MOV     DPL,R6
   \   000111   8F83         MOV     DPH,R7
   \   000113   D0E0         POP     A
   \   000115   F0           MOVX    @DPTR,A
   \   000116   8E82         MOV     DPL,R6
   \   000118   8F83         MOV     DPH,R7
   \   00011A   A3           INC     DPTR
   \   00011B   AE82         MOV     R6,DPL
   \   00011D   AF83         MOV     R7,DPH
    728          
    729            /* Cluster ID */
    730            *pTmp++ = LO_UINT16(pMsg->clusterId);
   \   00011F   85..82       MOV     DPL,?V8
   \   000122   85..83       MOV     DPH,?V9
   \   000125   A3           INC     DPTR
   \   000126   A3           INC     DPTR
   \   000127   A3           INC     DPTR
   \   000128   A3           INC     DPTR
   \   000129   E0           MOVX    A,@DPTR
   \   00012A   F8           MOV     R0,A
   \   00012B   A3           INC     DPTR
   \   00012C   E0           MOVX    A,@DPTR
   \   00012D   F9           MOV     R1,A
   \   00012E   E8           MOV     A,R0
   \   00012F   C0E0         PUSH    A
   \   000131   8E82         MOV     DPL,R6
   \   000133   8F83         MOV     DPH,R7
   \   000135   D0E0         POP     A
   \   000137   F0           MOVX    @DPTR,A
   \   000138   8E82         MOV     DPL,R6
   \   00013A   8F83         MOV     DPH,R7
   \   00013C   A3           INC     DPTR
   \   00013D   AE82         MOV     R6,DPL
   \   00013F   AF83         MOV     R7,DPH
    731            *pTmp++ = HI_UINT16(pMsg->clusterId);
   \   000141   85..82       MOV     DPL,?V8
   \   000144   85..83       MOV     DPH,?V9
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   A3           INC     DPTR
   \   00014B   E0           MOVX    A,@DPTR
   \   00014C   F8           MOV     R0,A
   \   00014D   A3           INC     DPTR
   \   00014E   E0           MOVX    A,@DPTR
   \   00014F   F9           MOV     R1,A
   \   000150   E4           CLR     A
   \   000151   C9           XCH     A,R1
   \   000152   F8           MOV     R0,A
   \   000153   E8           MOV     A,R0
   \   000154   C0E0         PUSH    A
   \   000156   8E82         MOV     DPL,R6
   \   000158   8F83         MOV     DPH,R7
   \   00015A   D0E0         POP     A
   \   00015C   F0           MOVX    @DPTR,A
   \   00015D   8E82         MOV     DPL,R6
   \   00015F   8F83         MOV     DPH,R7
   \   000161   A3           INC     DPTR
   \   000162   AE82         MOV     R6,DPL
   \   000164   AF83         MOV     R7,DPH
    732          
    733            if (cmd == MT_AF_INCOMING_MSG_EXT)
   \   000166   7482         MOV     A,#-0x7e
   \   000168   65..         XRL     A,?V12
   \   00016A   6003         JZ      $+5
   \   00016C   02....       LJMP    ??MT_AfIncomingMsg_7 & 0xFFFF
    734            {
    735              *pTmp++ = pMsg->srcAddr.addrMode;
   \   00016F   E5..         MOV     A,?V8
   \   000171   240E         ADD     A,#0xe
   \   000173   F582         MOV     DPL,A
   \   000175   E4           CLR     A
   \   000176   35..         ADDC    A,?V9
   \   000178   F583         MOV     DPH,A
   \   00017A   E0           MOVX    A,@DPTR
   \   00017B   C0E0         PUSH    A
   \   00017D   8E82         MOV     DPL,R6
   \   00017F   8F83         MOV     DPH,R7
   \   000181   D0E0         POP     A
   \   000183   F0           MOVX    @DPTR,A
   \   000184   8E82         MOV     DPL,R6
   \   000186   8F83         MOV     DPH,R7
   \   000188   A3           INC     DPTR
   \   000189   AE82         MOV     R6,DPL
   \   00018B   AF83         MOV     R7,DPH
    736          
    737              if (pMsg->srcAddr.addrMode == afAddr64Bit)
   \   00018D   E5..         MOV     A,?V8
   \   00018F   240E         ADD     A,#0xe
   \   000191   F582         MOV     DPL,A
   \   000193   E4           CLR     A
   \   000194   35..         ADDC    A,?V9
   \   000196   F583         MOV     DPH,A
   \   000198   E0           MOVX    A,@DPTR
   \   000199   6403         XRL     A,#0x3
   \   00019B   702F         JNZ     ??MT_AfIncomingMsg_8
    738              {
    739                (void)osal_memcpy(pTmp, pMsg->srcAddr.addr.extAddr, Z_EXTADDR_LEN);
   \   00019D                ; Setup parameters for call to function osal_memcpy
   \   00019D   E5..         MOV     A,?V8
   \   00019F   2406         ADD     A,#0x6
   \   0001A1   F5..         MOV     ?V4,A
   \   0001A3   E4           CLR     A
   \   0001A4   35..         ADDC    A,?V9
   \   0001A6   F5..         MOV     ?V5,A
   \   0001A8   75..00       MOV     ?V6,#0x0
   \   0001AB   78..         MOV     R0,#?V4
   \   0001AD   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0001B0   7C08         MOV     R4,#0x8
   \   0001B2   7D00         MOV     R5,#0x0
   \   0001B4   EE           MOV     A,R6
   \   0001B5   FA           MOV     R2,A
   \   0001B6   EF           MOV     A,R7
   \   0001B7   FB           MOV     R3,A
   \   0001B8   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0001BB   7403         MOV     A,#0x3
   \   0001BD   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001C0   8A..         MOV     ?V4,R2
   \   0001C2   8B..         MOV     ?V5,R3
   \   0001C4   85..82       MOV     DPL,?V4
   \   0001C7   85..83       MOV     DPH,?V5
   \   0001CA   803A         SJMP    ??MT_AfIncomingMsg_9
    740              }
    741              else
    742              {
    743                pTmp[0] = LO_UINT16(pMsg->srcAddr.addr.shortAddr);
   \                     ??MT_AfIncomingMsg_8:
   \   0001CC   85..82       MOV     DPL,?V8
   \   0001CF   85..83       MOV     DPH,?V9
   \   0001D2   A3           INC     DPTR
   \   0001D3   A3           INC     DPTR
   \   0001D4   A3           INC     DPTR
   \   0001D5   A3           INC     DPTR
   \   0001D6   A3           INC     DPTR
   \   0001D7   A3           INC     DPTR
   \   0001D8   E0           MOVX    A,@DPTR
   \   0001D9   F8           MOV     R0,A
   \   0001DA   A3           INC     DPTR
   \   0001DB   E0           MOVX    A,@DPTR
   \   0001DC   F9           MOV     R1,A
   \   0001DD   E8           MOV     A,R0
   \   0001DE   C0E0         PUSH    A
   \   0001E0   8E82         MOV     DPL,R6
   \   0001E2   8F83         MOV     DPH,R7
   \   0001E4   D0E0         POP     A
   \   0001E6   F0           MOVX    @DPTR,A
    744                pTmp[1] = HI_UINT16(pMsg->srcAddr.addr.shortAddr);
   \   0001E7   85..82       MOV     DPL,?V8
   \   0001EA   85..83       MOV     DPH,?V9
   \   0001ED   A3           INC     DPTR
   \   0001EE   A3           INC     DPTR
   \   0001EF   A3           INC     DPTR
   \   0001F0   A3           INC     DPTR
   \   0001F1   A3           INC     DPTR
   \   0001F2   A3           INC     DPTR
   \   0001F3   E0           MOVX    A,@DPTR
   \   0001F4   F8           MOV     R0,A
   \   0001F5   A3           INC     DPTR
   \   0001F6   E0           MOVX    A,@DPTR
   \   0001F7   F9           MOV     R1,A
   \   0001F8   E4           CLR     A
   \   0001F9   C9           XCH     A,R1
   \   0001FA   F8           MOV     R0,A
   \   0001FB   E8           MOV     A,R0
   \   0001FC   C0E0         PUSH    A
   \   0001FE   8E82         MOV     DPL,R6
   \   000200   8F83         MOV     DPH,R7
   \   000202   A3           INC     DPTR
   \   000203   D0E0         POP     A
   \   000205   F0           MOVX    @DPTR,A
    745              }
    746              pTmp += Z_EXTADDR_LEN;
   \                     ??MT_AfIncomingMsg_9:
   \   000206   EE           MOV     A,R6
   \   000207   2408         ADD     A,#0x8
   \   000209   FE           MOV     R6,A
   \   00020A   5001         JNC     ??MT_AfIncomingMsg_10
   \   00020C   0F           INC     R7
    747          
    748              *pTmp++ = pMsg->srcAddr.endPoint;
   \                     ??MT_AfIncomingMsg_10:
   \   00020D   E5..         MOV     A,?V8
   \   00020F   240F         ADD     A,#0xf
   \   000211   F582         MOV     DPL,A
   \   000213   E4           CLR     A
   \   000214   35..         ADDC    A,?V9
   \   000216   F583         MOV     DPH,A
   \   000218   E0           MOVX    A,@DPTR
   \   000219   C0E0         PUSH    A
   \   00021B   8E82         MOV     DPL,R6
   \   00021D   8F83         MOV     DPH,R7
   \   00021F   D0E0         POP     A
   \   000221   F0           MOVX    @DPTR,A
   \   000222   8E82         MOV     DPL,R6
   \   000224   8F83         MOV     DPH,R7
   \   000226   A3           INC     DPTR
   \   000227   AE82         MOV     R6,DPL
   \   000229   AF83         MOV     R7,DPH
    749          #if defined INTER_PAN
    750              *pTmp++ = LO_UINT16(pMsg->srcAddr.panId);
    751              *pTmp++ = HI_UINT16(pMsg->srcAddr.panId);
    752          #else
    753              *pTmp++ = 0;
   \   00022B   8E82         MOV     DPL,R6
   \   00022D   8F83         MOV     DPH,R7
   \   00022F   7400         MOV     A,#0x0
   \   000231   F0           MOVX    @DPTR,A
   \   000232   8E82         MOV     DPL,R6
   \   000234   8F83         MOV     DPH,R7
   \   000236   A3           INC     DPTR
   \   000237   AE82         MOV     R6,DPL
   \   000239   AF83         MOV     R7,DPH
    754              *pTmp++ = 0;
   \   00023B   8E82         MOV     DPL,R6
   \   00023D   8F83         MOV     DPH,R7
   \   00023F   7400         MOV     A,#0x0
   \   000241   F0           MOVX    @DPTR,A
   \   000242   8E82         MOV     DPL,R6
   \   000244   8F83         MOV     DPH,R7
   \   000246   A3           INC     DPTR
   \   000247   AE82         MOV     R6,DPL
   \   000249   AF83         MOV     R7,DPH
   \   00024B   8069         SJMP    ??MT_AfIncomingMsg_11
    755          #endif
    756            }
    757            else
    758            {
    759              /* Source Address */
    760              *pTmp++ = LO_UINT16(pMsg->srcAddr.addr.shortAddr);
   \                     ??MT_AfIncomingMsg_7:
   \   00024D   85..82       MOV     DPL,?V8
   \   000250   85..83       MOV     DPH,?V9
   \   000253   A3           INC     DPTR
   \   000254   A3           INC     DPTR
   \   000255   A3           INC     DPTR
   \   000256   A3           INC     DPTR
   \   000257   A3           INC     DPTR
   \   000258   A3           INC     DPTR
   \   000259   E0           MOVX    A,@DPTR
   \   00025A   F8           MOV     R0,A
   \   00025B   A3           INC     DPTR
   \   00025C   E0           MOVX    A,@DPTR
   \   00025D   F9           MOV     R1,A
   \   00025E   E8           MOV     A,R0
   \   00025F   C0E0         PUSH    A
   \   000261   8E82         MOV     DPL,R6
   \   000263   8F83         MOV     DPH,R7
   \   000265   D0E0         POP     A
   \   000267   F0           MOVX    @DPTR,A
   \   000268   8E82         MOV     DPL,R6
   \   00026A   8F83         MOV     DPH,R7
   \   00026C   A3           INC     DPTR
   \   00026D   AE82         MOV     R6,DPL
   \   00026F   AF83         MOV     R7,DPH
    761              *pTmp++ = HI_UINT16(pMsg->srcAddr.addr.shortAddr);
   \   000271   85..82       MOV     DPL,?V8
   \   000274   85..83       MOV     DPH,?V9
   \   000277   A3           INC     DPTR
   \   000278   A3           INC     DPTR
   \   000279   A3           INC     DPTR
   \   00027A   A3           INC     DPTR
   \   00027B   A3           INC     DPTR
   \   00027C   A3           INC     DPTR
   \   00027D   E0           MOVX    A,@DPTR
   \   00027E   F8           MOV     R0,A
   \   00027F   A3           INC     DPTR
   \   000280   E0           MOVX    A,@DPTR
   \   000281   F9           MOV     R1,A
   \   000282   E4           CLR     A
   \   000283   C9           XCH     A,R1
   \   000284   F8           MOV     R0,A
   \   000285   E8           MOV     A,R0
   \   000286   C0E0         PUSH    A
   \   000288   8E82         MOV     DPL,R6
   \   00028A   8F83         MOV     DPH,R7
   \   00028C   D0E0         POP     A
   \   00028E   F0           MOVX    @DPTR,A
   \   00028F   8E82         MOV     DPL,R6
   \   000291   8F83         MOV     DPH,R7
   \   000293   A3           INC     DPTR
   \   000294   AE82         MOV     R6,DPL
   \   000296   AF83         MOV     R7,DPH
    762          
    763              /* Source EP */
    764              *pTmp++ = pMsg->srcAddr.endPoint;
   \   000298   E5..         MOV     A,?V8
   \   00029A   240F         ADD     A,#0xf
   \   00029C   F582         MOV     DPL,A
   \   00029E   E4           CLR     A
   \   00029F   35..         ADDC    A,?V9
   \   0002A1   F583         MOV     DPH,A
   \   0002A3   E0           MOVX    A,@DPTR
   \   0002A4   C0E0         PUSH    A
   \   0002A6   8E82         MOV     DPL,R6
   \   0002A8   8F83         MOV     DPH,R7
   \   0002AA   D0E0         POP     A
   \   0002AC   F0           MOVX    @DPTR,A
   \   0002AD   8E82         MOV     DPL,R6
   \   0002AF   8F83         MOV     DPH,R7
   \   0002B1   A3           INC     DPTR
   \   0002B2   AE82         MOV     R6,DPL
   \   0002B4   AF83         MOV     R7,DPH
    765            }
    766          
    767            /* Destination EP */
    768            *pTmp++ = pMsg->endPoint;
   \                     ??MT_AfIncomingMsg_11:
   \   0002B6   E5..         MOV     A,?V8
   \   0002B8   2414         ADD     A,#0x14
   \   0002BA   F582         MOV     DPL,A
   \   0002BC   E4           CLR     A
   \   0002BD   35..         ADDC    A,?V9
   \   0002BF   F583         MOV     DPH,A
   \   0002C1   E0           MOVX    A,@DPTR
   \   0002C2   C0E0         PUSH    A
   \   0002C4   8E82         MOV     DPL,R6
   \   0002C6   8F83         MOV     DPH,R7
   \   0002C8   D0E0         POP     A
   \   0002CA   F0           MOVX    @DPTR,A
   \   0002CB   8E82         MOV     DPL,R6
   \   0002CD   8F83         MOV     DPH,R7
   \   0002CF   A3           INC     DPTR
   \   0002D0   AE82         MOV     R6,DPL
   \   0002D2   AF83         MOV     R7,DPH
    769          
    770            /* WasBroadCast */
    771            *pTmp++ = pMsg->wasBroadcast;
   \   0002D4   E5..         MOV     A,?V8
   \   0002D6   2415         ADD     A,#0x15
   \   0002D8   F582         MOV     DPL,A
   \   0002DA   E4           CLR     A
   \   0002DB   35..         ADDC    A,?V9
   \   0002DD   F583         MOV     DPH,A
   \   0002DF   E0           MOVX    A,@DPTR
   \   0002E0   C0E0         PUSH    A
   \   0002E2   8E82         MOV     DPL,R6
   \   0002E4   8F83         MOV     DPH,R7
   \   0002E6   D0E0         POP     A
   \   0002E8   F0           MOVX    @DPTR,A
   \   0002E9   8E82         MOV     DPL,R6
   \   0002EB   8F83         MOV     DPH,R7
   \   0002ED   A3           INC     DPTR
   \   0002EE   AE82         MOV     R6,DPL
   \   0002F0   AF83         MOV     R7,DPH
    772          
    773            /* LinkQuality */
    774            *pTmp++ = pMsg->LinkQuality;
   \   0002F2   E5..         MOV     A,?V8
   \   0002F4   2416         ADD     A,#0x16
   \   0002F6   F582         MOV     DPL,A
   \   0002F8   E4           CLR     A
   \   0002F9   35..         ADDC    A,?V9
   \   0002FB   F583         MOV     DPH,A
   \   0002FD   E0           MOVX    A,@DPTR
   \   0002FE   C0E0         PUSH    A
   \   000300   8E82         MOV     DPL,R6
   \   000302   8F83         MOV     DPH,R7
   \   000304   D0E0         POP     A
   \   000306   F0           MOVX    @DPTR,A
   \   000307   8E82         MOV     DPL,R6
   \   000309   8F83         MOV     DPH,R7
   \   00030B   A3           INC     DPTR
   \   00030C   AE82         MOV     R6,DPL
   \   00030E   AF83         MOV     R7,DPH
    775          
    776            /* SecurityUse */
    777            *pTmp++ = pMsg->SecurityUse;
   \   000310   E5..         MOV     A,?V8
   \   000312   2419         ADD     A,#0x19
   \   000314   F582         MOV     DPL,A
   \   000316   E4           CLR     A
   \   000317   35..         ADDC    A,?V9
   \   000319   F583         MOV     DPH,A
   \   00031B   E0           MOVX    A,@DPTR
   \   00031C   C0E0         PUSH    A
   \   00031E   8E82         MOV     DPL,R6
   \   000320   8F83         MOV     DPH,R7
   \   000322   D0E0         POP     A
   \   000324   F0           MOVX    @DPTR,A
   \   000325   8E82         MOV     DPL,R6
   \   000327   8F83         MOV     DPH,R7
   \   000329   A3           INC     DPTR
   \   00032A   AE82         MOV     R6,DPL
   \   00032C   AF83         MOV     R7,DPH
    778          
    779            /* Timestamp */
    780            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 0);
   \   00032E   E5..         MOV     A,?V8
   \   000330   241A         ADD     A,#0x1a
   \   000332   F582         MOV     DPL,A
   \   000334   E4           CLR     A
   \   000335   35..         ADDC    A,?V9
   \   000337   F583         MOV     DPH,A
   \   000339   78..         MOV     R0,#?V4
   \   00033B   12....       LCALL   ?L_MOV_X
   \   00033E   E5..         MOV     A,?V4
   \   000340   C0E0         PUSH    A
   \   000342   8E82         MOV     DPL,R6
   \   000344   8F83         MOV     DPH,R7
   \   000346   D0E0         POP     A
   \   000348   F0           MOVX    @DPTR,A
   \   000349   8E82         MOV     DPL,R6
   \   00034B   8F83         MOV     DPH,R7
   \   00034D   A3           INC     DPTR
   \   00034E   AE82         MOV     R6,DPL
   \   000350   AF83         MOV     R7,DPH
    781            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 1);
   \   000352   E5..         MOV     A,?V8
   \   000354   241A         ADD     A,#0x1a
   \   000356   F582         MOV     DPL,A
   \   000358   E4           CLR     A
   \   000359   35..         ADDC    A,?V9
   \   00035B   F583         MOV     DPH,A
   \   00035D   78..         MOV     R0,#?V4
   \   00035F   12....       LCALL   ?L_MOV_X
   \   000362   E4           CLR     A
   \   000363   C5..         XCH     A,?V5
   \   000365   F5..         MOV     ?V4,A
   \   000367   E5..         MOV     A,?V4
   \   000369   C0E0         PUSH    A
   \   00036B   8E82         MOV     DPL,R6
   \   00036D   8F83         MOV     DPH,R7
   \   00036F   D0E0         POP     A
   \   000371   F0           MOVX    @DPTR,A
   \   000372   8E82         MOV     DPL,R6
   \   000374   8F83         MOV     DPH,R7
   \   000376   A3           INC     DPTR
   \   000377   AE82         MOV     R6,DPL
   \   000379   AF83         MOV     R7,DPH
    782            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 2);
   \   00037B   E5..         MOV     A,?V8
   \   00037D   241A         ADD     A,#0x1a
   \   00037F   F582         MOV     DPL,A
   \   000381   E4           CLR     A
   \   000382   35..         ADDC    A,?V9
   \   000384   F583         MOV     DPH,A
   \   000386   78..         MOV     R0,#?V4
   \   000388   12....       LCALL   ?L_MOV_X
   \   00038B   7410         MOV     A,#0x10
   \   00038D   78..         MOV     R0,#?V4
   \   00038F   12....       LCALL   ?UL_SHR
   \   000392   E5..         MOV     A,?V4
   \   000394   C0E0         PUSH    A
   \   000396   8E82         MOV     DPL,R6
   \   000398   8F83         MOV     DPH,R7
   \   00039A   D0E0         POP     A
   \   00039C   F0           MOVX    @DPTR,A
   \   00039D   8E82         MOV     DPL,R6
   \   00039F   8F83         MOV     DPH,R7
   \   0003A1   A3           INC     DPTR
   \   0003A2   AE82         MOV     R6,DPL
   \   0003A4   AF83         MOV     R7,DPH
    783            *pTmp++ = BREAK_UINT32(pMsg->timestamp, 3);
   \   0003A6   E5..         MOV     A,?V8
   \   0003A8   241A         ADD     A,#0x1a
   \   0003AA   F582         MOV     DPL,A
   \   0003AC   E4           CLR     A
   \   0003AD   35..         ADDC    A,?V9
   \   0003AF   F583         MOV     DPH,A
   \   0003B1   78..         MOV     R0,#?V4
   \   0003B3   12....       LCALL   ?L_MOV_X
   \   0003B6   7418         MOV     A,#0x18
   \   0003B8   78..         MOV     R0,#?V4
   \   0003BA   12....       LCALL   ?UL_SHR
   \   0003BD   E5..         MOV     A,?V4
   \   0003BF   C0E0         PUSH    A
   \   0003C1   8E82         MOV     DPL,R6
   \   0003C3   8F83         MOV     DPH,R7
   \   0003C5   D0E0         POP     A
   \   0003C7   F0           MOVX    @DPTR,A
   \   0003C8   8E82         MOV     DPL,R6
   \   0003CA   8F83         MOV     DPH,R7
   \   0003CC   A3           INC     DPTR
   \   0003CD   AE82         MOV     R6,DPL
   \   0003CF   AF83         MOV     R7,DPH
    784          
    785          
    786            /* Data Length */
    787            if (cmd == MT_AF_INCOMING_MSG_EXT)
   \   0003D1   7482         MOV     A,#-0x7e
   \   0003D3   65..         XRL     A,?V12
   \   0003D5   7040         JNZ     ??MT_AfIncomingMsg_12
    788            {
    789              /* Z-Tool apparently takes the last Byte before the data buffer as the dynamic length and
    790               * ignores the bigger UInt16 length of an EXT incoming message. But no data bytes will be sent
    791               * with a huge message, so it's necessary to work-around and fake-out Z-Tool with a zero here.
    792               */
    793              *pTmp++ = 0;  // TODO - workaround Z-Tool shortcoming; should be: = pMsg->cmd.TransSeqNumber;
   \   0003D7   8E82         MOV     DPL,R6
   \   0003D9   8F83         MOV     DPH,R7
   \   0003DB   7400         MOV     A,#0x0
   \   0003DD   F0           MOVX    @DPTR,A
   \   0003DE   8E82         MOV     DPL,R6
   \   0003E0   8F83         MOV     DPH,R7
   \   0003E2   A3           INC     DPTR
   \   0003E3   AE82         MOV     R6,DPL
   \   0003E5   AF83         MOV     R7,DPH
    794              *pTmp++ = LO_UINT16(dataLen);
   \   0003E7   E5..         MOV     A,?V2
   \   0003E9   C0E0         PUSH    A
   \   0003EB   8E82         MOV     DPL,R6
   \   0003ED   8F83         MOV     DPH,R7
   \   0003EF   D0E0         POP     A
   \   0003F1   F0           MOVX    @DPTR,A
   \   0003F2   8E82         MOV     DPL,R6
   \   0003F4   8F83         MOV     DPH,R7
   \   0003F6   A3           INC     DPTR
   \   0003F7   AE82         MOV     R6,DPL
   \   0003F9   AF83         MOV     R7,DPH
    795              *pTmp++ = HI_UINT16(dataLen);
   \   0003FB   A8..         MOV     R0,?V2
   \   0003FD   A9..         MOV     R1,?V3
   \   0003FF   E4           CLR     A
   \   000400   C9           XCH     A,R1
   \   000401   F8           MOV     R0,A
   \   000402   E8           MOV     A,R0
   \   000403   C0E0         PUSH    A
   \   000405   8E82         MOV     DPL,R6
   \   000407   8F83         MOV     DPH,R7
   \   000409   D0E0         POP     A
   \   00040B   F0           MOVX    @DPTR,A
   \   00040C   8E82         MOV     DPL,R6
   \   00040E   8F83         MOV     DPH,R7
   \   000410   A3           INC     DPTR
   \   000411   AE82         MOV     R6,DPL
   \   000413   AF83         MOV     R7,DPH
   \   000415   8032         SJMP    ??MT_AfIncomingMsg_13
    796            }
    797            else
    798            {
    799              *pTmp++ = pMsg->cmd.TransSeqNumber;
   \                     ??MT_AfIncomingMsg_12:
   \   000417   E5..         MOV     A,?V8
   \   000419   241F         ADD     A,#0x1f
   \   00041B   F582         MOV     DPL,A
   \   00041D   E4           CLR     A
   \   00041E   35..         ADDC    A,?V9
   \   000420   F583         MOV     DPH,A
   \   000422   E0           MOVX    A,@DPTR
   \   000423   C0E0         PUSH    A
   \   000425   8E82         MOV     DPL,R6
   \   000427   8F83         MOV     DPH,R7
   \   000429   D0E0         POP     A
   \   00042B   F0           MOVX    @DPTR,A
   \   00042C   8E82         MOV     DPL,R6
   \   00042E   8F83         MOV     DPH,R7
   \   000430   A3           INC     DPTR
   \   000431   AE82         MOV     R6,DPL
   \   000433   AF83         MOV     R7,DPH
    800              *pTmp++ = dataLen;
   \   000435   E5..         MOV     A,?V2
   \   000437   C0E0         PUSH    A
   \   000439   8E82         MOV     DPL,R6
   \   00043B   8F83         MOV     DPH,R7
   \   00043D   D0E0         POP     A
   \   00043F   F0           MOVX    @DPTR,A
   \   000440   8E82         MOV     DPL,R6
   \   000442   8F83         MOV     DPH,R7
   \   000444   A3           INC     DPTR
   \   000445   AE82         MOV     R6,DPL
   \   000447   AF83         MOV     R7,DPH
    801            }
    802          
    803            /* Data */
    804            if (pItem != NULL)
   \                     ??MT_AfIncomingMsg_13:
   \   000449   E5..         MOV     A,?V10
   \   00044B   45..         ORL     A,?V11
   \   00044D   7003         JNZ     $+5
   \   00044F   02....       LJMP    ??MT_AfIncomingMsg_14 & 0xFFFF
    805            {
    806              // Enqueue the new huge incoming item.
    807              pItem->next = pMtAfInMsgList;
   \   000452   90....       MOV     DPTR,#pMtAfInMsgList
   \   000455   E0           MOVX    A,@DPTR
   \   000456   F8           MOV     R0,A
   \   000457   A3           INC     DPTR
   \   000458   E0           MOVX    A,@DPTR
   \   000459   F9           MOV     R1,A
   \   00045A   85..82       MOV     DPL,?V10
   \   00045D   85..83       MOV     DPH,?V11
   \   000460   E8           MOV     A,R0
   \   000461   F0           MOVX    @DPTR,A
   \   000462   A3           INC     DPTR
   \   000463   E9           MOV     A,R1
   \   000464   F0           MOVX    @DPTR,A
    808              pMtAfInMsgList = pItem;
   \   000465   90....       MOV     DPTR,#pMtAfInMsgList
   \   000468   E5..         MOV     A,?V10
   \   00046A   F0           MOVX    @DPTR,A
   \   00046B   A3           INC     DPTR
   \   00046C   E5..         MOV     A,?V11
   \   00046E   F0           MOVX    @DPTR,A
    809          
    810              // Setup to time-out the huge incoming item if host does not MT_AF_DATA_RETRIEVE it.
    811              pItem->tick = MT_AF_EXEC_CNT;
   \   00046F   85..82       MOV     DPL,?V10
   \   000472   85..83       MOV     DPH,?V11
   \   000475   A3           INC     DPTR
   \   000476   A3           INC     DPTR
   \   000477   A3           INC     DPTR
   \   000478   A3           INC     DPTR
   \   000479   A3           INC     DPTR
   \   00047A   A3           INC     DPTR
   \   00047B   A3           INC     DPTR
   \   00047C   A3           INC     DPTR
   \   00047D   740F         MOV     A,#0xf
   \   00047F   F0           MOVX    @DPTR,A
    812              if (ZSuccess != osal_start_timerEx(MT_TaskID, MT_AF_EXEC_EVT, MT_AF_EXEC_DLY))
   \   000480                ; Setup parameters for call to function osal_start_timerEx
   \   000480   90....       MOV     DPTR,#__Constant_3e8
   \   000483   12....       LCALL   ?PUSH_XSTACK8_X_FOUR
   \   000486   7A08         MOV     R2,#0x8
   \   000488   7B00         MOV     R3,#0x0
   \   00048A   90....       MOV     DPTR,#MT_TaskID
   \   00048D   E0           MOVX    A,@DPTR
   \   00048E   F9           MOV     R1,A
   \   00048F   12....       LCALL   `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   000492   7404         MOV     A,#0x4
   \   000494   12....       LCALL   ?DEALLOC_XSTACK8
   \   000497   E9           MOV     A,R1
   \   000498   6018         JZ      ??MT_AfIncomingMsg_15
    813              {
    814                (void)osal_set_event(MT_TaskID, MT_AF_EXEC_EVT);
   \   00049A                ; Setup parameters for call to function osal_set_event
   \   00049A   7A08         MOV     R2,#0x8
   \   00049C   7B00         MOV     R3,#0x0
   \   00049E   90....       MOV     DPTR,#MT_TaskID
   \   0004A1   E0           MOVX    A,@DPTR
   \   0004A2   F9           MOV     R1,A
   \   0004A3   12....       LCALL   `??osal_set_event::?relay`; Banked call to: osal_set_event
   \   0004A6   E9           MOV     A,R1
   \   0004A7   C0E0         PUSH    A
   \   0004A9   85..82       MOV     DPL,?XSP + 0
   \   0004AC   85..83       MOV     DPH,?XSP + 1
   \   0004AF   D0E0         POP     A
   \   0004B1   F0           MOVX    @DPTR,A
    815              }
    816          
    817              pItem->timestamp = pMsg->timestamp;
   \                     ??MT_AfIncomingMsg_15:
   \   0004B2   E5..         MOV     A,?V8
   \   0004B4   241A         ADD     A,#0x1a
   \   0004B6   F582         MOV     DPL,A
   \   0004B8   E4           CLR     A
   \   0004B9   35..         ADDC    A,?V9
   \   0004BB   F583         MOV     DPH,A
   \   0004BD   12....       LCALL   ?XLOAD_R0123
   \   0004C0   85..82       MOV     DPL,?V10
   \   0004C3   85..83       MOV     DPH,?V11
   \   0004C6   A3           INC     DPTR
   \   0004C7   A3           INC     DPTR
   \   0004C8   A3           INC     DPTR
   \   0004C9   A3           INC     DPTR
   \   0004CA   12....       LCALL   ?XSTORE_R0123
    818              (void)osal_memcpy(pItem->data, pMsg->cmd.Data, dataLen);
   \   0004CD                ; Setup parameters for call to function osal_memcpy
   \   0004CD   E5..         MOV     A,?V8
   \   0004CF   2422         ADD     A,#0x22
   \   0004D1   F582         MOV     DPL,A
   \   0004D3   E4           CLR     A
   \   0004D4   35..         ADDC    A,?V9
   \   0004D6   F583         MOV     DPH,A
   \   0004D8   E0           MOVX    A,@DPTR
   \   0004D9   F5..         MOV     ?V4,A
   \   0004DB   A3           INC     DPTR
   \   0004DC   E0           MOVX    A,@DPTR
   \   0004DD   F5..         MOV     ?V5,A
   \   0004DF   75..00       MOV     ?V6,#0x0
   \   0004E2   78..         MOV     R0,#?V4
   \   0004E4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0004E7   AC..         MOV     R4,?V2
   \   0004E9   AD..         MOV     R5,?V3
   \   0004EB   85..82       MOV     DPL,?V10
   \   0004EE   85..83       MOV     DPH,?V11
   \   0004F1   A3           INC     DPTR
   \   0004F2   A3           INC     DPTR
   \   0004F3   E0           MOVX    A,@DPTR
   \   0004F4   FA           MOV     R2,A
   \   0004F5   A3           INC     DPTR
   \   0004F6   E0           MOVX    A,@DPTR
   \   0004F7   FB           MOV     R3,A
   \   0004F8   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0004FB   7403         MOV     A,#0x3
   \   0004FD   12....       LCALL   ?DEALLOC_XSTACK8
   \   000500   8A..         MOV     ?V4,R2
   \   000502   8B..         MOV     ?V5,R3
   \   000504   85..82       MOV     DPL,?V4
   \   000507   85..83       MOV     DPH,?V5
   \   00050A   803C         SJMP    ??MT_AfIncomingMsg_16
    819            }
    820            else
    821            {
    822              (void)osal_memcpy(pTmp, pMsg->cmd.Data, dataLen);
   \                     ??MT_AfIncomingMsg_14:
   \   00050C                ; Setup parameters for call to function osal_memcpy
   \   00050C   E5..         MOV     A,?V8
   \   00050E   2422         ADD     A,#0x22
   \   000510   F582         MOV     DPL,A
   \   000512   E4           CLR     A
   \   000513   35..         ADDC    A,?V9
   \   000515   F583         MOV     DPH,A
   \   000517   E0           MOVX    A,@DPTR
   \   000518   F5..         MOV     ?V4,A
   \   00051A   A3           INC     DPTR
   \   00051B   E0           MOVX    A,@DPTR
   \   00051C   F5..         MOV     ?V5,A
   \   00051E   75..00       MOV     ?V6,#0x0
   \   000521   78..         MOV     R0,#?V4
   \   000523   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000526   AC..         MOV     R4,?V2
   \   000528   AD..         MOV     R5,?V3
   \   00052A   EE           MOV     A,R6
   \   00052B   FA           MOV     R2,A
   \   00052C   EF           MOV     A,R7
   \   00052D   FB           MOV     R3,A
   \   00052E   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000531   7403         MOV     A,#0x3
   \   000533   12....       LCALL   ?DEALLOC_XSTACK8
   \   000536   8A..         MOV     ?V4,R2
   \   000538   8B..         MOV     ?V5,R3
   \   00053A   85..82       MOV     DPL,?V4
   \   00053D   85..83       MOV     DPH,?V5
    823              pTmp += dataLen;
   \   000540   EE           MOV     A,R6
   \   000541   25..         ADD     A,?V2
   \   000543   FE           MOV     R6,A
   \   000544   EF           MOV     A,R7
   \   000545   35..         ADDC    A,?V3
   \   000547   FF           MOV     R7,A
    824            }
    825          
    826            // MAC Source address
    827            *pTmp++ = LO_UINT16(pMsg->macSrcAddr);
   \                     ??MT_AfIncomingMsg_16:
   \   000548   E5..         MOV     A,?V8
   \   00054A   2424         ADD     A,#0x24
   \   00054C   F582         MOV     DPL,A
   \   00054E   E4           CLR     A
   \   00054F   35..         ADDC    A,?V9
   \   000551   F583         MOV     DPH,A
   \   000553   E0           MOVX    A,@DPTR
   \   000554   F8           MOV     R0,A
   \   000555   A3           INC     DPTR
   \   000556   E0           MOVX    A,@DPTR
   \   000557   F9           MOV     R1,A
   \   000558   E8           MOV     A,R0
   \   000559   C0E0         PUSH    A
   \   00055B   8E82         MOV     DPL,R6
   \   00055D   8F83         MOV     DPH,R7
   \   00055F   D0E0         POP     A
   \   000561   F0           MOVX    @DPTR,A
   \   000562   8E82         MOV     DPL,R6
   \   000564   8F83         MOV     DPH,R7
   \   000566   A3           INC     DPTR
   \   000567   AE82         MOV     R6,DPL
   \   000569   AF83         MOV     R7,DPH
    828            *pTmp++ = HI_UINT16(pMsg->macSrcAddr);
   \   00056B   E5..         MOV     A,?V8
   \   00056D   2424         ADD     A,#0x24
   \   00056F   F582         MOV     DPL,A
   \   000571   E4           CLR     A
   \   000572   35..         ADDC    A,?V9
   \   000574   F583         MOV     DPH,A
   \   000576   E0           MOVX    A,@DPTR
   \   000577   F8           MOV     R0,A
   \   000578   A3           INC     DPTR
   \   000579   E0           MOVX    A,@DPTR
   \   00057A   F9           MOV     R1,A
   \   00057B   E4           CLR     A
   \   00057C   C9           XCH     A,R1
   \   00057D   F8           MOV     R0,A
   \   00057E   E8           MOV     A,R0
   \   00057F   C0E0         PUSH    A
   \   000581   8E82         MOV     DPL,R6
   \   000583   8F83         MOV     DPH,R7
   \   000585   D0E0         POP     A
   \   000587   F0           MOVX    @DPTR,A
   \   000588   8E82         MOV     DPL,R6
   \   00058A   8F83         MOV     DPH,R7
   \   00058C   A3           INC     DPTR
   \   00058D   AE82         MOV     R6,DPL
   \   00058F   AF83         MOV     R7,DPH
    829          
    830            // messages result radius
    831            *pTmp = pMsg->radius;
   \   000591   E5..         MOV     A,?V8
   \   000593   2426         ADD     A,#0x26
   \   000595   F582         MOV     DPL,A
   \   000597   E4           CLR     A
   \   000598   35..         ADDC    A,?V9
   \   00059A   F583         MOV     DPH,A
   \   00059C   E0           MOVX    A,@DPTR
   \   00059D   C0E0         PUSH    A
   \   00059F   8E82         MOV     DPL,R6
   \   0005A1   8F83         MOV     DPH,R7
   \   0005A3   D0E0         POP     A
   \   0005A5   F0           MOVX    @DPTR,A
    832          
    833            /* Build and send back the response */
    834            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ|(uint8)MT_RPC_SYS_AF), cmd, respLen, pRsp);
   \   0005A6                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0005A6   AC..         MOV     R4,?V14
   \   0005A8   AD..         MOV     R5,?V15
   \   0005AA   AB..         MOV     R3,?V0
   \   0005AC   AA..         MOV     R2,?V12
   \   0005AE   7944         MOV     R1,#0x44
   \   0005B0   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    835          
    836            (void)osal_mem_free(pRsp);
   \   0005B3                ; Setup parameters for call to function osal_mem_free
   \   0005B3   AA..         MOV     R2,?V14
   \   0005B5   AB..         MOV     R3,?V15
   \   0005B7   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    837          }
   \                     ??MT_AfIncomingMsg_4:
   \   0005BA   7401         MOV     A,#0x1
   \   0005BC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0005BF   7F10         MOV     R7,#0x10
   \   0005C1   02....       LJMP    ?BANKED_LEAVE_XDATA
    838          
    839          /**************************************************************************************************
    840           * @fn          MT_AfDataRetrieve
    841           *
    842           * @brief   Process AF Data Retrieve command to incrementally read out a very large
    843           *          incoming AF message.
    844           *
    845           * input parameters
    846           *
    847           * @param pBuf - pointer to the received buffer
    848           *
    849           * output parameters
    850           *
    851           * @param rtrn - AF-Status of the operation.
    852           *
    853           * @return      None.
    854           **************************************************************************************************
    855           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    856          void MT_AfDataRetrieve(uint8 *pBuf)
   \                     MT_AfDataRetrieve:
    857          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000                REQUIRE ?V8
   \   000000                REQUIRE ?V9
   \   000000                REQUIRE ?V10
   \   000000                REQUIRE ?V11
   \   000000                REQUIRE ?V12
   \   000000                REQUIRE ?V13
   \   000000                REQUIRE ?V14
   \   000000                REQUIRE ?V15
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    858            #define MT_AF_RTV_HDR_SZ  2
    859          
    860            uint32 timestamp;
    861            mtAfInMsgList_t *pPrev, *pItem = pMtAfInMsgList;
   \   00000E   90....       MOV     DPTR,#pMtAfInMsgList
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V14,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F5..         MOV     ?V15,A
    862            uint8 rtrn = afStatus_FAILED;
   \   000018   75..01       MOV     ?V13,#0x1
    863            uint8 len = 0;
   \   00001B   75..00       MOV     ?V12,#0x0
    864          
    865            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001E   EE           MOV     A,R6
   \   00001F   2403         ADD     A,#0x3
   \   000021   FE           MOV     R6,A
   \   000022   5001         JNC     ??MT_AfDataRetrieve_0
   \   000024   0F           INC     R7
    866            timestamp = BUILD_UINT32(pBuf[0], pBuf[1], pBuf[2], pBuf[3]);
   \                     ??MT_AfDataRetrieve_0:
   \   000025   8E82         MOV     DPL,R6
   \   000027   8F83         MOV     DPH,R7
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F5..         MOV     ?V0,A
   \   00002C   E4           CLR     A
   \   00002D   F5..         MOV     ?V1,A
   \   00002F   F5..         MOV     ?V2,A
   \   000031   F5..         MOV     ?V3,A
   \   000033   8E82         MOV     DPL,R6
   \   000035   8F83         MOV     DPH,R7
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F5..         MOV     ?V8,A
   \   00003B   E4           CLR     A
   \   00003C   F5..         MOV     ?V9,A
   \   00003E   F5..         MOV     ?V10,A
   \   000040   F5..         MOV     ?V11,A
   \   000042   7408         MOV     A,#0x8
   \   000044   78..         MOV     R0,#?V8
   \   000046   12....       LCALL   ?L_SHL
   \   000049   78..         MOV     R0,#?V0
   \   00004B   79..         MOV     R1,#?V8
   \   00004D   12....       LCALL   ?L_ADD
   \   000050   8E82         MOV     DPL,R6
   \   000052   8F83         MOV     DPH,R7
   \   000054   A3           INC     DPTR
   \   000055   A3           INC     DPTR
   \   000056   E0           MOVX    A,@DPTR
   \   000057   F5..         MOV     ?V8,A
   \   000059   E4           CLR     A
   \   00005A   F5..         MOV     ?V9,A
   \   00005C   F5..         MOV     ?V10,A
   \   00005E   F5..         MOV     ?V11,A
   \   000060   7410         MOV     A,#0x10
   \   000062   78..         MOV     R0,#?V8
   \   000064   12....       LCALL   ?L_SHL
   \   000067   78..         MOV     R0,#?V0
   \   000069   79..         MOV     R1,#?V8
   \   00006B   12....       LCALL   ?L_ADD
   \   00006E   8E82         MOV     DPL,R6
   \   000070   8F83         MOV     DPH,R7
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   A3           INC     DPTR
   \   000075   E0           MOVX    A,@DPTR
   \   000076   F5..         MOV     ?V8,A
   \   000078   E4           CLR     A
   \   000079   F5..         MOV     ?V9,A
   \   00007B   F5..         MOV     ?V10,A
   \   00007D   F5..         MOV     ?V11,A
   \   00007F   7418         MOV     A,#0x18
   \   000081   78..         MOV     R0,#?V8
   \   000083   12....       LCALL   ?L_SHL
   \   000086   78..         MOV     R0,#?V0
   \   000088   79..         MOV     R1,#?V8
   \   00008A   12....       LCALL   ?L_ADD
   \   00008D   85....       MOV     ?V4,?V0
   \   000090   85....       MOV     ?V5,?V1
   \   000093   85....       MOV     ?V6,?V2
   \   000096   85....       MOV     ?V7,?V3
    867          
    868            while (pItem != NULL)
   \                     ??MT_AfDataRetrieve_1:
   \   000099   E5..         MOV     A,?V14
   \   00009B   45..         ORL     A,?V15
   \   00009D   602D         JZ      ??MT_AfDataRetrieve_2
    869            {
    870              pPrev = pItem;
   \   00009F   85..82       MOV     DPL,?XSP + 0
   \   0000A2   85..83       MOV     DPH,?XSP + 1
   \   0000A5   E5..         MOV     A,?V14
   \   0000A7   F0           MOVX    @DPTR,A
   \   0000A8   A3           INC     DPTR
   \   0000A9   E5..         MOV     A,?V15
   \   0000AB   F0           MOVX    @DPTR,A
    871              if (pItem->timestamp == timestamp)
   \   0000AC   85..82       MOV     DPL,?V14
   \   0000AF   85..83       MOV     DPH,?V15
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   A3           INC     DPTR
   \   0000B6   78..         MOV     R0,#?V4
   \   0000B8   12....       LCALL   ?L_EQ_X
   \   0000BB   600F         JZ      ??MT_AfDataRetrieve_2
    872              {
    873                break;
    874              }
    875              pItem = pItem->next;
   \   0000BD   85..82       MOV     DPL,?V14
   \   0000C0   85..83       MOV     DPH,?V15
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   F5..         MOV     ?V14,A
   \   0000C6   A3           INC     DPTR
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   F5..         MOV     ?V15,A
   \   0000CA   80CD         SJMP    ??MT_AfDataRetrieve_1
    876            }
    877          
    878            if (pItem != NULL)
   \                     ??MT_AfDataRetrieve_2:
   \   0000CC   E5..         MOV     A,?V14
   \   0000CE   45..         ORL     A,?V15
   \   0000D0   7003         JNZ     $+5
   \   0000D2   02....       LJMP    ??MT_AfDataRetrieve_3 & 0xFFFF
    879            {
    880              uint16 idx;
    881              uint8 *pRsp;
    882          
    883              pBuf += 4;
   \   0000D5   EE           MOV     A,R6
   \   0000D6   2404         ADD     A,#0x4
   \   0000D8   FE           MOV     R6,A
   \   0000D9   5001         JNC     ??MT_AfDataRetrieve_4
   \   0000DB   0F           INC     R7
    884              idx = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??MT_AfDataRetrieve_4:
   \   0000DC   8E82         MOV     DPL,R6
   \   0000DE   8F83         MOV     DPH,R7
   \   0000E0   E0           MOVX    A,@DPTR
   \   0000E1   FA           MOV     R2,A
   \   0000E2   7B00         MOV     R3,#0x0
   \   0000E4   8E82         MOV     DPL,R6
   \   0000E6   8F83         MOV     DPH,R7
   \   0000E8   A3           INC     DPTR
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   F8           MOV     R0,A
   \   0000EB   7900         MOV     R1,#0x0
   \   0000ED   E4           CLR     A
   \   0000EE   C8           XCH     A,R0
   \   0000EF   F9           MOV     R1,A
   \   0000F0   EA           MOV     A,R2
   \   0000F1   28           ADD     A,R0
   \   0000F2   F8           MOV     R0,A
   \   0000F3   EB           MOV     A,R3
   \   0000F4   39           ADDC    A,R1
   \   0000F5   F9           MOV     R1,A
   \   0000F6   88..         MOV     ?V10,R0
   \   0000F8   89..         MOV     ?V11,R1
    885              len = pBuf[2];
   \   0000FA   8E82         MOV     DPL,R6
   \   0000FC   8F83         MOV     DPH,R7
   \   0000FE   A3           INC     DPTR
   \   0000FF   A3           INC     DPTR
   \   000100   E0           MOVX    A,@DPTR
   \   000101   F5..         MOV     ?V12,A
    886          
    887              if (len == 0)  // Indication to delete the afIncomingMSGPacket.
   \   000103   E5..         MOV     A,?V12
   \   000105   7052         JNZ     ??MT_AfDataRetrieve_5
    888              {
    889                if (pMtAfInMsgList == pItem)
   \   000107   90....       MOV     DPTR,#pMtAfInMsgList
   \   00010A   E0           MOVX    A,@DPTR
   \   00010B   F8           MOV     R0,A
   \   00010C   A3           INC     DPTR
   \   00010D   E0           MOVX    A,@DPTR
   \   00010E   F9           MOV     R1,A
   \   00010F   E5..         MOV     A,?V14
   \   000111   68           XRL     A,R0
   \   000112   7003         JNZ     ??MT_AfDataRetrieve_6
   \   000114   E5..         MOV     A,?V15
   \   000116   69           XRL     A,R1
   \                     ??MT_AfDataRetrieve_6:
   \   000117   7015         JNZ     ??MT_AfDataRetrieve_7
    890                {
    891                  pMtAfInMsgList = pItem->next;
   \   000119   85..82       MOV     DPL,?V14
   \   00011C   85..83       MOV     DPH,?V15
   \   00011F   E0           MOVX    A,@DPTR
   \   000120   F8           MOV     R0,A
   \   000121   A3           INC     DPTR
   \   000122   E0           MOVX    A,@DPTR
   \   000123   F9           MOV     R1,A
   \   000124   90....       MOV     DPTR,#pMtAfInMsgList
   \   000127   E8           MOV     A,R0
   \   000128   F0           MOVX    @DPTR,A
   \   000129   A3           INC     DPTR
   \   00012A   E9           MOV     A,R1
   \   00012B   F0           MOVX    @DPTR,A
   \   00012C   801E         SJMP    ??MT_AfDataRetrieve_8
    892                }
    893                else
    894                {
    895                  pPrev->next = pItem->next;
   \                     ??MT_AfDataRetrieve_7:
   \   00012E   85..82       MOV     DPL,?V14
   \   000131   85..83       MOV     DPH,?V15
   \   000134   E0           MOVX    A,@DPTR
   \   000135   FA           MOV     R2,A
   \   000136   A3           INC     DPTR
   \   000137   E0           MOVX    A,@DPTR
   \   000138   FB           MOV     R3,A
   \   000139   85..82       MOV     DPL,?XSP + 0
   \   00013C   85..83       MOV     DPH,?XSP + 1
   \   00013F   E0           MOVX    A,@DPTR
   \   000140   F8           MOV     R0,A
   \   000141   A3           INC     DPTR
   \   000142   E0           MOVX    A,@DPTR
   \   000143   F583         MOV     DPH,A
   \   000145   8882         MOV     DPL,R0
   \   000147   EA           MOV     A,R2
   \   000148   F0           MOVX    @DPTR,A
   \   000149   A3           INC     DPTR
   \   00014A   EB           MOV     A,R3
   \   00014B   F0           MOVX    @DPTR,A
    896                }
    897                (void)osal_mem_free(pItem);
   \                     ??MT_AfDataRetrieve_8:
   \   00014C                ; Setup parameters for call to function osal_mem_free
   \   00014C   AA..         MOV     R2,?V14
   \   00014E   AB..         MOV     R3,?V15
   \   000150   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    898                rtrn = afStatus_SUCCESS;
   \   000153   75..00       MOV     ?V13,#0x0
   \   000156   02....       LJMP    ??MT_AfDataRetrieve_3 & 0xFFFF
    899              }
    900              else if ((pRsp = osal_mem_alloc(len + MT_AF_RTV_HDR_SZ)) == NULL)
   \                     ??MT_AfDataRetrieve_5:
   \   000159                ; Setup parameters for call to function osal_mem_alloc
   \   000159   A8..         MOV     R0,?V12
   \   00015B   7900         MOV     R1,#0x0
   \   00015D   E8           MOV     A,R0
   \   00015E   2402         ADD     A,#0x2
   \   000160   FA           MOV     R2,A
   \   000161   E4           CLR     A
   \   000162   39           ADDC    A,R1
   \   000163   FB           MOV     R3,A
   \   000164   12....       LCALL   `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   000167   8A..         MOV     ?V0,R2
   \   000169   8B..         MOV     ?V1,R3
   \   00016B   85....       MOV     ?V8,?V0
   \   00016E   85....       MOV     ?V9,?V1
   \   000171   E5..         MOV     A,?V8
   \   000173   45..         ORL     A,?V9
   \   000175   7008         JNZ     ??MT_AfDataRetrieve_9
    901              {
    902                rtrn = afStatus_MEM_FAIL;
   \   000177   75..10       MOV     ?V13,#0x10
    903                len = 0;
   \   00017A   75..00       MOV     ?V12,#0x0
   \   00017D   806A         SJMP    ??MT_AfDataRetrieve_3
    904              }
    905              else
    906              {
    907                pRsp[0] = ZSuccess;
   \                     ??MT_AfDataRetrieve_9:
   \   00017F   85..82       MOV     DPL,?V8
   \   000182   85..83       MOV     DPH,?V9
   \   000185   7400         MOV     A,#0x0
   \   000187   F0           MOVX    @DPTR,A
    908                pRsp[1] = len;
   \   000188   E5..         MOV     A,?V12
   \   00018A   C0E0         PUSH    A
   \   00018C   85..82       MOV     DPL,?V8
   \   00018F   85..83       MOV     DPH,?V9
   \   000192   A3           INC     DPTR
   \   000193   D0E0         POP     A
   \   000195   F0           MOVX    @DPTR,A
    909                (void)osal_memcpy(pRsp + MT_AF_RTV_HDR_SZ, pItem->data+idx, len);
   \   000196                ; Setup parameters for call to function osal_memcpy
   \   000196   85..82       MOV     DPL,?V14
   \   000199   85..83       MOV     DPH,?V15
   \   00019C   A3           INC     DPTR
   \   00019D   A3           INC     DPTR
   \   00019E   E0           MOVX    A,@DPTR
   \   00019F   25..         ADD     A,?V10
   \   0001A1   F5..         MOV     ?V0,A
   \   0001A3   A3           INC     DPTR
   \   0001A4   E0           MOVX    A,@DPTR
   \   0001A5   35..         ADDC    A,?V11
   \   0001A7   F5..         MOV     ?V1,A
   \   0001A9   75..00       MOV     ?V2,#0x0
   \   0001AC   78..         MOV     R0,#?V0
   \   0001AE   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0001B1   AC..         MOV     R4,?V12
   \   0001B3   7D00         MOV     R5,#0x0
   \   0001B5   E5..         MOV     A,?V8
   \   0001B7   2402         ADD     A,#0x2
   \   0001B9   FA           MOV     R2,A
   \   0001BA   E4           CLR     A
   \   0001BB   35..         ADDC    A,?V9
   \   0001BD   FB           MOV     R3,A
   \   0001BE   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   0001C1   7403         MOV     A,#0x3
   \   0001C3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001C6   8A..         MOV     ?V0,R2
   \   0001C8   8B..         MOV     ?V1,R3
   \   0001CA   85....       MOV     ?V2,?V0
   \   0001CD   85....       MOV     ?V3,?V1
    910                MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF),
    911                                                     MT_AF_DATA_RETRIEVE, len + MT_AF_RTV_HDR_SZ, pRsp);
   \   0001D0                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001D0   AC..         MOV     R4,?V8
   \   0001D2   AD..         MOV     R5,?V9
   \   0001D4   7402         MOV     A,#0x2
   \   0001D6   25..         ADD     A,?V12
   \   0001D8   FB           MOV     R3,A
   \   0001D9   7A12         MOV     R2,#0x12
   \   0001DB   7964         MOV     R1,#0x64
   \   0001DD   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    912                (void)osal_mem_free(pRsp);
   \   0001E0                ; Setup parameters for call to function osal_mem_free
   \   0001E0   AA..         MOV     R2,?V8
   \   0001E2   AB..         MOV     R3,?V9
   \   0001E4   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    913                return;
   \   0001E7   8024         SJMP    ??MT_AfDataRetrieve_10
    914              }
    915            }
    916          
    917            pBuf[0] = rtrn;
   \                     ??MT_AfDataRetrieve_3:
   \   0001E9   E5..         MOV     A,?V13
   \   0001EB   C0E0         PUSH    A
   \   0001ED   8E82         MOV     DPL,R6
   \   0001EF   8F83         MOV     DPH,R7
   \   0001F1   D0E0         POP     A
   \   0001F3   F0           MOVX    @DPTR,A
    918            pBuf[1] = len;
   \   0001F4   E5..         MOV     A,?V12
   \   0001F6   C0E0         PUSH    A
   \   0001F8   8E82         MOV     DPL,R6
   \   0001FA   8F83         MOV     DPH,R7
   \   0001FC   A3           INC     DPTR
   \   0001FD   D0E0         POP     A
   \   0001FF   F0           MOVX    @DPTR,A
    919            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF),
    920                                                 MT_AF_DATA_RETRIEVE, MT_AF_RTV_HDR_SZ, pBuf);
   \   000200                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000200   EE           MOV     A,R6
   \   000201   FC           MOV     R4,A
   \   000202   EF           MOV     A,R7
   \   000203   FD           MOV     R5,A
   \   000204   7B02         MOV     R3,#0x2
   \   000206   7A12         MOV     R2,#0x12
   \   000208   7964         MOV     R1,#0x64
   \   00020A   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    921          }
   \                     ??MT_AfDataRetrieve_10:
   \   00020D   7402         MOV     A,#0x2
   \   00020F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000212   7F10         MOV     R7,#0x10
   \   000214   02....       LJMP    ?BANKED_LEAVE_XDATA
    922          
    923          /**************************************************************************************************
    924           * @fn          MT_AfDataStore
    925           *
    926           * @brief   Process AF Data Store command to incrementally store the data buffer for very large
    927           *          outgoing AF message.
    928           *
    929           * input parameters
    930           *
    931           * @param pBuf - pointer to the received buffer
    932           *
    933           * output parameters
    934           *
    935           * @param rtrn - AF-Status of the operation.
    936           *
    937           * @return      None.
    938           **************************************************************************************************
    939           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    940          void MT_AfDataStore(uint8 *pBuf)
   \                     MT_AfDataStore:
    941          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    942            uint16 idx;
    943            uint8 len, rtrn = afStatus_FAILED;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
    944          
    945            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000017   EE           MOV     A,R6
   \   000018   2403         ADD     A,#0x3
   \   00001A   FE           MOV     R6,A
   \   00001B   5001         JNC     ??MT_AfDataStore_0
   \   00001D   0F           INC     R7
    946            idx = BUILD_UINT16(pBuf[0], pBuf[1]);
   \                     ??MT_AfDataStore_0:
   \   00001E   8E82         MOV     DPL,R6
   \   000020   8F83         MOV     DPH,R7
   \   000022   E0           MOVX    A,@DPTR
   \   000023   FA           MOV     R2,A
   \   000024   7B00         MOV     R3,#0x0
   \   000026   8E82         MOV     DPL,R6
   \   000028   8F83         MOV     DPH,R7
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F8           MOV     R0,A
   \   00002D   7900         MOV     R1,#0x0
   \   00002F   E4           CLR     A
   \   000030   C8           XCH     A,R0
   \   000031   F9           MOV     R1,A
   \   000032   EA           MOV     A,R2
   \   000033   28           ADD     A,R0
   \   000034   F8           MOV     R0,A
   \   000035   EB           MOV     A,R3
   \   000036   39           ADDC    A,R1
   \   000037   F9           MOV     R1,A
   \   000038   88..         MOV     ?V0,R0
   \   00003A   89..         MOV     ?V1,R1
    947            len = pBuf[2];
   \   00003C   8E82         MOV     DPL,R6
   \   00003E   8F83         MOV     DPH,R7
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F5..         MOV     ?V2,A
    948            pBuf += 3;
   \   000045   EE           MOV     A,R6
   \   000046   2403         ADD     A,#0x3
   \   000048   FE           MOV     R6,A
   \   000049   5001         JNC     ??MT_AfDataStore_1
   \   00004B   0F           INC     R7
    949          
    950            if (pMtAfDataReq == NULL)
   \                     ??MT_AfDataStore_1:
   \   00004C   90....       MOV     DPTR,#pMtAfDataReq
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F8           MOV     R0,A
   \   000051   A3           INC     DPTR
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F9           MOV     R1,A
   \   000054   E8           MOV     A,R0
   \   000055   49           ORL     A,R1
   \   000056   700C         JNZ     ??MT_AfDataStore_2
    951            {
    952              rtrn = afStatus_MEM_FAIL;
   \   000058   85..82       MOV     DPL,?XSP + 0
   \   00005B   85..83       MOV     DPH,?XSP + 1
   \   00005E   7410         MOV     A,#0x10
   \   000060   F0           MOVX    @DPTR,A
   \   000061   02....       LJMP    ??MT_AfDataStore_3 & 0xFFFF
    953            }
    954            else if (len == 0)  // Indication to send the message.
   \                     ??MT_AfDataStore_2:
   \   000064   E5..         MOV     A,?V2
   \   000066   6003         JZ      $+5
   \   000068   02....       LJMP    ??MT_AfDataStore_4 & 0xFFFF
    955            {
    956              rtrn = AF_DataRequest(&(pMtAfDataReq->dstAddr), pMtAfDataReq->epDesc, pMtAfDataReq->cId,
    957                                      pMtAfDataReq->dataLen,  pMtAfDataReq->data,
    958                                    &(pMtAfDataReq->transId), pMtAfDataReq->txOpts, pMtAfDataReq->radius);
   \   00006B                ; Setup parameters for call to function AF_DataRequest
   \   00006B   90....       MOV     DPTR,#pMtAfDataReq
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F8           MOV     R0,A
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   C8           XCH     A,R0
   \   000073   2416         ADD     A,#0x16
   \   000075   F582         MOV     DPL,A
   \   000077   C8           XCH     A,R0
   \   000078   3400         ADDC    A,#0x0
   \   00007A   F583         MOV     DPH,A
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   F5..         MOV     ?V3,A
   \   00007F   78..         MOV     R0,#?V3
   \   000081   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000084   90....       MOV     DPTR,#pMtAfDataReq
   \   000087   E0           MOVX    A,@DPTR
   \   000088   2414         ADD     A,#0x14
   \   00008A   F5..         MOV     ?V4,A
   \   00008C   A3           INC     DPTR
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   3400         ADDC    A,#0x0
   \   000090   F5..         MOV     ?V5,A
   \   000092   78..         MOV     R0,#?V4
   \   000094   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000097   90....       MOV     DPTR,#pMtAfDataReq
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   F8           MOV     R0,A
   \   00009C   A3           INC     DPTR
   \   00009D   E0           MOVX    A,@DPTR
   \   00009E   F583         MOV     DPH,A
   \   0000A0   8882         MOV     DPL,R0
   \   0000A2   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000A5   90....       MOV     DPTR,#pMtAfDataReq
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   F8           MOV     R0,A
   \   0000AA   A3           INC     DPTR
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   C8           XCH     A,R0
   \   0000AD   2412         ADD     A,#0x12
   \   0000AF   F582         MOV     DPL,A
   \   0000B1   C8           XCH     A,R0
   \   0000B2   3400         ADDC    A,#0x0
   \   0000B4   F583         MOV     DPH,A
   \   0000B6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000B9   90....       MOV     DPTR,#pMtAfDataReq
   \   0000BC   E0           MOVX    A,@DPTR
   \   0000BD   F8           MOV     R0,A
   \   0000BE   A3           INC     DPTR
   \   0000BF   E0           MOVX    A,@DPTR
   \   0000C0   C8           XCH     A,R0
   \   0000C1   2410         ADD     A,#0x10
   \   0000C3   F582         MOV     DPL,A
   \   0000C5   C8           XCH     A,R0
   \   0000C6   3400         ADDC    A,#0x0
   \   0000C8   F583         MOV     DPH,A
   \   0000CA   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000CD   90....       MOV     DPTR,#pMtAfDataReq
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   F8           MOV     R0,A
   \   0000D2   A3           INC     DPTR
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   C8           XCH     A,R0
   \   0000D5   2415         ADD     A,#0x15
   \   0000D7   F582         MOV     DPL,A
   \   0000D9   C8           XCH     A,R0
   \   0000DA   3400         ADDC    A,#0x0
   \   0000DC   F583         MOV     DPH,A
   \   0000DE   E0           MOVX    A,@DPTR
   \   0000DF   F9           MOV     R1,A
   \   0000E0   90....       MOV     DPTR,#pMtAfDataReq
   \   0000E3   E0           MOVX    A,@DPTR
   \   0000E4   F8           MOV     R0,A
   \   0000E5   A3           INC     DPTR
   \   0000E6   E0           MOVX    A,@DPTR
   \   0000E7   C8           XCH     A,R0
   \   0000E8   240E         ADD     A,#0xe
   \   0000EA   F582         MOV     DPL,A
   \   0000EC   C8           XCH     A,R0
   \   0000ED   3400         ADDC    A,#0x0
   \   0000EF   F583         MOV     DPH,A
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   FC           MOV     R4,A
   \   0000F3   A3           INC     DPTR
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   FD           MOV     R5,A
   \   0000F6   90....       MOV     DPTR,#pMtAfDataReq
   \   0000F9   E0           MOVX    A,@DPTR
   \   0000FA   2402         ADD     A,#0x2
   \   0000FC   FA           MOV     R2,A
   \   0000FD   A3           INC     DPTR
   \   0000FE   E0           MOVX    A,@DPTR
   \   0000FF   3400         ADDC    A,#0x0
   \   000101   FB           MOV     R3,A
   \   000102   12....       LCALL   `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   000105   7409         MOV     A,#0x9
   \   000107   12....       LCALL   ?DEALLOC_XSTACK8
   \   00010A   E9           MOV     A,R1
   \   00010B   C0E0         PUSH    A
   \   00010D   85..82       MOV     DPL,?XSP + 0
   \   000110   85..83       MOV     DPH,?XSP + 1
   \   000113   D0E0         POP     A
   \   000115   F0           MOVX    @DPTR,A
    959              (void)osal_mem_free(pMtAfDataReq);
   \   000116                ; Setup parameters for call to function osal_mem_free
   \   000116   90....       MOV     DPTR,#pMtAfDataReq
   \   000119   E0           MOVX    A,@DPTR
   \   00011A   FA           MOV     R2,A
   \   00011B   A3           INC     DPTR
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   FB           MOV     R3,A
   \   00011E   12....       LCALL   `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    960              pMtAfDataReq = NULL;
   \   000121   90....       MOV     DPTR,#pMtAfDataReq
   \   000124   7400         MOV     A,#0x0
   \   000126   F0           MOVX    @DPTR,A
   \   000127   A3           INC     DPTR
   \   000128   7400         MOV     A,#0x0
   \   00012A   F0           MOVX    @DPTR,A
   \   00012B   803D         SJMP    ??MT_AfDataStore_3
    961            }
    962            else
    963            {
    964              (void)osal_memcpy(pMtAfDataReq->data+idx, pBuf, len);
   \                     ??MT_AfDataStore_4:
   \   00012D                ; Setup parameters for call to function osal_memcpy
   \   00012D   8E..         MOV     ?V4,R6
   \   00012F   8F..         MOV     ?V5,R7
   \   000131   75..00       MOV     ?V6,#0x0
   \   000134   78..         MOV     R0,#?V4
   \   000136   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000139   AC..         MOV     R4,?V2
   \   00013B   7D00         MOV     R5,#0x0
   \   00013D   90....       MOV     DPTR,#pMtAfDataReq
   \   000140   E0           MOVX    A,@DPTR
   \   000141   F8           MOV     R0,A
   \   000142   A3           INC     DPTR
   \   000143   E0           MOVX    A,@DPTR
   \   000144   F583         MOV     DPH,A
   \   000146   8882         MOV     DPL,R0
   \   000148   E0           MOVX    A,@DPTR
   \   000149   25..         ADD     A,?V0
   \   00014B   FA           MOV     R2,A
   \   00014C   A3           INC     DPTR
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   35..         ADDC    A,?V1
   \   000150   FB           MOV     R3,A
   \   000151   12....       LCALL   `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000154   7403         MOV     A,#0x3
   \   000156   12....       LCALL   ?DEALLOC_XSTACK8
   \   000159   8A..         MOV     ?V4,R2
   \   00015B   8B..         MOV     ?V5,R3
   \   00015D   A8..         MOV     R0,?V4
   \   00015F   A9..         MOV     R1,?V5
    965              rtrn = afStatus_SUCCESS;
   \   000161   85..82       MOV     DPL,?XSP + 0
   \   000164   85..83       MOV     DPH,?XSP + 1
   \   000167   7400         MOV     A,#0x0
   \   000169   F0           MOVX    @DPTR,A
    966            }
    967          
    968            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF),
    969                                                                          MT_AF_DATA_STORE, 1, &rtrn);
   \                     ??MT_AfDataStore_3:
   \   00016A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00016A   AC..         MOV     R4,?XSP + 0
   \   00016C   AD..         MOV     R5,?XSP + 1
   \   00016E   7B01         MOV     R3,#0x1
   \   000170   7A11         MOV     R2,#0x11
   \   000172   7964         MOV     R1,#0x64
   \   000174   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    970          }
   \   000177   7401         MOV     A,#0x1
   \   000179   12....       LCALL   ?DEALLOC_XSTACK8
   \   00017C   7F07         MOV     R7,#0x7
   \   00017E   02....       LJMP    ?BANKED_LEAVE_XDATA
    971          
    972          /**************************************************************************************************
    973           * @fn          MT_AfAPSF_ConfigSet
    974           *
    975           * @brief       This function is the MT proxy for afAPSF_ConfigSet().
    976           *
    977           * input parameters
    978           *
    979           * @param       pBuf - Pointer to the received buffer.
    980           *
    981           * output parameters
    982           *
    983           * None.
    984           *
    985           * @return      None.
    986           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    987          static void MT_AfAPSF_ConfigSet(uint8 *pBuf)
   \                     MT_AfAPSF_ConfigSet:
    988          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    989            afAPSF_Config_t cfg = { pBuf[MT_RPC_POS_DAT0+1], pBuf[MT_RPC_POS_DAT0+2] };
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   C0E0         PUSH    A
   \   000019   7401         MOV     A,#0x1
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   D0E0         POP     A
   \   000020   F0           MOVX    @DPTR,A
   \   000021   8E82         MOV     DPL,R6
   \   000023   8F83         MOV     DPH,R7
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   C0E0         PUSH    A
   \   00002D   7402         MOV     A,#0x2
   \   00002F   12....       LCALL   ?XSTACK_DISP0_8
   \   000032   D0E0         POP     A
   \   000034   F0           MOVX    @DPTR,A
    990            afStatus_t rtrn = afAPSF_ConfigSet(pBuf[MT_RPC_POS_DAT0], &cfg);
   \   000035                ; Setup parameters for call to function afAPSF_ConfigSet
   \   000035   7401         MOV     A,#0x1
   \   000037   12....       LCALL   ?XSTACK_DISP101_8
   \   00003A   8E82         MOV     DPL,R6
   \   00003C   8F83         MOV     DPH,R7
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F9           MOV     R1,A
   \   000043   12....       LCALL   `??afAPSF_ConfigSet::?relay`; Banked call to: afAPSF_ConfigSet
   \   000046   E9           MOV     A,R1
   \   000047   C0E0         PUSH    A
   \   000049   85..82       MOV     DPL,?XSP + 0
   \   00004C   85..83       MOV     DPH,?XSP + 1
   \   00004F   D0E0         POP     A
   \   000051   F0           MOVX    @DPTR,A
    991          
    992            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF),
    993                                                 MT_AF_APSF_CONFIG_SET, 1, (uint8 *)&rtrn);
   \   000052                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000052   AC..         MOV     R4,?XSP + 0
   \   000054   AD..         MOV     R5,?XSP + 1
   \   000056   7B01         MOV     R3,#0x1
   \   000058   7A13         MOV     R2,#0x13
   \   00005A   7964         MOV     R1,#0x64
   \   00005C   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
    994          }
   \   00005F   7403         MOV     A,#0x3
   \   000061   12....       LCALL   ?DEALLOC_XSTACK8
   \   000064   7F01         MOV     R7,#0x1
   \   000066   02....       LJMP    ?BANKED_LEAVE_XDATA
    995          
    996          /**************************************************************************************************
    997           * @fn          MT_AfAPSF_ConfigGet
    998           *
    999           * @brief       This function is the MT proxy for afAPSF_ConfigGet().
   1000           *
   1001           * input parameters
   1002           *
   1003           * @param       pBuf - Pointer to the received buffer.
   1004           *
   1005           * output parameters
   1006           *
   1007           * None.
   1008           *
   1009           * @return      None.
   1010           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1011          static void MT_AfAPSF_ConfigGet(uint8 *pBuf)
   \                     MT_AfAPSF_ConfigGet:
   1012          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1013            afAPSF_Config_t cfg = { 0, 0 };
   \   00000E   90....       MOV     DPTR,#`?<Constant {0, 0}>`
   \   000011   AC..         MOV     R4,?XSP + 0
   \   000013   AD..         MOV     R5,?XSP + 1
   \   000015   7402         MOV     A,#0x2
   \   000017   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
   1014            uint8 buf[2];
   1015          
   1016            afAPSF_ConfigGet( pBuf[MT_RPC_POS_DAT0], &cfg );
   \   00001A                ; Setup parameters for call to function afAPSF_ConfigGet
   \   00001A   AA..         MOV     R2,?XSP + 0
   \   00001C   AB..         MOV     R3,?XSP + 1
   \   00001E   8E82         MOV     DPL,R6
   \   000020   8F83         MOV     DPH,R7
   \   000022   A3           INC     DPTR
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F9           MOV     R1,A
   \   000027   12....       LCALL   `??afAPSF_ConfigGet::?relay`; Banked call to: afAPSF_ConfigGet
   1017          
   1018            buf[0] = cfg.frameDelay;
   \   00002A   85..82       MOV     DPL,?XSP + 0
   \   00002D   85..83       MOV     DPH,?XSP + 1
   \   000030   E0           MOVX    A,@DPTR
   \   000031   C0E0         PUSH    A
   \   000033   7402         MOV     A,#0x2
   \   000035   12....       LCALL   ?XSTACK_DISP0_8
   \   000038   D0E0         POP     A
   \   00003A   F0           MOVX    @DPTR,A
   1019            buf[1] = cfg.windowSize;
   \   00003B   7401         MOV     A,#0x1
   \   00003D   12....       LCALL   ?XSTACK_DISP0_8
   \   000040   E0           MOVX    A,@DPTR
   \   000041   C0E0         PUSH    A
   \   000043   7403         MOV     A,#0x3
   \   000045   12....       LCALL   ?XSTACK_DISP0_8
   \   000048   D0E0         POP     A
   \   00004A   F0           MOVX    @DPTR,A
   1020          
   1021            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_AF),
   1022                                                 MT_AF_APSF_CONFIG_GET, 3, buf );
   \   00004B                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00004B   7402         MOV     A,#0x2
   \   00004D   12....       LCALL   ?XSTACK_DISP102_8
   \   000050   7B03         MOV     R3,#0x3
   \   000052   7A14         MOV     R2,#0x14
   \   000054   7964         MOV     R1,#0x64
   \   000056   12....       LCALL   `??MT_BuildAndSendZToolResponse::?relay`; Banked call to: MT_BuildAndSendZToolResponse
   1023          }
   \   000059   7404         MOV     A,#0x4
   \   00005B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00005E   7F01         MOV     R7,#0x1
   \   000060   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfExec::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfExec

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfCommandProcessing::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfRegister::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfRegister

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDelete::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDelete

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDataRequest::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDataRequestSrcRtg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRequestSrcRtg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDataConfirm::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataConfirm

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfReflectError::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfReflectError

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfIncomingMsg::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfIncomingMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDataRetrieve::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataRetrieve

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfDataStore::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfDataStore

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfAPSF_ConfigSet::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfAPSF_ConfigSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     `??MT_AfAPSF_ConfigGet::?relay`:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_AfAPSF_ConfigGet

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {0, 0}>`:
   \   000000   00           DB 0
   \   000001   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000
   1024          
   1025          /***************************************************************************************************
   1026          ***************************************************************************************************/

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      1     22   MT_AfAPSF_ConfigGet
        0     13   -> MT_BuildAndSendZToolResponse
        0     13   -> afAPSF_ConfigGet
      1     21   MT_AfAPSF_ConfigSet
        0     12   -> MT_BuildAndSendZToolResponse
        0     12   -> afAPSF_ConfigSet
      0      9   MT_AfCommandProcessing
        0      9   -> MT_AfAPSF_ConfigGet
        0      9   -> MT_AfAPSF_ConfigSet
        0      9   -> MT_AfDataRequest
        0      9   -> MT_AfDataRequestSrcRtg
        0      9   -> MT_AfDataRetrieve
        0      9   -> MT_AfDataStore
        0      9   -> MT_AfDelete
        0      9   -> MT_AfRegister
      1     12   MT_AfDataConfirm
        0     12   -> MT_BuildAndSendZToolResponse
      1     57   MT_AfDataRequest
        0     48   -> AF_DataRequest
        0     39   -> MT_BuildAndSendZToolResponse
        0     39   -> afFindEndPointDesc
        0     39   -> osal_mem_alloc
        0     42   -> osal_memcpy
        0     39   -> osal_set_event
        0     43   -> osal_start_timerEx
      1     59   MT_AfDataRequestSrcRtg
        0     50   -> AF_DataRequestSrcRtg
        0     38   -> MT_BuildAndSendZToolResponse
        0     38   -> afFindEndPointDesc
        0     38   -> osal_mem_alloc
        0     38   -> osal_mem_free
        0     38   -> osal_memset
      1     38   MT_AfDataRetrieve
        0     26   -> MT_BuildAndSendZToolResponse
        0     26   -> osal_mem_alloc
        0     26   -> osal_mem_free
        0     29   -> osal_memcpy
      1     34   MT_AfDataStore
        0     25   -> AF_DataRequest
        0     16   -> MT_BuildAndSendZToolResponse
        0     16   -> osal_mem_free
        0     19   -> osal_memcpy
      1     19   MT_AfDelete
        0     10   -> MT_BuildAndSendZToolResponse
        0     10   -> afDelete
      0     14   MT_AfExec
        0     10   -> osal_mem_free
        0     10   -> osal_set_event
        0     14   -> osal_start_timerEx
      1     29   MT_AfIncomingMsg
        0     25   -> MT_BuildAndSendZToolResponse
        0     25   -> osal_mem_alloc
        0     25   -> osal_mem_free
        0     28   -> osal_memcpy
        0     25   -> osal_set_event
        0     29   -> osal_start_timerEx
      1     15   MT_AfReflectError
        0     15   -> MT_BuildAndSendZToolResponse
      1     24   MT_AfRegister
        0     15   -> MT_BuildAndSendZToolResponse
        0     15   -> MT_BuildEndpointDesc
        0     15   -> afRegister
        0     15   -> osal_mem_alloc
        0     15   -> osal_mem_free


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       2  ?<Constant {0, 0}>
      99  MT_AfAPSF_ConfigGet
       6  MT_AfAPSF_ConfigGet::?relay
     105  MT_AfAPSF_ConfigSet
       6  MT_AfAPSF_ConfigSet::?relay
     130  MT_AfCommandProcessing
       6  MT_AfCommandProcessing::?relay
      89  MT_AfDataConfirm
       6  MT_AfDataConfirm::?relay
    1044  MT_AfDataRequest
       6  MT_AfDataRequest::?relay
     572  MT_AfDataRequestSrcRtg
       6  MT_AfDataRequestSrcRtg::?relay
     535  MT_AfDataRetrieve
       6  MT_AfDataRetrieve::?relay
     385  MT_AfDataStore
       6  MT_AfDataStore::?relay
      83  MT_AfDelete
       6  MT_AfDelete::?relay
     308  MT_AfExec
       6  MT_AfExec::?relay
    1476  MT_AfIncomingMsg
       6  MT_AfIncomingMsg::?relay
     161  MT_AfReflectError
       6  MT_AfReflectError::?relay
     165  MT_AfRegister
       6  MT_AfRegister::?relay
       4  __Constant_3e8
       2  pMtAfDataReq
       2  pMtAfInMsgList

 
 5 152 bytes in segment BANKED_CODE
    78 bytes in segment BANK_RELAYS
     6 bytes in segment XDATA_ROM_C
     4 bytes in segment XDATA_Z
 
 5 230 bytes of CODE  memory
     2 bytes of CONST memory (+ 4 bytes shared)
     4 bytes of XDATA memory

Errors: none
Warnings: none
